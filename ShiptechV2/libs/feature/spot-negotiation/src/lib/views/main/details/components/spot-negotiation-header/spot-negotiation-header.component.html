<div id="spot-nego-header">
  <div class="row" style="border-bottom: 4px solid #E0E1E4;">
    <div class="section1">
      <span class="add-icon" matTooltip="Add counterparty across locations" matTooltipClass="lightTooltip"
        [matMenuTriggerFor]="clickmenu" #menuTrigger="matMenuTrigger"></span>
      <mat-menu #clickmenu="matMenu" class="add-new-request-menu">
        <div class="expansion-popup" style="margin: 20px 0px;">
          <div class="select-product-container">
            <div class="col-md-12 header-container-product" (click)="$event.stopPropagation(); $event.preventDefault()">
              <div class="search-product-container col-md-10">
                <span class="search-product-lookup"> </span>
                <input matInput (input)="search($event.target.value)" placeholder="Search and select counterparty"
                  class="search-product-input" />
              </div>
              <div class="col-md-2" (click)="openCounterpartyPopup()">
                <span class="expand-img"></span>
              </div>
            </div>
            <table class="delivery-products-pop-up col-md-12 no-padding" mat-table (click)="$event.stopPropagation()"
              [dataSource]="visibleCounterpartyList">
              <ng-container matColumnDef="counterparty">
                <th mat-header-cell *matHeaderCellDef>Counterparty</th>
                <td mat-cell *matCellDef="let element">
                  <mat-option [value]="element">
                    <mat-checkbox [value]="element" (change)="onCounterpartyCheckboxChange($event,element)">
                      {{ element.name }}
                    </mat-checkbox>
                  </mat-option>
                </td>
              </ng-container>
              <ng-container matColumnDef="blank">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let element"></td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="counterpartyColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: counterpartyColumns"></tr>
            </table>

            <div class="proceed-div">
              <button mat-button class="mid-blue-button proceed-btn" (click)="addCounterpartyAcrossLocations()">
                Proceed
              </button>
            </div>
          </div>
        </div>
      </mat-menu>

        <span class="info-text" [ngClass]="{ 'with-ellipsis': expandedSearch }">All Location Counterparties</span>
        <span *ngIf="!expandedSearch" class="search-icon" matTooltip="Search a counterparty"
          matTooltipClass="lightTooltip" (click)="expandedSearch = !expandedSearch; showSearch()"></span>
        <div *ngIf="expandedSearch" style="display:flex" class="search-input">
          <input type="search" name="inputSearch"  #inputSearch (input)="searchCounterparty($event.target.value)" placeholder="Search counterparty" class="search-box light"/>
          <div style="border-right: 1px solid gray; height: 12px; margin-top: 8px;"></div>
          <button class="searchButton"  type="submit">
            <i class="fa fa-search" (click)="searchCounterparty(inputSearch.value)"></i>
           </button>
        </div>
      </div>

    <div class="section2" #headerContainer>
      <div class="row">
        <div style="margin: 4px 0px;display: flex;align-items: center;">
          <span class="add-icon" matTooltip="Add a request" matTooltipClass="lightTooltip"
            [matMenuTriggerFor]="clickmenu1" #menuTrigger="matMenuTrigger"></span>
          <mat-menu #clickmenu1="matMenu" class="add-new-request-menu">
            <div class="expansion-popup" style="margin: 20px 0px;">
              <div class="select-product-container">
                <div class="col-md-12 header-container-product"
                  (click)="$event.stopPropagation(); $event.preventDefault()">
                  <div class="search-product-container col-md-10">
                    <span class="search-product-lookup"> </span>
                    <input matInput (input)="searchRequest($event.target.value)" placeholder="Search and select Request" class="search-product-input" />
                  </div>
                  <div class="col-md-2" (click)="openRequestPopup()">
                    <span class="expand-img"></span>
                  </div>
                </div>
                <table class="delivery-products-pop-up col-md-12 no-padding" mat-table
                  (click)="$event.stopPropagation()" [dataSource]="visibleRequestList">
                  <ng-container matColumnDef="request">
                    <th mat-header-cell *matHeaderCellDef>Requests</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-option [value]="element">
                        <mat-checkbox [value]="element" [checked]="element.isSelected" (change)="onRequestListCheckboxChange($event,element)">
                          {{ element.requestName }}
                        </mat-checkbox>
                      </mat-option>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="vessel">
                    <th mat-header-cell *matHeaderCellDef>Vessel</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-option>
                        {{ element.vesselName }}
                      </mat-option>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                </table>

                <div class="proceed-div">
                  <button mat-button class="mid-blue-button proceed-btn" (click)="addToRequestListCheckboxOptions()">
                    Proceed
                  </button>
                </div>
              </div>
            </div>
          </mat-menu>
        </div>
        <div style="display: flex; margin-left: 10px;">
          <div style="float:left;" #requestContainer>
            <div class="addRemoveRequest" [matMenuTriggerFor]="requestDeleteMenu" #deleteRequestTrigger="matMenuTrigger"
              (contextmenu)="$event.preventDefault(); deleteRequestTrigger.openMenu()"
              *ngFor="let item of requestOptions; let i = index">
              <div #requestTooltip class="checkboxOptions" [ngClass]="selReqIndex == i ? 'selected-request' : ''"
                (click)="selectRequest($event, i, item)">
                <span style="padding-right: 5px;" *ngIf="!displayVessel">{{ item.name }} - {{ item.vesselName }}
                </span>
                <span style="padding-right: 5px;" *ngIf="displayVessel">{{
                  item.vessel
                  }}</span>
                <div class="requestTooltip" (click)="openRequestTab($event, item)">
                  <span class="white-space"></span>
                  <span class="linkImg"></span>
                  <span class="linkText">Link to {{ item.name }}</span>
                </div>
              </div>
              <mat-menu #requestDeleteMenu="matMenu" class="darkPanel-delete big">
                <div class="delete-block" (click)="removeRequest(i);">
                  <div></div><span>Delink Request</span>
                </div>
              </mat-menu>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="section3">
      <span class="go-to-port">Go to port</span>
      <span *ngFor="let item of locations; let i = index">
        <button class="circle-btn1" (click)="scrollPort1(port1)">
          {{ i + 1 }}
        </button>
      </span>
      <button class="comments-icon-btn">
        <span class="comments-icon" (click)="scrollComments(comments)"></span>
      </button>
    </div>
  </div>
</div>
<div style="overflow-y: scroll; width: 100%; height: calc( 100vh - 200px );margin-left: -16px;position: fixed;">
  <div #port1 class="col-md-12" style="background-color: #ffffff;padding: 0px 5px;">
    <app-spot-negotiation-details>
    </app-spot-negotiation-details>
  </div>
  <div #comments class="col-md-12" style="background-color: #ffffff;padding: 0px 5px;">
    <app-spot-negotiation-new-comments></app-spot-negotiation-new-comments>
  </div>
</div>
