<div>
    <table class="product-additional-costs-table table table-stripped table-hover" style="width:100%">
      <thead>
        <tr>
          <td class="padding" style="width: 30px;">
            <a class="add-icon" (click)="addNewAdditionalCostLine()"></a>
          </td>
          <td class="padding" style="width:15%">
            <b>Item</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Cost Type</b>
          </td>
          <td class="padding" style="width:30%">
            <b>% of</b>
          </td>
          <td class="padding" style="width:30%">
            <b>Inv. Qty.</b>
          </td>
          <td class="padding" style="width:40%">
            <b>Inv. Rate</b>
          </td>
          <td class="padding" style="width:30%">
            <b>Amount</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Extra (%)</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Extra Amount</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Total Amount</b>
          </td>
          <td class="padding" style="width:30%">
            <b>BDN Qty</b>
          </td>
          <td class="padding" style="width:45%">
            <b>Est. Rate</b>
          </td>
          <td class="padding" style="width:30%">
            <b>Amount</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Extra (%)</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Extra Amount</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Total Amount</b>
          </td>
          <td class="padding" style="width:15%">
            <b>Diff.</b>
          </td>
        </tr>
      </thead>
      <tbody>
          <ng-container  *ngFor="let additionalCost of formValues.costDetails | keyvalue : originalOrder">
            <tr *ngIf="!additionalCost.value.isDeleted">              
              <td class="padding" style="padding-left: 0px  !important; padding-right: 0px  !important;">
                <a class="remove-icon" style="margin-left: 10px;"  (click)="removeAdditionalCostLine(additionalCost.key)"></a>
              </td>              
              <td style="width:15%">
                <div>
                  <mat-form-field>
                    <mat-select 
                        [(ngModel)]="additionalCost.value.costName"
                        (ngModelChange)="additionalCost.value.costType = setDefaultCostType(additionalCost.value.costName)"
                        [compareWith]="compareUomObjects"
                        [disableOptionCentering]="true"
                        panelClass="general-information-select-container">
                        <mat-option *ngFor="let option of  costNames" [value]="option">
                          {{option.name}}
                        </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </td>
              <td style="width:15%">
                <div>
                  <mat-form-field>
                    <mat-select 
                        [(ngModel)]="additionalCost.value.costType"
                        [disabled]="additionalCost.value.isOrderCost"
                        [compareWith]="compareUomObjects"
                        [disableOptionCentering]="true"
                        panelClass="general-information-select-container">
                        <mat-option *ngFor="let option of  filterCostTypesByAdditionalCost(additionalCost.value.costName ? additionalCost.value.costName.id : 0, 0)" [value]="option">
                          {{option.name}}
                        </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </td>
              <td>
                <mat-form-field name="invProduct">                    
                     <mat-select 
                          [(ngModel)]="additionalCost.value.associatedOrderProduct"
                          [disabled]="additionalCost.value.isOrderCost"
                          (selectionChange)="costNameChange()"
                          [disableOptionCentering]="true"
                          panelClass="general-information-select-container">
                         <mat-option *ngFor="let option of productDetails" [value]="option.id">
                          {{option.name}}
                        </mat-option>
                    </mat-select> 
                    
                  </mat-form-field>
              </td>
              <td>
                <div style="width:50%;float:left">
                  <mat-form-field name="invQty">
                    <input matInput type="text" name="invQtyNumber" 
                      [(ngModel)]="additionalCost.value.invoiceQuantity"
                      quantityFormat>                    
                  </mat-form-field>
                </div>
                <div style="width:48%;float:left">
                  <mat-form-field name="invQtyUOM">                    
                    <mat-select 
                        [(ngModel)]="additionalCost.value.invoiceQuantityUom"
                        [compareWith]="compareUomObjects"
                        [disableOptionCentering]="true"
                        panelClass="general-information-select-container">
                        <mat-option *ngFor="let option of uomList" [value]="option">
                            {{option.name}}
                        </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </td>
              <td>                
                  <div style="width:30%;float:left">
                    <mat-form-field name="invRateCurrency">                    
                      <mat-select 
                          [(ngModel)]="additionalCost.value.invoiceRateCurrency"
                          [disabled]="true"
                          [compareWith]="compareUomObjects"
                          [disableOptionCentering]="true"
                          panelClass="general-information-select-container">
                          <mat-option *ngFor="let option of currencyNames" [value]="option">
                              {{option.name}}
                          </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div style="width:38%;float:left;margin-right:2%">
                  <mat-form-field name="invRate">
                    <input matInput type="text" name="invRateNumber" 
                        [(ngModel)]="additionalCost.value.invoiceRate" 
                        (ngModelChange)="invoiceRateChange($event, additionalCost.key)"
                        amountFormat>                    
                  </mat-form-field>
                </div>
                <div style="width:30%;float:left" *ngIf="additionalCost.value.costType && additionalCost.value.costType.id == 2">
                  <mat-form-field name="invRateUOM">                    
                    <mat-select 
                          [(ngModel)]="additionalCost.value.invoiceRateUom"
                          [compareWith]="compareUomObjects"
                          [disableOptionCentering]="true"
                          panelClass="general-information-select-container">
                        <mat-option *ngFor="let option of uomList" [value]="option">
                            {{option.name}}
                        </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </td>
              <td>
                <div style="width:40%;float:left;line-height: 50px;background-color: #eee;
                padding-left: 5px;">                  
                  {{additionalCost.value.invoiceRateCurrency.code}}
                </div>
                <div style="width:38%;float:left;margin-right:2%;">
                <mat-form-field name="invAmount">
                  <input matInput type="text" 
                    [disabled]="true" name="invAmountNumber"
                    [(ngModel)]="additionalCost.value.amountInOrderCurrency"
                    amountFormat>                    
                </mat-form-field>
              </div>
              </td>
              <td>
                <div>
                  <mat-form-field name="invExtra">
                    <input matInput type="text" name="invExtraNumber" 
                      [(ngModel)]="additionalCost.value.invoiceExtras" 
                      (ngModelChange)="extraAmount($event, additionalCost.key)"
                      amountFormat>                    
                  </mat-form-field>
                </div>
              </td>
              <td>
                <div style="background-color:#eee;line-height:50px;">
                  <!-- {{ costs.costType.id == 2 ? (costs.invoiceRate * costs.invoiceQuantity)* costs.invoiceExtras/100 : costs.invoiceRate * costs.invoiceExtras/100     
                  }} -->
                  <mat-form-field name="invExtraAmt">
                    <input matInput type="text" [disabled]="true" name="invExtraAmtNumber" 
                        [(ngModel)]="additionalCost.value.invoiceExtrasAmount"
                        amountFormat>                    
                  </mat-form-field>
                </div>
              </td>
              <td>
                <div style="line-height: 50px;background-color: #eee;padding-left: 5px;">
                  {{amountFormatValue(additionalCost.value.invoiceTotalAmount)}}
                </div>
              </td>
              <td>
                <div style="width:40%;float:left;line-height: 50px;background-color: #eee;
                padding-left: 5px;">
                  {{additionalCost.value.deliveryQuantityUom ? additionalCost.value.deliveryQuantityUom.name : ''}}
                </div>
                <div style="width:40%;float:left;">
                  <mat-form-field name="delQty">
                    <input matInput type="text" [disabled]="true" name="delQtyNumber" 
                      [(ngModel)]="additionalCost.value.deliveryQuantity"
                      quantityFormat>                    
                  </mat-form-field>
                </div>
              </td>
              <td>
                <div style="width:30%;float:left;line-height: 50px;background-color: #eee;
                padding-left: 5px;">
                  {{additionalCost.value.invoiceRateCurrency.code}}
                </div>
                <div style="width:38%;float:left;margin: 0 1% 0 1%;">
                  <mat-form-field name="estRate">
                    <input matInput type="text" [disabled]="true" name="estRateNumber" 
                        [(ngModel)]="additionalCost.value.estimatedRate">                    
                  </mat-form-field>
                </div>
                <div style="width:30%;float:left;line-height: 50px;background-color: #eee;
                padding-left: 5px;">
                  {{additionalCost.value.estimatedRateUom ? additionalCost.value.estimatedRateUom.name : ''}}
                </div>
              </td>
              
              <td> 
                <div style="width:40%;float:left;line-height: 50px;background-color: #eee;
                padding-left: 5px;">
                  {{additionalCost.value.invoiceRateCurrency.code}}
                </div>
                <div style="width:40%;float:left;">
                  <mat-form-field name="estAmt">
                    <input matInput type="text" 
                        [disabled]="true" 
                        name="estAmtNumber" 
                        [(ngModel)]="additionalCost.value.estimatedAmount"
                        amountFormat>                    
                  </mat-form-field>
                </div>
              </td>           
              <td>
                <mat-form-field name="estExtra">
                  <input matInput type="text" 
                      [disabled]="true" 
                      name="estExtraNumber" 
                      [(ngModel)]="additionalCost.value.estimatedExtras"
                      amountFormat>                    
                </mat-form-field>
              </td>
              <td>
                <mat-form-field name="estExtraAmt">
                  <input matInput type="text" 
                      [disabled]="true" 
                      name="estExtraAmtNumber" 
                      [(ngModel)]="additionalCost.value.estimatedExtrasAmount"
                      amountFormat>                    
                </mat-form-field>
              </td>
              <td>
                <div style="line-height: 50px;background-color: #eee;padding-left: 5px;">
                  {{amountFormatValue(additionalCost.value.estimatedAmount + additionalCost.value.estimatedExtrasAmount)}}
                </div>
              </td>
              <td>
                <div style="line-height: 50px;background-color: #eee;padding-left: 5px;">
                  {{additionalCost.value.costType && additionalCost.value.costType.id == 2 ? amountFormatValue((additionalCost.value.invoiceTotalAmount) - (additionalCost.value.estimatedAmount + additionalCost.value.estimatedExtrasAmount)) : amountFormatValue(additionalCost.value.difference)}}
                </div>                
              </td>
            </tr>
          </ng-container>
      </tbody>
    </table>
  </div>