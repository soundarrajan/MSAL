<div class="create-contract-request-popup" >
  <div class="header-container">
    <div class="title">Contract Request Details</div>
    <div class="title-right">
      <button class="custom-button" id="saveReq" style="cursor:pointer;" [ngClass]="enableSaveBtn ? 'blue-btn' : 'grey-btn'" [disabled]="!enableSaveBtn"
      (click)="saveContract();">Save</button>
      <!--button class="custom-button" id="sendRfq" *ngIf="!enableUpdateRfqBtn" [disabled]="!enableRFQBtn"
        [ngClass]="enableRFQBtn ? 'blue-btn' : 'grey-btn'" (click)="sendRFQ()">Send RFQ</button>
      <button class="custom-button" *ngIf="enableUpdateRfqBtn" [disabled]="!enableRFQBtn"
        [ngClass]="enableRFQBtn ? 'blue-btn' : 'grey-btn'" (click)="updateRFQ()">Update RFQ</button-->
      <div class="seperator-line">|</div>
      <span class="close-icon" id="closeDialog" style="cursor:pointer;" [mat-dialog-close]="true"></span>
    </div>
  </div>
  <div class="divider-line"></div>
  <mat-dialog-content>
    <div class="section1 form-fields-with-flex">
      <div id="custom-form-field" class="lightTheme darkBorder">
        <mat-form-field class="without-search" appearance="legacy" [matMenuTriggerFor]="clickmenu"
          #menuTrigger="matMenuTrigger">
          <mat-label *ngIf="selectedPlanValue==''">Plan Period</mat-label>
          <mat-label *ngIf="selectedPlanValue!=''">{{selectedPlanValue}}</mat-label>
          <mat-select>
          </mat-select>
        </mat-form-field>
        <mat-menu #clickmenu="matMenu" class="plan-period-menu">
          <div (click)="$event.stopPropagation(); $event.preventDefault()">
            <div class="header-section">
              <span class="title">Select Your Plan Period</span>
              <button class="blue-button proceed-btn" (click)="applyPlanPeriod();menuTrigger.closeMenu();">Proceed</button>
            </div>
            <div class="plan-period-section">
              <div class="period-types">
                <mat-option *ngFor="let element of planPeriod" [value]="element.type">
                  <mat-radio-button [value]="element.type" [checked]="element.selected"
                    (change)="onSelectPlanPeriod(element)" (click)="$event.stopPropagation();">
                    {{element.type}}
                  </mat-radio-button>
                </mat-option>
              </div>
              <div class="period-seperator">
  
              </div>
              <div class="period-values">
                <div *ngIf="selectedPlanPeriod == 'Quarter'">
                  <div *ngFor="let item of plan.quarterlyPeriod; let i = index;" class="plan-period-flex">
                    <div class="values" [ngClass]="item.selected ? 'selected-values' : ''"
                      (click)="selectPlanPeriod($event,item,selectedPlanPeriod)">{{item.label}}</div>
                  </div>
                </div>
                <div *ngIf="selectedPlanPeriod == 'Month'">
                  <div *ngFor="let item of plan.monthlyPeriod" class="plan-period-flex">
                    <div class="values" [ngClass]="item.selected ? 'selected-values' : ''"
                      (click)="selectPlanPeriod($event,item,selectedPlanPeriod)">{{item.label}}</div>
                  </div>
                </div>
                <div *ngIf="selectedPlanPeriod == 'Year'">
                  <div *ngFor="let item of plan.yearlyPeriod" class="plan-period-flex">
                    <div class="values" [ngClass]="item.selected ? 'selected-values' : ''"
                      (click)="selectPlanPeriod($event,item,selectedPlanPeriod)">{{item.label}}</div>
                  </div>
                </div>
                <div *ngIf="selectedPlanPeriod == 'Semester'">
                  <div *ngFor="let item of plan.semesterPeriod" class="plan-period-flex">
                    <div class="values" [ngClass]="item.selected ? 'selected-values' : ''"
                      (click)="selectPlanPeriod($event,item,selectedPlanPeriod)">{{item.label}}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-menu>
      </div>
      <div id="custom-form-field" class="lightTheme darkBorder">
        <mat-form-field class="without-search" appearance="legacy">
          <mat-label>Start Date</mat-label>
          <input [(ngModel)]="reqObj.startDate" name="startDate" matInput (dateInput)="emptyPlanPeriod()" [matDatepicker]="startDate"
            (focus)="startDate.open()" autocomplete="off" placeholder="Start Date" required>
          <mat-datepicker-toggle matSuffix [for]="startDate">
            <mat-icon matDatepickerToggleIcon [svgIcon]="'data-picker-gray'" style="margin-top: -3px !important;">
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #startDate></mat-datepicker>
        </mat-form-field>
      </div>
      <div id="custom-form-field" class="lightTheme darkBorder">
        <mat-form-field class="without-search" appearance="legacy">
          <mat-label>End Date</mat-label>
          <input [(ngModel)]="reqObj.endDate" name="endDate" matInput (dateInput)="emptyPlanPeriod()" [matDatepicker]="endDate" (focus)="endDate.open()"
            autocomplete="off" placeholder="End Date" required>
          <mat-datepicker-toggle matSuffix [for]="endDate">
            <mat-icon matDatepickerToggleIcon [svgIcon]="'data-picker-gray'" style="margin-top: -3px !important;">
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #endDate></mat-datepicker>
        </mat-form-field>
      </div>
      <div id="custom-form-field" class="lightTheme darkBorder">
        <mat-form-field class="without-search" appearance="legacy">
          <mat-label>Quote by date</mat-label>
          <input [(ngModel)]="reqObj.quoteByDate" name="quoteByDate" matInput [matDatepicker]="quoteByDate" (focus)="quoteByDate.open()"
            autocomplete="off" placeholder="Quote by Date" required>
          <mat-datepicker-toggle matSuffix [for]="quoteByDate">
            <mat-icon matDatepickerToggleIcon [svgIcon]="'data-picker-gray'" style="margin-top: -3px !important;">
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #quoteByDate></mat-datepicker>
        </mat-form-field>
      </div>
      <div id="custom-form-field" class="lightTheme darkBorder">
        <mat-form-field class="without-search" appearance="legacy">
          <mat-label>Minimum Validity Date</mat-label>
          <input [(ngModel)]="reqObj.minValidity" name="minValidity" matInput [matDatepicker]="minValidity" (focus)="minValidity.open()"
            autocomplete="off" placeholder="Minimum Validity Date" required>
          <mat-datepicker-toggle matSuffix [for]="minValidity">
            <mat-icon matDatepickerToggleIcon [svgIcon]="'data-picker-gray'" style="margin-top: -3px !important;">
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #minValidity></mat-datepicker>
        </mat-form-field>
      </div>
    </div>
    <div class="section-divider-line"></div>
    <div class="section2">
      <div id="addQty" (click)="addContractQuantityDetail()" class="add-contract-quantity-section">
        <a class="add-icon"></a>
      </div>
      <div class="contract-quantity-section row">
        <ng-container *ngFor="let quantity of reqObj.quantityDetails; let i = index;">
          <div class="contract-quantity-container col-md-12 pd-0"
            [ngClass]="{'no-padding-right': i % 2 == 1}">
            <a id="removeQty" class="remove-contract-quantity-icon" (click)="removeContractQuantityDetail(i)"></a>
            <div class="quantity-header">
              <div class="col-md-3 pd-0 d-flex align-items-center justify-content-around">
                <span class="label-content">
                  Quantity:
                </span>
                <div style="display: flex; align-items: center;max-width: 176px;">
                  <div class="select-contract-quantity-container value">
                    <div id="qtyType" class="dropdown">
                      <mat-form-field appearance="legacy" class="contract-quantity-select-container">
                        <mat-select [(ngModel)]="reqObj.quantityDetails[i].contractualQuantityOptionId" required disableOptionCentering
                          [panelClass]="'contract-quantity-select-container'">
                          <mat-option *ngFor="let option of staticData.ContractualQuantityOption" [value]="option.id">
                            {{ option.name }}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <div class="border_line"></div>
              <div class="col-md-2 p-lr-5">
                <div class="minInputFocus" style="width:100%;padding: 10px 10px 0;">
                  <span class="label">Min
                    <span style="position: absolute;font-size: 10px;margin-left: 2px;">*</span>
                  </span>
                  <div class="value" id="minQty">
                    <div class="custom-form-field custom-field-contract-quantity lightTheme">
                      <mat-form-field class="without-search quantity-container" appearance="legacy">
                        <input quantityFormat 
                        [(ngModel)]="reqObj.quantityDetails[i].minQuantity"
                        matInput
                        (focus)="focus($event, 'min')"
                        (focusout)="focusOut($event, 'min', 'quantity', i)"
                        (keypress)="keyPressNumber($event)"
                        autocomplete="off"/>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <div class="border_line"></div>
              <div class="col-md-2 p-lr-5">
                <div class="maxInputFocus" style="width:100%;padding: 10px 10px 0;">
                  <span class="label">Max
                    <span style="position: absolute;font-size: 10px;margin-left: 2px;">*</span>
                  </span>
                  <div id="maxQty" class="value">
                      <div class="custom-form-field custom-field-contract-quantity lightTheme">
                        <mat-form-field class="without-search quantity-container" appearance="legacy">
                          <input quantityFormat
                          [(ngModel)]="reqObj.quantityDetails[i].maxQuantity"
                          matInput
                          (focus)="focus($event, 'max')"
                          (focusout)="focusOut($event, 'max', 'quantity', i)"
                          (keypress)="keyPressNumber($event)"
                          autocomplete="off" 
                          required/>
                        </mat-form-field>
                      </div>
                  </div>
                </div>
              </div>
              <div class="border_line"></div>
              <div class="col-md-2 p-lr-5">
                <div class="uomInputFocus" style="width:100%;padding: 10px 10px 0;">
                  <span class="label">Uom</span>
                  <div id="qtyUom" class="value">
                    <div class="custom-form-field custom-field-contract-quantity lightTheme">
                      <mat-form-field class="without-search" appearance="legacy" style="width:60px">
                        <mat-select disableOptionCentering panelClass="uom-select" [(ngModel)]="reqObj.quantityDetails[i].uomId" (focus)="focus($event, 'uom')"
                          panelClass="contract-quantity-select-container">
                          <mat-option *ngFor="let option of staticData.Uom" [value]="option.id">
                            {{ option.name }}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <div class="border_line"></div>
              <div class="col-md-2 p-lr-5">
                <div class="tolInputFocus" style="width:100%;padding: 10px 10px 0;">
                  <span class="label">Tolerance %</span>
                  <div id="qtyTolrance" class="value">
                      <div class="custom-form-field custom-field-contract-quantity lightTheme">
                        <mat-form-field class="without-search" appearance="legacy">
                          <input quantityFormat 
                          [(ngModel)]="reqObj.quantityDetails[i].tolerancePercentage"
                          matInput
                          (focus)="focus($event, 'tol')"
                          (focusout)="focusOut($event, 'tol', 'quantity', i)"
                          (keypress)="keyPressNumber($event)"
                          autocomplete="off" />
                        </mat-form-field>
                      </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
    <div class="section-divider-line"></div>
    <div class="section3">
      <div style="display: flex; flex-direction: row;">
        <a id="addLoc" class="add-product-dropdown-icon" (click)="addNewMainLocation()"></a>
        <div *ngIf="mainLocations.length > 0" style="display: flex; flex-direction: row;">
          <ng-container *ngFor="let loc of mainLocations; let i = index">
            <div class="select-location">
              <div>
                <div class="product-tabs">
                  <div class="addded-product" style="display: inline-flex; margin-right: 10px;">
                    <div id="removeLoc" class="remove-icon" (click)="deleteMainLocation(i)"></div>
                    <div class="product-tab" [ngClass]="{'selected-product-container':loc.selected}"
                      (click)="onClick(loc)">
                      <div class="bootstrap-tagsinput">
                        <div class="tag label border-default text-ellipsis">
                          {{loc.locationName}}
                        </div>
                      </div>
                    </div>
                    <div class="divider" *ngIf=" i != mainLocations.length - 1"></div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>

        <div id="locDrp" class="select-product" [hidden]="!showMainLocationDropdown">
          <mat-form-field class="custom-select main-location-select" appearance="fill">
            <mat-select [disableOptionCentering]="true" #mainLocationSelect
              (closed)="onMainLocationSelectClosed()"
              placeholder="Add Location"
              panelClass="shiptech-select-product-container">
              <app-dark-selection-menu
                [dataSource]="locationsList"
                [columnSource]="locColsToDispay"
                (onSelectionChange)="onLocationChange($event)"
                (closed)="mainLocationSelect.close();">
              </app-dark-selection-menu>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div>
      <div class="main-product-section" [ngStyle]="{'display': (mainLocations.length == 0) ? 'none' : 'block'}">
        <div class="form-fields-with-flex" *ngIf="getLocationProducts().length == 0">
          <a id="addProduct" class="add-icon" (click)="addNewMainProduct(selectedLocationId)"></a>
          <div class="title" (click)="addNewMainProduct(selectedLocationId)">Main Product</div>
        </div>
        <ng-container *ngFor="let prod of reqObj.contractRequestProducts; let i = index;">
          <div *ngIf="prod.locationId == selectedLocationId && !prod.isDeleted">
            <div style="max-height: 50vh; margin-bottom: 45px;">
              <div class="form-fields-with-flex" *ngIf="(prod.status != 'Open') || (getLocationProductIndex(i) != 0)">
                <a id="ADMN64" class="remove-product-icon" (click)="deleteNewMainProduct(i)"></a>
                <div class="title" (click)="deleteNewMainProduct(i)">Remove Product</div>
              </div>
              <div class="main-product">
                <div class="title">Main Product</div>
                <div class="form-fields-with-flex">
                  <div class="row multi-select-formfield">
                    <div class="col-12 no-padding">
                      <ng-container>
                        <ng-container>
                          <div>
                            <div class="hoveraddedProduct">
                              <div class="custom-product-container contract-location-with-product-container d-flex"
                                [ngClass]="{'container-with-value': (productSelected && selectedProindex==i), 'field-disabled':isProductDisabled(i)}"
                                style="margin-right:15px;">
                                <div id="searchProduct" class="custom-form-field custom-form-field-location lightTheme">
                                  <mat-form-field 
                                    [ngClass]="{'field-disabled':isProductDisabled(i)}"
                                    class="without-search custom-dropdown"
                                    appearance="legacy" style="width: 100% !important;">
                                    <mat-label>Add Product</mat-label>
                                    <mat-select #mainProductSelect [disabled]="isProductDisabled(i)"
                                      [value]="reqObj.contractRequestProducts[i].productId" 
                                      (closed)="onMainProductSelectClosed(i)"
                                      (selectionChange)="onMainProductChange($event.value, i);mainProductSelect.close()"
                                      disableOptionCentering [panelClass]="'shiptech-select-product-container'" required>
                                      <div [ngClass]="{'expand-select-location-container': expandLocation}">
                                        <div class="col-md-12 header-container-product pd-0">
                                          <div class="search-product-container col-md-10 pd-0">
                                            <span id="searchPrdLookup" class="search-product-lookup"></span>
                                            <input id="searchPrdInp" 
                                              [(ngModel)]="searchFilterString[i].mainProduct" matInput
                                              (input)="onMainProdSearchChange($event.target.value, i)"
                                              placeholder="Search and select a product"
                                              class="search-product-input" (keydown)="$event.stopPropagation();">
                                          </div>

                                          <div id="expandPrdSrch" class="col-md-2">
                                            <span class="menu-expand-icon" (click)="openProductLookup(i, 'main');"></span>
                                          </div>
                                        </div>
                                        <table class="location-pop-up shiptech-delivery-popup col-md-12 no-padding"
                                          mat-table [dataSource]="listData[i].mainProduct">
                                          <!-- Location name Column -->
                                          <ng-container matColumnDef="name">
                                            <th mat-header-cell *matHeaderCellDef style="padding-left:5px">
                                              Product
                                            </th>
                                            <td mat-cell *matCellDef="let element">
                                              <mat-option [value]="element.id" class="no-padding" id="productPrdRadio"
                                                style="padding-left:0px; text-align: unset !important;">
                                                <mat-radio-button class="location-container-radio-button"
                                                  [class.mat-radio-checked]="element.id==reqObj.contractRequestProducts[i].productId"
                                                  [value]="element.id">
                                                  {{ element.name }}
                                                </mat-radio-button>
                                              </mat-option>
                                            </td>
                                          </ng-container>
                                          <tr mat-header-row *matHeaderRowDef="displayedLocColumns"></tr>
                                          <tr mat-row *matRowDef="let row; columns: displayedLocColumns"></tr>
                                        </table>
                                      </div>
                                    </mat-select>
                                  </mat-form-field>
                                </div>
                                <div>
                                  <a class="product-divider-line remove-product-icon"
                                    style="top: 8px !important;left: 8px;"> </a>
                                </div>
                                <div id="specDrp" class="custom-form-field custom-form-field-location lightTheme">
                                  <mat-form-field
                                    [ngClass]="{'field-disabled':isProductDisabled(i)}"
                                    class="without-search custom-dropdown"
                                    appearance="legacy" style="width: 100% !important;">
                                    <mat-label>Spec Group</mat-label>
                                    <span>

                                    </span>
                                    <mat-select [value]="reqObj.contractRequestProducts[i].specGroupId" 
                                      [(ngModel)]="reqObj.contractRequestProducts[i].specGroupId" 
                                      #singleSelect disableOptionCentering
                                      [panelClass]="'shiptech-select-product-container'" 
                                      [disabled]="isProductDisabled(i)"
                                      required>
                                      <div [ngClass]="{'expand-select-location-container': expandLocation}">
                                        <div class="col-md-12 header-container-product pd-0">
                                          <div class="search-product-container col-md-12 pd-0">
                                            <span id="searchSpecLkp" class="search-product-lookup">
                                            </span>
                                            <input id="searchSpecInp" [(ngModel)]="searchFilterString[i].mainSpecGroup" matInput placeholder="Search and select spec group"
                                              class="search-product-input" (keydown)="$event.stopPropagation();">
                                          </div>

                                          <!--div id="expandSpecSearch" class="col-md-2">
                                            <span class="menu-expand-icon"></span>
                                          </div-->
                                        </div>
                                        <table class="location-pop-up shiptech-delivery-popup col-md-12 no-padding"
                                          mat-table [dataSource]="listData[i].specGroup">
                                          <!-- Location name Column -->
                                          <ng-container matColumnDef="name">
                                            <th mat-header-cell *matHeaderCellDef style="padding-left:5px">
                                              Spec Group
                                            </th>
                                            <td mat-cell *matCellDef="let element"
                                              style="padding-left:0px; text-align: unset !important;">
                                              <mat-option [value]="element.id" class="no-padding" id="specSrdRadio"
                                                style="padding-left:0px; text-align: unset !important;">
                                                <mat-radio-button class="location-container-radio-button"
                                                  [class.mat-radio-checked]="element.id==reqObj.contractRequestProducts[i].specGroupId"
                                                  [value]="element.id">
                                                  {{ element.name }}
                                                </mat-radio-button>
                                              </mat-option>
                                            </td>
                                          </ng-container>

                                          <!-- Country Column -->
                                          <ng-container matColumnDef="type">
                                            <th mat-header-cell *matHeaderCellDef>Type</th>
                                            <td mat-cell *matCellDef="let element">
                                              {{ element.type}}
                                            </td>
                                          </ng-container>
                                          <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
                                          <tr mat-row *matRowDef="let row; columns: displayedColumns2"></tr>
                                        </table>
                                      </div>
                                    </mat-select>
                                  </mat-form-field>
                                </div>
                              </div>
                            </div>
                          </div>
                        </ng-container>
                      </ng-container>
                    </div>
                  </div>
                  <div id="custom-form-field" class=" lightTheme" style="margin:0px 10px;">
                    <div class="split-field minInputFocus" style="width: 190px;height: 34px !important;">
                      <mat-form-field id="prdMinQty" class="without-search long-label-field"
                        style="width: 64%;height: 30px !important;border: none;" placeholder="Minimum Qty"
                        appearance="legacy">
                        <mat-label>Minimum Qty</mat-label>
                        <input quantityFormat class="text-ellipsis" value="100"
                          [(ngModel)]="reqObj.contractRequestProducts[i].minQuantity"
                          matInput
                          (focus)="focus($event, 'min')"
                          (focusout)="focusOut($event, 'min', 'product', i)"
                          (keypress)="keyPressNumber($event)"
                          autocomplete="off"
                          >
                      </mat-form-field>
                      <mat-form-field class="long-label-field"
                        style="line-height: 22px;width: 36%;height: 34px !important;border-radius: 4px;"
                        appearance="legacy">
                        <mat-select disableOptionCentering panelClass="uom-select" 
                          [(ngModel)]="reqObj.contractRequestProducts[i].minQuantityUomId" 
                          (selectionChange)="syncMinMaxUom('min', i)" 
                          style="background-color: #EBECED !important;">
                          <mat-option *ngFor="let option of staticData.Uom" [value]="option.id">{{option.name}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                  <div id="custom-form-field" class=" lightTheme" style="margin:0px 10px;">
                    <div class="split-field maxInputFocus" style="width: 190px;height: 34px !important;">
                      <mat-form-field id="prdMaxQty" class="without-search long-label-field"
                        style="width: 64%;height: 30px !important;border: none;" placeholder="Maximum Qty"
                        appearance="legacy">
                        <mat-label>Maximum Qty</mat-label>
                        <input quantityFormat class="text-ellipsis" value="100"
                          [(ngModel)]="reqObj.contractRequestProducts[i].maxQuantity"
                          matInput
                          (focus)="focus($event, 'max')"
                          (focusout)="focusOut($event, 'max', 'product', i)"
                          (keypress)="keyPressNumber($event)"
                          autocomplete="off"
                          >
                      </mat-form-field>
                      <mat-form-field class="long-label-field"
                        style="line-height: 22px;width: 36%;height: 34px !important;border-radius: 4px;"
                        appearance="legacy">
                        <mat-select disableOptionCentering panelClass="uom-select" 
                          [(ngModel)]="reqObj.contractRequestProducts[i].maxQuantityUomId" 
                          (selectionChange)="syncMinMaxUom('max', i)" 
                          style="background-color: #EBECED !important;">
                          <mat-option *ngFor="let option of staticData.Uom" [value]="option.id">
                            {{option.name}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                  <div id="custom-form-field" class="lightTheme darkBorder" style="margin: 0px 10px;">
                    <mat-form-field 
                      [ngClass]="{'field-disabled':isProductDisabled(i)}" 
                      id="prdPriceType" class="without-search" style="width:198px" 
                      appearance="legacy"
                    >
                      <mat-label>Pricing Type</mat-label>
                      <mat-select required 
                        panelClass="pricing-type-select"
                        [(ngModel)]="reqObj.contractRequestProducts[i].pricingTypeId"
                        [disabled]="isProductDisabled(i)">
                        <mat-option *ngFor="let option of staticData.PricingType" [value]="option.id">
                          {{option.name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
                <div
                  class="custom-form-field custom-field-general lightTheme darkBorder custom-form-field-margin-contract"
                  style="width:100%;margin-top: 8px;">
                  <mat-form-field 
                    [ngClass]="{'field-disabled':isProductDisabled(i)}" 
                    id="prdPriceComments" class="without-search" 
                    appearance="legacy" style="width: 100% !important;"
                  >
                    <mat-label [ngClass]="{'field-disabled':isProductDisabled(i)}">Pricing Comments</mat-label>
                    <input
                      matInput placeholder="Pricing Comments"
                      [(ngModel)]="reqObj.contractRequestProducts[i].pricingComment"
                      [disabled]="isProductDisabled(i)" >
                  </mat-form-field>
                </div>
              </div>
              <div class="d-flex">
                <!-- max-widthflex: 0 0 55%; -->
                <div class="m-t-10" style="flex: 0 0 55%;">
                  <div class="sub-title">Allowed Products</div>
                  <div class="row multi-select-formfield">
                    <div class="col-12 no-padding d-flex flex-wrap" >
                      <a
                        class="add-product-dropdown-icon"
                        (click)="!isProductDisabled(i) && addNewAllowedProduct(i)">
                      </a>
                      <ng-container *ngFor="let contractProduct of reqObj.contractRequestProducts[i].allowedProducts | keyvalue: originalOrder; let j = index">
                        <ng-container>
                          <div>
                            <div class="contract-addProduct-separator" *ngIf="j > 0"></div>
                            <div class="hoveraddedProduct">
                              <div
                                class="hover-remove-icon"
                                *ngIf="!isProductDisabled(i)"
                                (click)="removeProductToContract(i, j)">
                              </div>
                              <div class="contract-location-with-product-container d-flex" 
                                [ngClass]="{'container-with-value': productSelected && selectedProindex==i}"
                                style="margin-right:0">
                                <div id="allowedPrds" class="custom-form-field custom-form-field-location lightTheme"
                                  [ngClass]="{'container-location-with-value': locationSelected && selectedLocindex==i}">
                                  <mat-form-field class="without-search contract-location-product-dropdown"
                                    appearance="legacy" style="width: 100% !important; border-right: none !important;">
                                    <mat-label>Add Product</mat-label>
                                    <mat-select #allowedProductSelects 
                                      [disabled]="isProductDisabled(i)"
                                      [(ngModel)]="reqObj.contractRequestProducts[i].allowedProducts[j].productId"
                                      #locSelect disableOptionCentering
                                      (closed)="onAllowedProductSelectClosed(i, j)"
                                      [panelClass]="'shiptech-select-product-container'"
                                      (selectionChange)="setProductChange($event.value,i,j); allowedProductSelects.close()">
                                      <div [ngClass]="{'expand-select-location-container': expandLocation}">
                                        <div class="col-md-12 header-container-product pd-0">
                                          <div class="search-product-container col-md-10 pd-0">
                                            <span id="allowedPrdSearch" class="search-product-lookup">
                                            </span>
                                            <input id="allowedPrdAdd" matInput 
                                              placeholder="Search and select a product"
                                              [(ngModel)]="this.searchFilterString[i].allowedProducts[j].product"
                                              (input)="onAllowedProdSearchChange($event.target.value, i, j)"
                                              class="search-product-input" (keydown)="$event.stopPropagation();">
                                          </div>

                                          <div id="allowedPrdSrcImg" class="col-md-2">
                                            <span class="menu-expand-icon" (click)="openProductLookup(i, 'allowed', j)"></span>
                                          </div>
                                        </div>
                                        <table class="location-pop-up shiptech-delivery-popup col-md-12 no-padding"
                                          mat-table [dataSource]="listData[i].allowedProducts[j].products">
                                          <!-- Location name Column -->
                                          <ng-container matColumnDef="name">
                                            <th mat-header-cell *matHeaderCellDef style="padding-left:5px">
                                              Product
                                            </th>
                                            <td mat-cell *matCellDef="let element">
                                              <mat-option [value]="element.id" id="allowedPrdRadio" class="no-padding"
                                                style="padding-left:0px; text-align: unset !important;">
                                                <mat-radio-button class="location-container-radio-button"
                                                  [class.mat-radio-checked]="element.id==reqObj.contractRequestProducts[i].allowedProducts[j].productId"
                                                  [value]="element.id">
                                                  {{ element.name }}
                                                </mat-radio-button>
                                              </mat-option>
                                            </td>
                                          </ng-container>
                                          <tr mat-header-row *matHeaderRowDef="displayedLocColumns"></tr>
                                          <tr mat-row *matRowDef="let row; columns: displayedLocColumns"></tr>
                                        </table>
                                      </div>
                                    </mat-select>
                                  </mat-form-field>
                                </div>
                                <div [ngClass]="{'container-with-value': productSelected && selectedProindex==i}">
                                  <a class="remove-product-black-icon remove-product-icon"> </a>
                                </div>
                                <div class="custom-form-field custom-form-field-location lightTheme" 
                                  [ngClass]="{'container-product-with-value': productSelected && selectedProindex==i}">
                                  <mat-form-field class="without-search contract-location-product-dropdown"
                                    appearance="legacy" style="width: 100% !important; border-left: none !important;">
                                    <mat-label>Spec Group</mat-label>
                                    <span></span>
                                    <mat-select 
                                      [disabled]="isProductDisabled(i)"
                                      [(ngModel)]="reqObj.contractRequestProducts[i].allowedProducts[j].specGroupId"
                                      #singleSelect
                                      disableOptionCentering [panelClass]="'shiptech-select-product-container'"
                                      (selectionChange)="setSpecGroupChange($event.value,i,j)">
                                      <div style="margin-top: 0px;" [ngClass]="{'expand-select-location-container': expandLocation}">
                                        <div class="col-md-12 header-container-product pd-0">
                                          <div class="search-product-container col-md-12 pd-0">
                                            <span class="search-product-lookup">
                                            </span>
                                            <input matInput placeholder="Search and select spec group"
                                              class="search-product-input" (keydown)="$event.stopPropagation();">
                                          </div>

                                          <!--div class="col-md-2">
                                            <span class="menu-expand-icon"></span>
                                          </div-->
                                        </div>
                                        <table class="location-pop-up shiptech-delivery-popup col-md-12 no-padding"
                                          mat-table [dataSource]="listData[i].allowedProducts[j].specGroup">
                                          <!-- Location name Column -->
                                          <ng-container matColumnDef="name">
                                            <th mat-header-cell *matHeaderCellDef style="padding-left:5px">
                                              Spec Group
                                            </th>
                                            <td mat-cell *matCellDef="let element"
                                              style="padding-left:0px; text-align: unset !important;">
                                              <mat-option [value]="element.id" class="no-padding"
                                                style="padding-left:0px; text-align: unset !important;">
                                                <mat-radio-button class="location-container-radio-button"
                                                  [class.mat-radio-checked]="element.id==reqObj.contractRequestProducts[i].allowedProducts[j].specGroupId"
                                                  [value]="element.id">
                                                  {{ element.name }}
                                                </mat-radio-button>
                                              </mat-option>
                                            </td>
                                          </ng-container>

                                          <!-- Country Column -->
                                          <ng-container matColumnDef="type">
                                            <th mat-header-cell *matHeaderCellDef>Type</th>
                                            <td mat-cell *matCellDef="let element">
                                              {{ element.type}}
                                            </td>
                                          </ng-container>
                                          <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
                                          <tr mat-row *matRowDef="let row; columns: displayedColumns2"></tr>
                                        </table>
                                      </div>
                                    </mat-select>
                                  </mat-form-field>
                                </div>
                              </div>
                            </div>
                          </div>
                        </ng-container>
                      </ng-container>
                    </div>
                  </div>
                </div>
                <div style="margin:35px 28px 20px 25px; border-right:solid 1px #C3C6CC"></div>
                <!-- style="flex:1 1 39%" -->
                <div class="m-t-10" >
                  <div class="sub-title">Allowed Locations</div>
                  <div  class="col-12 no-padding d-flex">
                    <a
                      class="add-product-dropdown-icon"
                      (click)="!isProductDisabled(i) && addNewAllowedLocation(i)">
                    </a>
                    <div class="product-tabs flex-wrap p-l-8">
                      <ng-container *ngIf="productAllowedLocations[i]">
                      <div class="addded-product" *ngFor="let allowedLoc of productAllowedLocations[i]; let loc = index"
                        style="display: inline-flex; margin-right: 5px;margin-bottom: 5px;">
                        <div
                          class="remove-icon"
                          *ngIf="!isProductDisabled(i)"
                          (click)="deleteAllowedLocation(i, loc)">
                        </div>
                        <div class="location-tab" [ngClass]="{'selected-product-container':allowedLoc.selected}">
                          <div class="bootstrap-tagsinput">
                            <span class="tag label border-default text-ellipsis">
                              {{allowedLoc.name}}
                            </span>
                          </div>
                        </div>
                        <div class="divider" *ngIf="loc != productAllowedLocations[i].length - 1"></div>
                      </div>
                    </ng-container>
                    <div class="select-product" *ngIf="!hideAllowedLocationDropdown[i]">
                      <mat-form-field 
                        [ngClass]="{'field-disabled':isProductDisabled(i)}"
                        id="allowedLocs" class="custom-select" appearance="fill">
                        <mat-select 
                          [disabled]="isProductDisabled(i)"
                          [disableOptionCentering]="true" #allowedLocationSelect
                          placeholder="Add Location"
                          (closed)="searchFilterString[i].allowedLocations=''"
                          (selectionChange)="addSelectedAllowedLocation(i,$event.value)"
                          panelClass="shiptech-select-product-container">
                          <div class="col-md-12 header-container-product pd-0">
                            <div class="search-product-container col-md-10 pd-0">
                              <span id="allowedLocLkp" class="search-product-lookup">
                              </span>
                              <input id="allowedLocInp" matInput
                                [(ngModel)]="searchFilterString[i].allowedLocations"
                                placeholder="Search and select a location"
                                class="search-product-input"
                                (keydown)="$event.stopPropagation();">
                            </div>

                            <div id="allowedLocAdd" class="col-md-2">
                              <span class="menu-expand-icon" (click)="openAllowedLocationLookup(i)"></span>
                            </div>
                          </div>
                          <table class="delivery-products-pop-up shiptech-delivery-popup col-md-12 no-padding" mat-table
                            [dataSource]="locationDataSource(searchFilterString[i].allowedLocations)">
                            <ng-container matColumnDef="location">
                              <th mat-header-cell *matHeaderCellDef style="padding-left:0px;"> Location </th>
                              <td mat-cell *matCellDef="let element">
                                <mat-option [value]="element" id="allowedLocRadio"
                                  style="padding-left:0px; text-align: unset !important;">
                                  <mat-radio-button [value]="element">
                                    {{element.name}}
                                  </mat-radio-button>
                                </mat-option>
                              </td>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                          </table>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                  </div>
                </div>
            </div>
            </div>
            <div class="section-divider-line"></div>
            <div class="form-fields-with-flex" *ngIf="getLocationProductIndex(i) == getLocationProducts().length - 1">
              <a id="addProduct" class="add-icon" (click)="addNewMainProduct(selectedLocationId)"></a>
              <div class="title" (click)="addNewMainProduct(selectedLocationId)">Main Product</div>
            </div>
          </div>
        </ng-container>
      </div>
      </div>

    </div>
    <div class="section-divider-line"></div>
    <div class="section4">
      <span class="title">Supplier Comments</span>
      <div style="margin-top: 10px;padding-left:0" class="col-md-12 pd-0 supplierComments">
        <textarea [(ngModel)]="reqObj.supplierComments"
          id="supplierComments" placeholder="General Comments to Supplier"
          autocomplete="off">
        </textarea>
      </div>
    </div>
  </mat-dialog-content>
</div>