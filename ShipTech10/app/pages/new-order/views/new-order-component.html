<div class="dynamic_form_editor">
    <div class="row  ">
        <div class="st-main-content-menu st-displaceable-menu tabbable-line ">
            <div class="form-inline pull-left">
                <span class="select_visible_sections_label ">
                    Display:
                </span>
                <span>
                    <select class="form-control selectpicker col-md-8 visibleSectionsFilter"
                            data-selected-text-format="count> 3"
                            id="multiple" multi-select
                            multiple ng-change="showHideSections(visible_sections)"
                            ng-model="visible_sections">
                        <option disabled="" value=""></option>
                        <option selected value="order_details">
                            Order Details
                        </option>
                        <option selected value="products">
                            Products
                        </option>

                    </select>
                    <label class="mt-checkbox" ng-init="more=true">
                        <input ng-model="more" type="checkbox"/> More Information
                        <span></span>
                    </label> 
                </span>
            </div>
            <div class="pull-right">
                <form class="form-inline">
                    <div class="form-group">
                        <a class="btn btn-auto-width font-grey-cascade" ng-click="$ctrl.orderPreviewEmail()">
                            <i class="glyphicon glyphicon-envelope" style="font-size: 18px;line-height: 15px;"></i>
                        </a>
                        <a class="btn btn-default"
                           ng-class="{'disabled': $ctrl.buttonsDisabled || $ctrl.data.status.name == 'Cancelled'}"
                           ng-click="$ctrl.saveOrder()"
                           ng-show="$ctrl.canSave($ctrl.screenActions)">
                            Save
                        </a>
                        <a ng-if="!$ctrl.tenantSettings.shiptechLite" class="btn btn-default" ng-class="{'disabled': !$ctrl.data.id}"
                           ng-href="#/reports/ordernegotiation/OrderId={{$ctrl.data.id}}"
                           ng-show="{{$ctrl.tenantSettings.defaultValues.isSSRSReports}}" target="blank">
                            Order Negotiation Report
                        </a>
                        <a class="btn btn-sm btn-default hover-orange" href=""
                           ng-class="{'green-jungle': $ctrl.data.emailToSellerSent && !$ctrl.ConfirmToSellerDisabled}"
                           ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_SELLER, $ctrl.data.id)"
                           ng-disabled="$ctrl.ConfirmToSellerDisabled = !($ctrl.data.id && $ctrl.confirmToSellerManual &&
                                      !$ctrl.data.buttonsDisabled && $ctrl.data.seller.name &&
                                      ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                           ng-if="$ctrl.dtoHasAction($ctrl.SCREEN_ACTIONS.CONFIRMSELLEREMAIL)">
                            Confirm to Seller
                        </a>
                        <a class="btn btn-sm btn-default hover-orange" href=""
                           ng-class="{'green-jungle': $ctrl.data.emailToVesselSent && !$ctrl.ConfirmToVesselDisabled}"
                           ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_ALL, $ctrl.data.id)"
                           ng-disabled="$ctrl.ConfirmToVesselDisabled = !($ctrl.data.id && $ctrl.confirmToVesselManual &&
                                      !$ctrl.data.buttonsDisabled && !ctrl.data.vessel.name &&
                                      ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                           ng-if="$ctrl.dtoHasAction($ctrl.SCREEN_ACTIONS.CONFIRMALLEMAIL)">
                            Confirm to Vessel
                        </a>
                        <a class="btn btn-sm btn-default hover-orange" href=""
                           ng-class="{'green-jungle': $ctrl.data.emailToLabsSent && !EmailToLabsDisabled}"
                           ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_LABS, $ctrl.data.id)"
                           ng-disabled="EmailToLabsDisabled = !($ctrl.data.id && $ctrl.orderConfirmationEmailToLabs.name == 'Manual' &&
                                    $ctrl.data.lab.name && !$ctrl.data.buttonsDisabled &&
                                    ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                           ng-if="['None','Automatic'].indexOf($ctrl.orderConfirmationEmailToLabs.name) == -1 && !$ctrl.tenantSettings.shiptechLite">
                            Email to Labs
                        </a>
                        <a class="btn btn-sm btn-default hover-orange" href=""
                           ng-class="{'green-jungle': $ctrl.data.emailToSurvSent && !EmailToSurveyorDisabled}"
                           ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_SURVEYOR, $ctrl.data.id)"
                           ng-disabled="EmailToSurveyorDisabled = !($ctrl.data.id && $ctrl.orderConfirmationEmailToSurveyor.name == 'Manual' &&
                                    $ctrl.data.surveyorCounterparty.name && !$ctrl.data.buttonsDisabled &&
                                    ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                           ng-if="['None','Automatic'].indexOf($ctrl.orderConfirmationEmailToSurveyor.name) == -1">
                            Email to Surveyor
                        </a>
                       <a class="btn orange btn-outline"
                           ng-class="{'disabled': $ctrl.buttonsDisabled || !$ctrl.hasAction($ctrl.SCREEN_ACTIONS.SUBMITFORAPPROVAL)}"
                           ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.SUBMIT_FOR_APPROVAL, $ctrl.data.id)">
                            Submit for Approval
                        </a>
                        <a class="btn btn-orange {{!$ctrl.data.id || $ctrl.buttonsDisabled || !$ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) ? '' : 'bg-yellow-gold-opacity font-white'}}"
                           ng-class="{'disabled font-dark': !$ctrl.data.id || $ctrl.buttonsDisabled || !$ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM)}"
                           ng-click="$ctrl.confirmOrder(true)">
                            Confirm
                        </a>
                        <div class="btn-group">
                            <a aria-expanded="false" class="btn btn-default dropdown-toggle st-show-buttons"
                               data-toggle="dropdown">
                                &hellip;
                            </a>
                            <ul class="dropdown-menu st-extra-buttons" role="menu">
                                <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.CANCELORDER)">
                                    <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CANCEL, $ctrl.data.id)"
                                       ng-if="$ctrl.data.id && $ctrl.data.status.id !== $ctrl.STATUS['Cancelled'].id">
                                        Cancel
                                    </a>
                                </li>
                                <li>
                                    <a ng-click="$ctrl.sendOrderCommand('updateCancelOrderReason', $ctrl.data.id)"
                                       ng-if="$ctrl.data.id && $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id && $ctrl.procurementSettings.order.captureReasonToCancelTheOrder.name == 'Yes'">
                                        Update Reason
                                    </a>
                                </li>
                                <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.REJECTORDER)">
                                    <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.REJECT, $ctrl.data.id)">
                                        Reject
                                    </a>
                                </li>
                                <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.APPROVEORDER)">
                                    <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.APPROVE, $ctrl.data.id)">
                                        Approve
                                    </a>
                                </li>
                                <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.AMENDORDER)">
                                    <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.AMEND, $ctrl.data.id)">
                                        Amend
                                    </a>
                                </li>
                                <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.RECONFIRM) && $ctrl.canReconfirm()">
                                    <a class="bg-yellow-gold-opacity font-white"
                                       ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.RECONFIRM, $ctrl.data.id)">
                                        Reconfirm
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </form>
            </div>
            <span class="clearfix"></span>
        </div>
    </div>
    <div class="row">
        <div class="st-main-content-menu st-displaceable-menu tabbable-line tabs_bar" ng-show="more">
            <ul class="nav nav-tabs pull-left">
                <li ng-class="{open: $ctrl.state.is($ctrl.STATE.NEW_ORDER) || $ctrl.state.is($ctrl.STATE.EDIT_ORDER)}">
                    <a ui-sref="{{ $ctrl.STATE.NEW_ORDER }}">
                        Order
                    </a>
                </li>
                <li ng-if="false">
                    <a>
                        Transaction KPI
                    </a>
                </li>
                <li>
                    <a ng-class="{'disabled' : !$ctrl.data.id}"
                       ui-sref="default.view-order-documents({orderId: NAV.orderId})">
                        Documents
                    </a>
                </li>
                <li ng-controller="Controller_Master as CM">
                    <a ng-class="{'disabled' : !$ctrl.data.id}"
                       ng-click="sellerRatingScreen('Procurement', 'Procurement', NAV.orderId)">
                        Rate Seller
                    </a>
                </li>
                <li>
                    <a ng-class="{'disabled' : !$ctrl.data.id}"
                       ui-sref="default.view-order-auditlog({orderId: NAV.orderId})">
                        Audit Log
                    </a>
                </li>
                <li>
                    <a ng-class="{'disabled' : !$ctrl.data.id}"
                       ui-sref="default.view-order-emaillog({orderId: NAV.orderId})">
                        Email Log
                    </a>
                </li>
            </ul>
            <div class="clearfix"></div>
        </div>
    </div>
    <div class="row">
<!--        RELATED ORDERS-->
        <div class="col-md-12 no-padding-left">
            <div class="portlet light stretch-vertical">
                <div class="portlet-title">
                    <div class="tools">
                        <a class="collapse" data-original-title="" href="" title=""></a>
                    </div>
                    <div class="caption">
                        <div class="caption-subject">
                            RELATED ORDERS
                        </div>
                    </div>
                </div>
                <div class="portlet-body">

                    <div class="pull-left related-entity-item"
                         ng-if="!$ctrl.relatedOrders || $ctrl.relatedOrders.length == 0">
                        <div class="col-sm-12">
                            <div class="note note-related active">
                                <p>
                                    <b>
                                        Order No
                                    </b>
                                    : {{ $ctrl.data.name }}
                                </p>
                                <p>
                                    <b>
                                        Status
                                    </b>
                                    : {{ $ctrl.data.status.displayName }}
                                </p>
                                <p>
                                    <b>
                                        Port
                                    </b>
                                    : {{ $ctrl.data.location.name }}
                                </p>
                                <p>
                                    <b>
                                        ETA
                                    </b>
                                    : <span ng-controller="Controller_Master as CM"> {{ CM.formatDateTime($ctrl.data.eta, null, 'eta') }} </span>
                                </p>
                                <p>
                                    <b>
                                        Seller
                                    </b>
                                    : {{ $ctrl.data.seller.name }}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="pull-left related-entity-item" ng-repeat="(orderK, orderVal) in $ctrl.relatedOrders">
                        <div class="col-sm-12">
                            <div class="note note-related pull-left"
                                 ng-class="{'active' : orderVal.id == $ctrl.data.id}">
                                <a href="/#/edit-order/{{ orderVal.id }}">
                                    <p>
                                        <b>
                                            Order No
                                        </b>
                                        : {{ orderVal.name }}
                                    </p>
                                    <p>
                                        <b>
                                            Status
                                        </b>
                                        : {{ orderVal.status.displayName }}
                                    </p>
                                    <p>
                                        <b>
                                            Port
                                        </b>
                                        : {{ orderVal.port.name }}
                                    </p>
                                    <p>
                                        <b>
                                            ETA
                                        </b>
                                        : <span ng-controller="Controller_Master as CM"> {{ CM.formatDateTime(orderVal.eta, null, 'eta') }} </span>
                                    </p>
                                    <p>
                                        <b>
                                            Seller
                                        </b>
                                        : {{ orderVal.seller.name }}
                                    </p>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>

        </div>
<!--        ORDER DETAILS-->
        <div class="col-md-12 no-padding-left" ng-hide="visible_sections.indexOf('order_details') < 0">
            <div class="portlet light stretch-vertical">
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <div class="row">
                            <div class="portlet light">
                                <div class="portlet-title">
                                    <div class="tools">
                                        <a class="collapse" data-original-title="" href=""
                                           ng-click="toggleOrderSummary = !toggleOrderSummary"
                                           title=""></a>
                                    </div>
                                    <div class="caption">
                                        <span class="caption-subject">
                                            Order Details
                                            <span ng-if="$ctrl.data.request">
                                                -
                                                <a href="#/edit-request/{{ $ctrl.data.request.id }}">
                                                    {{ $ctrl.data.request.name }}
                                                </a>
                                                {{ $ctrl.vesselDetailsFields.Vessel.caption | translate }} {{$ctrl.data.vessel.name}}
                                                -
                                                {{$ctrl.data.voyageCode}}
                                            </span>
                                        </span>
                                    </div>
                                    <span class="header-status pull-right" style="display: flex;">
                                        <span ng-if="$ctrl.procurementSettings.order.orderVerificationReq.name == 'Yes'" style="display: flex; cursor: pointer;">
                                            <span style="margin-right: 10px;">Verify</span>
                                            <label class="mt-checkbox" id="verifyCheckboxLabel" style="margin:0; padding-left: 46px;" >
                                                <input type="checkbox" name="verifyCheckbox" id="verifyCheckboxInput" ng-change="$ctrl.verifyOrder()" ng-disabled="$ctrl.data.isVerifiedBool" ng-model="$ctrl.data.isVerifiedBool" />
                                                <span></span>
                                            </label>
                                        </span>
                                        <b>
                                            Status:
                                        </b>
                                        <span class="label" ng-if="$ctrl.data.status"
                                              style="background: {{ $ctrl.data.status.bg }}">
                                            {{ $ctrl.data.status.displayName ? $ctrl.data.status.displayName : $ctrl.data.status.name }}
                                        </span>
                                    </span>
                                </div>

                                    <span class="clearfix"></span>
                                    <div class="portlet-body">

                                        <form autocomplete="off" class="form-horizontal st-new-order-form"
                                              id="vesselDetails" name="forms.vesselDetailsForm">

                                            <div class="row">
                                                <div class="col-md-3">
                                                    <div><div class="form-group row">
                                                        <label class="{{ $ctrl.sellerDetails.Trader.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.VesselImoNo.name }}">
                                                            Vessel
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                            &nbsp;
                                                            <span ng-if="$ctrl.data.vessel.vesselToWatchFlag">
                                                                <i class="fa fa-flag vesselToWatchFlag"></i>
                                                            </span>
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.VesselImoNo.name }} input-group">
                                                            <div class="input-group">
                                                                <input class="typeahead form-control"
                                                                       id="id_{{ $ctrl.vesselDetailsFields.Vessel.name }}"
                                                                       name="{{ $ctrl.vesselDetailsFields.Vessel.name }}"
                                                                       ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Stemmed'].id || $ctrl.data.status.id === $ctrl.STATUS['Delivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyDelivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyInvoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Invoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Approved'].id || $ctrl.data.status.id === $ctrl.STATUS['WaitingForApproval'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id"
                                                                       ng-model="$ctrl.data.vessel.name"
                                                                       required
                                                                       typeahead-append-to-body="true"
                                                                       typeahead-editable="false"
                                                                       typeahead-on-select="$ctrl.selectVessel($item.id); CM.getOptions({'Name': 'BunkerablePort','masterSource': 'masters_locations', 'filters': $ctrl.data.vessel})"
                                                                       uib-typeahead="vessel as vessel.name for vessel in $ctrl.listsCache.Vessel | typeaheadCustomFilter:$viewValue:'name'">
                                                                <span class="input-group-addon ng-scope"
                                                                      ng-click="triggerModal('general', 'masters_vessellist', 'Vessel' , 'vessel');"
                                                                      ng-controller="Controller_Master as CM"
                                                                      ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Stemmed'].id || $ctrl.data.status.id === $ctrl.STATUS['Delivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyDelivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyInvoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Invoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Approved'].id || $ctrl.data.status.id === $ctrl.STATUS['WaitingForApproval'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id">
                                                                    <a class=" btn default" href=""
                                                                       ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Stemmed'].id || $ctrl.data.status.id === $ctrl.STATUS['Delivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyDelivered'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyInvoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Invoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['Approved'].id || $ctrl.data.status.id === $ctrl.STATUS['WaitingForApproval'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id">
                                                                        <i class="fa fa-search"></i>
                                                                    </a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div></div>
                                                    <div ng-if="$ctrl.portFields.carrierCompany.visible"><div
                                                            class="form-group row">
                                                        <label class="{{ $ctrl.portFields.carrierCompany.name }}_label"
                                                               for="{{ $ctrl.portFields.carrierCompany.name }}">
                                                            <span ng-if='$ctrl.tenantSettings.companyDisplayName.name == "Pool"'>
                                                                {{$ctrl.tenantSettings.companyDisplayName.name | translate}}
                                                            </span>
                                                            <span ng-if='$ctrl.tenantSettings.companyDisplayName.name != "Pool"'>
                                                                {{ $ctrl.portFields.carrierCompany.caption | translate }}
                                                            </span>
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.portFields.carrierCompany.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.portFields.carrierCompany.name }}"
                                                                   name="{{ $ctrl.tenantSettings.companyDisplayName.name == 'Pool' ? ($ctrl.tenantSettings.companyDisplayName.name | translate) : ($ctrl.portFields.carrierCompany.caption | translate) }}"
                                                                   ng-blur="$ctrl.setPaymentCompany()"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.data.status.id === $ctrl.STATUS['Invoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyInvoiced'].id"
                                                                   ng-focus="$ctrl.initLookup($ctrl.portFields.carrierCompany.name, $ctrl.data.carrierCompany)"
                                                                   ng-model="$ctrl.data.carrierCompany.name"
                                                                   required
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.selectCompany($item.id)"
                                                                   uib-typeahead="carrierCompany as carrierCompany.name for carrierCompany in $ctrl.lists.Company | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_companylist', 'Carrier' ,'carrier',null,null,null,'bargeList');"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.data.status.id === $ctrl.STATUS['Invoiced'].id || $ctrl.data.status.id === $ctrl.STATUS['PartiallyInvoiced'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div></div>
                                                    <div ng-if="$ctrl.portFields.paymentCompany.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.portFields.paymentCompany.name }}_label"
                                                               for="{{ $ctrl.portFields.paymentCompany.name }}">

                                                            {{ "Payment " + $ctrl.tenantSettings.companyDisplayName.name | translate }}
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.portFields.paymentCompany.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.portFields.paymentCompany.name }}"
                                                                   name="{{ 'Payment ' + $ctrl.tenantSettings.companyDisplayName.name | translate }}"
                                                                   ng-change="$ctrl.initLookup($ctrl.portFields.paymentCompany.name, $ctrl.data.paymentCompany)"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-focus="$ctrl.initLookup($ctrl.portFields.paymentCompany.name, $ctrl.data.paymentCompany)"
                                                                   ng-model="$ctrl.data.paymentCompany.name"
                                                                   required
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.selectCompany($item.id)"
                                                                   uib-typeahead="paymentCompany as paymentCompany.name for paymentCompany in $ctrl.lists.Company | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_companylist', $ctrl.tenantSettings.companyDisplayName.name ,'paymentCompany',null,null,null,null);"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.vesselDetailsFields.Buyer.visible">
                                                    <div class="form-group  row">
                                                        <label class="{{ $ctrl.sellerDetails.Trader.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.Buyer.name }}">
                                                            {{ $ctrl.vesselDetailsFields.Buyer.caption | translate }}
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.Buyer.name }} input-group">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.vesselDetailsFields.Buyer.name }}"
                                                                   name="{{ $ctrl.vesselDetailsFields.Buyer.name }}"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.buyer.name"
                                                                   required
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select=" $ctrl.isTrader = false; $ctrl.selectBuyer($item);"
                                                                   uib-typeahead="buyer as buyer.name for buyer in $ctrl.lists.Buyer | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_buyerlist', 'Buyer' ,'buyer',null,null,null,null); $ctrl.isTraderField = false"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href=""
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div><div class="form-group  row">
                                                        <label class="{{ $ctrl.sellerDetails.Trader.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.Trader.name }}">
                                                            {{ $ctrl.sellerDetails.Trader.name | translate }}

                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.Trader.name }} input-group">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.sellerDetails.Trader.name }}"
                                                                   name="{{ $ctrl.sellerDetails.Trader.name }}"
                                                                   ng-model="$ctrl.data.trader.name"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.isTrader = true; $ctrl.selectTrader($item);"
                                                                   uib-typeahead="trader as trader.name for trader in $ctrl.lists.Buyer | typeaheadCustomFilter:$viewValue:'name'"
                                                            />
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_buyerlist', 'Trader' ,'trader',null,null,null,null); $ctrl.isTraderField = true"
                                                                  ng-controller="Controller_Master as CM">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div></div>
                                                    <div><div class="form-group row">
                                                        <label class="{{ $ctrl.sellerDetails.PaymntTerms.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.PaymntTerms.name }}">
                                                            {{ $ctrl.sellerDetails.PaymntTerms.caption | translate }}
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.sellerDetails.PaymntTerms.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.sellerDetails.PaymntTerms.name }}"
                                                                   name="{{ $ctrl.sellerDetails.PaymntTerms.name }}"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.paymentTerm.name"
                                                                   required
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.selectPaymntTerm($item)"
                                                                   uib-typeahead="term as term.name for term in $ctrl.lists.PaymentTerm | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_paymenttermlist', 'Payment Term' ,'paymentTerm',null,null,null,null);"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div></div>
                                                    <div>
                                                        <div class="form-group row"
                                                             ng-if="$ctrl.vesselDetailsFields.ExchangeRate.visible">

                                                        <!-- exchange rate -->
                                                        <span ng-if="!$ctrl.data.exchangeRate"
                                                              ng-init="$ctrl.data.exchangeRate = 1"></span>
                                                        <label class="{{ $ctrl.portFields.comments.name }}_label"
                                                               for="exchangeRate">
                                                            {{ 'PAGES.NEW_ORDER.EXCHANGE_RATE' | translate }}
                                                        </label>
                                                        <div class="input-group form_input">

                                                            <input class="col-md-12 form-control" format="number:4"
                                                                   id="exchangeRate" name="exchangeRate"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.exchangeRate"
                                                                   type="text">

                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-3">
                                                    <div ng-if="$ctrl.vesselDetailsFields.ServiceCode.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.sellerDetails.ServiceCode.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.ServiceCode.name }}">
                                                            {{ $ctrl.tenantSettings.serviceDisplayName.name + " Code" | translate }}
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.ServiceCode.name }} input-group">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.vesselDetailsFields.ServiceCode.name }}"
                                                                   name="{{ $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate }}"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id"
                                                                   ng-model="$ctrl.data.service.name"
                                                                   required
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.selectService($item.id)"
                                                                   uib-typeahead="serviceCode as serviceCode.name for serviceCode in $ctrl.lists.Service | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_servicelist', 'Service' , 'service');"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.portFields.locationName.visible"
                                                         ng-show="$ctrl.orderId">
                                                    <div class="form-group  row">
                                                        <label class="{{ $ctrl.portFields.locationName.name }}_label"
                                                               for="{{ $ctrl.portFields.locationName.name }}">
                                                            {{ $ctrl.portFields.locationName.caption | translate }}
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.portFields.locationName.name }} input-group">
                                                            {{ $ctrl.data.location.name }}
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.portFields.locationName.visible"
                                                         ng-show="!$ctrl.orderId">
                                                        <div class="form-group">
                                                            <label class="simpleLookupLabel">
                                                                {{ $ctrl.portFields.locationName.caption | translate }}
                                                                <span class="orange-txt">
                                                                *
                                                            </span>
                                                            </label>
                                                            <div class="input-group form_input">
                                                                <input class="typeahead form-control"
                                                                       id="id_{{ $ctrl.portFields.locationName.name }}"
                                                                       name="{{ $ctrl.portFields.locationName.caption | translate }}"
                                                                       ng-click="$ctrl.initLookup($ctrl.portFields.locationName.name, $ctrl.data.location)"
                                                                       ng-model="$ctrl.data.location"
                                                                       required
                                                                       typeahead-append-to-body="true"
                                                                       typeahead-editable="false"
                                                                       typeahead-on-select="$ctrl.selectPort($item.id)"
                                                                       uib-typeahead="location as location.name for location in $ctrl.lists.Location | typeaheadCustomFilter:$viewValue:'name'"/>
                                                                <span class="input-group-addon ng-scope"
                                                                      ng-click="triggerModal('general', 'masters_locationlist', 'Location' ,'location',null,null,null,null);"
                                                                      ng-controller="Controller_Master as CM">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-if="$ctrl.portFields.eta.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.portFields.eta.name }}_label"
                                                               for="{{ $ctrl.portFields.eta.name }}">
                                                            {{ $ctrl.portFields.eta.caption | translate }}
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="hidden">
                                                            {{disableFromFreezeStatus = $ctrl.procurementSettings.request.etaFreezeStatus.id > 0 && $ctrl.data.status.id > 0}}
                                                        </div>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.eta.name }} input-group ">
                                                           <!-- manual input -->
                                                            <input
                                                                    class="form-control date-mask new-date-picker"
                                                                    id="eta"
                                                                    name="{{ $ctrl.portFields.eta.caption | translate }}"
                                                                    new-date-picker
                                                                    ng-change="$ctrl.inputChangeProcessing('eta')"
                                                                    ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.data.status.id === $ctrl.STATUS['Confirmed'].id || disableFromFreezeStatus"
                                                                    ng-model="$ctrl.data.eta"
                                                                    ng-required="true"
                                                                    picker-type="dynamic">
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.isRecentETA && $ctrl.portFields.recentEta.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.portFields.recentEta.name }}_label"
                                                               for="{{ $ctrl.portFields.recentEta.name }}">
                                                            {{ $ctrl.portFields.recentEta.caption | translate }}
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.portFields.recentEta.name }} ">
                                                            <input
                                                                    class="form-control date-mask new-date-picker"
                                                                    id="recentEta"
                                                                    name="recentEta"
                                                                    new-date-picker
                                                                    ng-change="$ctrl.inputChangeProcessing('recentEta')"
                                                                    ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                    ng-model="$ctrl.data.recentEta"
                                                                    picker-type="dynamic">
                                                        </div>
                                                    </div>
                                                    </div>
                                                    <div ng-if="$ctrl.vesselDetailsFields.OrderDate.visible">
                                                        <div class="form-group row">
                                                            <label>
                                                                Order date
                                                            </label>
                                                            <div class="form_input form_input_{{ $ctrl.sellerDetails.Trader.name }} input-group date form_meridian_date">
                                                                    <input class="form-control date-mask new-date-picker"
                                                                           id="orderDate"
                                                                           name="orderDate" new-date-picker
                                                                           ng-model="$ctrl.data.orderDate"
                                                                           picker-type="date">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-if="$ctrl.portFields.deliveryDate.visible">
                                                        <div class="form-group row">
                                                            <label class="{{ $ctrl.portFields.deliveryDate.name }}_label"
                                                                   for="{{ $ctrl.portFields.deliveryDate.name }}">
                                                                {{ $ctrl.portFields.deliveryDate.caption | translate }}
                                                            </label>
                                                            <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                                                <input
                                                                        class="form-control date-mask new-date-picker"
                                                                        id="deliveryDate"
                                                                        name="deliveryDate"
                                                                        new-date-picker
                                                                        ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                        ng-model="$ctrl.data.deliveryDate"
                                                                        picker-type="date">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-if="$ctrl.isDeliveryWindow">
                                                    <div class="form-group row">
                                                        <label class="deliveryDate_label" for="deliveryDate">
                                                            {{ 'PAGES.NEW_REQUEST.DELIVERY_FROM' | translate }}
                                                        </label>
                                                        <div class="input-group form_input form_input_deliveryDate">
                                                            <div class="input-group w100">
                                                           <input
                                                                   class="form-control date-mask new-date-picker"
                                                                   id="deliveryFrom"
                                                                   name="deliveryFrom"
                                                                   new-date-picker
                                                                   ng-class="{'etb_invalid': $ctrl.data.deliveryFrom > $ctrl.data.deliveryTo}"
                                                                   ng-model="$ctrl.data.deliveryFrom"
                                                                   picker-type="dynamic">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.isDeliveryWindow && !($ctrl.isRecentETA && $ctrl.portFields.recentEta.visible)">
                                                        <div class="form-group row">
                                                            <label class="deliveryDate_label" for="deliveryDate">
                                                                {{ 'PAGES.NEW_REQUEST.DELIVERY_TO' | translate }}
                                                            </label>
                                                            <div class="input-group form_input form_input_deliveryDate">
                                                                <div class="input-group w100">
                                                                    <input
                                                                            class="form-control date-mask new-date-picker"
                                                                            id="deliveryTo"
                                                                            name="deliveryTo"
                                                                            new-date-picker
                                                                            ng-class="{'etb_invalid': $ctrl.data.deliveryTo > $ctrl.data.deliveryTo}"
                                                                            ng-model="$ctrl.data.deliveryTo"
                                                                            picker-type="dynamic">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-3">
                                                    <div>
                                                        <div class="form-group  row">
                                                        <label class="{{ $ctrl.sellerDetails.Seller.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.Seller.name }}">
                                                            {{ $ctrl.sellerDetails.Seller.caption | translate }}
                                                            <span class="orange-txt">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.Seller.name }} input-group">
                                                            <input autocomplete="off"
                                                                   class="typeahead form-control"
                                                                   id="id_{{ $ctrl.sellerDetails.Seller.name }}"
                                                                   name="{{ $ctrl.sellerDetails.Seller.caption | translate }}"
                                                                   ng-blur="!$ctrl.data.seller.name ? $ctrl.clearPhysicalSupplier() : null"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.seller.name" ng-required="true"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-min-length="1"
                                                                   typeahead-on-select="$ctrl.selectSeller($item)"
                                                                   typeahead-show-hint="true"
                                                                   typeahead-wait-ms="100"
                                                                   uib-typeahead="seller as seller.name for seller in $ctrl.lists.Seller | typeaheadCustomFilter:$viewValue:'name'"/>
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_counterpartylist', 'Seller' ,'seller',null,null,null,'sellerList');"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    </div>
                                                    <div ng-if="$ctrl.nominationFields.broker.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.nominationFields.broker.name }}_label"
                                                               for="id_{{ $ctrl.nominationFields.broker.name }}">
                                                            {{ $ctrl.nominationFields.broker.caption | translate }}
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.nominationFields.broker.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.nominationFields.broker.name }}"
                                                                   name="{{ $ctrl.nominationFields.broker.caption | translate }}"
                                                                   ng-blur="!$ctrl.data.broker.name ? $ctrl.data.broker = null : '' "
                                                                   ng-click="$ctrl.setSellerDialogType($ctrl.nominationFields.broker.name, $ctrl.data.broker)"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.broker.name"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="true"
                                                                   typeahead-on-select="$ctrl.data.broker = $ctrl.setTypeahedVal($ctrl.data.broker, $item, false)"
                                                                   uib-typeahead="broker as broker.name for broker in $ctrl.lists.Broker | typeaheadCustomFilter:$viewValue:'name'"
                                                            />

                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_counterpartylist_broker', 'Broker' ,'broker',null,null,null,'brokerlist');"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div
                                                            ng-if="$ctrl.nominationFields.surveyorCounterparty.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.nominationFields.surveyorCounterparty.name }}_label"
                                                               for="{{ $ctrl.nominationFields.surveyorCounterparty.name }}">
                                                            {{ $ctrl.nominationFields.surveyorCounterparty.caption | translate }}
                                                            <span class="orange-txt" ng-if="$ctrl.isSurveyorMandatory">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.nominationFields.surveyorCounterparty.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.nominationFields.surveyorCounterparty.name }}"
                                                                   name="{{ $ctrl.nominationFields.surveyorCounterparty.caption | translate }}"
                                                                   ng-blur="!$ctrl.data.surveyorCounterparty.name ? $ctrl.data.surveyorCounterparty = null : '' "
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id "
                                                                   ng-model="$ctrl.data.surveyorCounterparty.name"
                                                                   ng-required="$ctrl.isSurveyorMandatory"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.data.surveyorCounterparty = $ctrl.setTypeahedVal($ctrl.data.surveyorCounterparty, $item, false)"
                                                                   uib-typeahead="surveyorCounterparty as surveyorCounterparty.name for surveyorCounterparty in $ctrl.lists.Surveyor | typeaheadCustomFilter:$viewValue:'name'"

                                                            />
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_counterpartylist_surveyors', 'Surveyor' ,'surveyorCounterparty',null,null,null,null)"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id ">
                                                                <a class=" btn default" href=""
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id ">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div
                                                            ng-if="$ctrl.portFields.agentCounterparty.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.sellerDetails.agentCounterparty.name }}_label"
                                                               for="{{ $ctrl.sellerDetails.agentCounterparty.name }}">
                                                            {{ $ctrl.portFields.agentCounterparty.caption | translate }}
                                                            <span class="orange-txt" ng-if="$ctrl.isAgentMandatory">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.agentCounterparty.name }} input-group"
                                                             ng-if="!$ctrl.isAgentFreeText">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.portFields.agentCounterparty.name }}"
                                                                   name="Agent"
                                                                   ng-click="$ctrl.setSellerDialogType($ctrl.portFields.agentCounterparty.name, $ctrl.data.agentCounterparty)"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.agentCounterparty.name"
                                                                   ng-required="$ctrl.isAgentMandatory"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.data.agentCounterparty = $ctrl.setTypeahedVal($ctrl.data.agentCounterparty, $item, false)"
                                                                   uib-typeahead="agentCounterparty as agentCounterparty.name for agentCounterparty in $ctrl.lists.Agent | typeaheadCustomFilter:$viewValue:'name'"
                                                            />
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'procurement_agentlist', 'agentCounterparty','agentCounterparty',null,null,null,null);"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href=""
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>

                                                        </div>
                                                        <div class="form_input form_input_{{ $ctrl.sellerDetails.agentCounterparty.name }} input-group"
                                                             ng-if="$ctrl.isAgentFreeText">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.portFields.agentCounterparty.name }}"
                                                                   name="Agent"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.agentCounterpartyFreeText"
                                                                   ng-required="$ctrl.isAgentMandatory"
                                                            />
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.nominationFields.lab.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.nominationFields.lab.name }}_label"
                                                               for="{{ $ctrl.nominationFields.lab.name }}">
                                                            {{ $ctrl.nominationFields.lab.caption | translate }}
                                                        </label>

                                                        <div class="input-group input_group input_group_{{ $ctrl.nominationFields.lab.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.nominationFields.lab.name }}"
                                                                   name="{{ $ctrl.nominationFields.lab.name }}"
                                                                   ng-blur="!$ctrl.data.lab.name ? $ctrl.data.lab = null : '' "
                                                                   ng-click="$ctrl.setSellerDialogType($ctrl.nominationFields.lab.name, $ctrl.data.lab)"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.lab.name"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.data.lab = $ctrl.setTypeahedVal($ctrl.data.lab, $item, false)"
                                                                   uib-typeahead="lab as lab.name for lab in $ctrl.lists.Lab | typeaheadCustomFilter:$viewValue:'name'"
                                                            />
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_counterpartylist_labs', 'Lab' ,'lab',null,null,null,null)"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href=""
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.nominationFields.barge.visible"
                                                         style="margin-bottom: 5px">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.nominationFields.barge.name }}_label"
                                                               for="{{ $ctrl.nominationFields.barge.name }}">
                                                            {{ $ctrl.nominationFields.barge.caption | translate }}
                                                        </label>
                                                        <div class="input-group input_group input_group_{{ $ctrl.nominationFields.barge.name }}">
                                                            <input class="typeahead form-control"
                                                                   id="id_{{ $ctrl.nominationFields.barge.name }}"
                                                                   name="{{ $ctrl.nominationFields.barge.name }}"
                                                                   ng-blur="!$ctrl.data.barge.name ? $ctrl.data.barge = null : '' "
                                                                   ng-click="$ctrl.setSellerDialogType($ctrl.nominationFields.barge.name, $ctrl.data.barge)"
                                                                   ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                   ng-model="$ctrl.data.barge.name"
                                                                   typeahead-append-to-body="true"
                                                                   typeahead-editable="false"
                                                                   typeahead-on-select="$ctrl.data.barge = $ctrl.setTypeahedVal($ctrl.data.barge, $item, false)"
                                                                   uib-typeahead="barge as barge.name for barge in $ctrl.lists.bargeCounterparties | typeaheadCustomFilter:$viewValue:'name'"
                                                            />
                                                            <span class="input-group-addon ng-scope"
                                                                  ng-click="triggerModal('general', 'masters_counterpartylist_barge', 'Barge' ,'barge',null,null,null,'bargeList');"
                                                                  ng-controller="Controller_Master as CM"
                                                                  ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id">
                                                                <a class=" btn default" href="">
                                                                    <i class="fa fa-search"></i>
                                                                </a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div ng-if="$ctrl.isDeliveryWindow && ($ctrl.isRecentETA && $ctrl.portFields.recentEta.visible)">
                                                        <div class="form-group row">
                                                        <label class="deliveryDate_label" for="deliveryDate">
                                                            {{ 'PAGES.NEW_REQUEST.DELIVERY_TO' | translate }}
                                                        </label>
                                                        <div class="input-group form_input form_input_deliveryDate">
                                                            <div class="input-group w100">
                                                           <input
                                                                   class="form-control date-mask new-date-picker"
                                                                   id="deliveryTo"
                                                                   name="deliveryTo"
                                                                   new-date-picker
                                                                   ng-class="{'etb_invalid': $ctrl.data.deliveryTo > $ctrl.data.deliveryTo}"
                                                                   ng-model="$ctrl.data.deliveryTo"
                                                                   picker-type="dynamic">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>


                                                <div class="col-md-3">

                                                    <div ng-if="$ctrl.portFields.comments.visible">
                                                        <div class="form-group row">
                                                            <label class="{{ $ctrl.portFields.comments.name }}_label"
                                                                   for="{{ $ctrl.portFields.comments.name }}">
                                                                <!-- Comment -->
                                                                {{'PAGES.NEW_ORDER.COMMENTS' | translate}}

                                                            </label>
                                                            <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                                                <textarea
                                                                        class="col-md-12 form-control"
                                                                        maxlength="500"
                                                                        ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                        ng-model="$ctrl.data.comments"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-if="$ctrl.portFields.comments.visible">
                                                        <div class="form-group row">
                                                        <label class="{{ $ctrl.portFields.comments.name }}_label"
                                                               for="{{ $ctrl.portFields.comments.name }}">
                                                             <!-- Comment -->
                                                             {{'PAGES.NEW_ORDER.COMMENTS_STRATEGY' | translate}}

                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                                            <textarea class="col-md-12 form-control" maxlength="500"
                                                                      ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                      ng-model="$ctrl.data.customNonMandatoryAttribute10"></textarea>
                                                        </div>
                                                    </div>
                                                    </div>
                                                    <div ng-if="$ctrl.portFields.comments.visible">
                                                        <div class="form-group row">
                                                            <label class="{{ $ctrl.portFields.comments.name }}_label"
                                                                   for="{{ $ctrl.portFields.comments.name }}">
                                                                 <!-- Comment -->
                                                                 {{'PAGES.NEW_ORDER.COMMENTS_OFTHEPRICE' | translate}}

                                                            </label>
                                                            <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                                            <textarea class="col-md-12 form-control" maxlength="500"
                                                                      ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                      ng-model="$ctrl.data.customNonMandatoryAttribute11"></textarea>
                                                        </div>
                                                        </div>
                                                    </div>
                                                    <div ng-if="$ctrl.portFields.emailComments.visible">
                                                    <div class="form-group row">
                                                        <label class="{{ $ctrl.portFields.comments.name }}_label">
                                                            {{ 'PAGES.NEW_ORDER.EMAIL_COMMENTS' | translate }}
                                                        </label>
                                                        <div class="input-group form_input">

                                                            <textarea class="col-md-12 form-control" maxlength="500"
                                                                      ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                                                      ng-model="$ctrl.data.customNonMandatoryAttribute1"></textarea>

                                                        </div>
                                                    </div></div>
                                                    <div class="form-group row"  ng-if="$ctrl.portFields.comments.visible && $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id && $ctrl.procurementSettings.order.captureReasonToCancelTheOrder.name == 'Yes'">
                                                        <label class="{{ $ctrl.portFields.comments.name }}_label"
                                                               for="{{ $ctrl.portFields.comments.name }}">
                                                            Cancellation Comments
                                                        </label>
                                                        <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                                                <textarea class="col-md-12 form-control" maxlength="1000"
                                                                          ng-model="$ctrl.data.cancelOrderComments"
                                                                          readonly></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>


                                    </form>
                            </div>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--        ADDITIONAL COSTS FORM-->
        <div class="col-md-12 no-padding-left no-padding-right">
            <div class="portlet light stretch-vertical" ng-hide="visible_sections.indexOf('products') < 0">
                <div class="portlet-title">
                    <div class="tools">
                        <a class="collapse" data-original-title="" href="" title=""></a>
                    </div>
                    <div class="caption">
                        <div class="col-md-4 caption-subject">
                            PRODUCTS
                        </div>
                    </div>
                </div>


                <div class="portlet-body">
                    <form autocomplete="off" class="" name="forms.productsForm" novalidate>
                        <table class="table table-hover table-bordered table-stripped" id="new_order_products">
                            <thead>
                            <tr>
                                <th id="generatedThId193" ng-if="!$ctrl.data.id || $ctrl.data.status.id == $ctrl.STATUS['Confirmed'].id || $ctrl.data.status.id == $ctrl.STATUS['Amended'].id || $ctrl.data.status.id == $ctrl.STATUS['Stemmed'].id || $ctrl.data.status.id == $ctrl.STATUS['WaitingForApproval'].id || $ctrl.data.status.id == $ctrl.STATUS['Approved'].id || $ctrl.data.status.id == $ctrl.STATUS['Rejected'].id"
                                    style="vertical-align: middle;">
                                        <span class="clickable" id="product_addRow_header"
                                              ng-click="$ctrl.addNewProduct()">
                                            <i class="fa fa-plus st-btn-icon"></i>
                                        </span>
                                </th>
                                <th id="generatedThId194" ng-if="$ctrl.data.status.id != $ctrl.STATUS['Cancelled'].id"
                                    style="vertical-align: middle;"></th>
                                <th id="generatedThId195" ng-if="column.visible && column.caption != 'PAGES.NEW_ORDER.CONTRACT_ID' &&  column.caption != 'PAGES.NEW_ORDER.FORMULA_DESCRIPTION' && column.caption != 'PAGES.NEW_ORDER.FORMULA_DETAILS' && column.caption != 'PAGES.NEW_ORDER.PRICING_DATE' && $ctrl.tenantSettings.shiptechLite" ng-repeat="column in $ctrl.productColumns">
                                    {{ column.caption | translate }}
                                </th>
                                <th id="generatedThId195" ng-if="column.visible  && !$ctrl.tenantSettings.shiptechLite" ng-repeat="column in $ctrl.productColumns">
                                    {{ column.caption | translate }}
                                </th>
                                <th class="hide" >
                                    Conversion Factor
                                </th>
                                 <th class="hide" >
                                    Overwrite Conversion Factor
                                </th>
                            </tr>
                            </thead>
                            <tbody>

                            <tr ng-init="$ctrl.disabledProduct[product.id] = $ctrl.isDisabledProduct(product)"
                                ng-repeat="(key, product) in $ctrl.data.products">
                                <td ng-if="!$ctrl.data.id || $ctrl.data.status.id == $ctrl.STATUS['Confirmed'].id || $ctrl.data.status.id == $ctrl.STATUS['Amended'].id || $ctrl.data.status.id == $ctrl.STATUS['Stemmed'].id || $ctrl.data.status.id == $ctrl.STATUS['WaitingForApproval'].id || $ctrl.data.status.id == $ctrl.STATUS['Approved'].id || $ctrl.data.status.id == $ctrl.STATUS['Rejected'].id"
                                    style="vertical-align: middle;">

                                    <span class="clickable" id="product_addRow_{{ $index }}"
                                          ng-click="$ctrl.addNewProduct()">
                                            <i class="fa fa-plus st-btn-icon"></i>
                                        </span>
                                </td>
                                <td ng-if="$ctrl.data.status.id != $ctrl.STATUS['Cancelled'].id"
                                    style="vertical-align: middle;">
                                        <span class="clickable" id="product_remRow_{{ $index }}"
                                              ng-click="$ctrl.deleteProduct(product)"
                                              ng-if="product.status.id != $ctrl.STATUS['Cancelled'].id">
                                            <i class="fa fa-minus st-btn-icon"></i>
                                        </span>
                                </td>
                                <td style="max-width: initial; min-width: 220px;">
                                    <div class="input-group"
                                         data-original-title="{{ $ctrl.getProductTooltipByProductId(product.product.id) }}"
                                         ng-init="product.tempProduct = $ctrl.setDefaultTempProduct(product.product)"
                                         tooltip
                                         tooltiptrigger="hover">
                                        <input class="typeahead form-control "
                                               id="product_{{ $index }}"
                                               name="Product {{$index}}"
                                               ng-disabled="$ctrl.disabledProduct[product.id]"
                                               ng-focus="$ctrl.initLookup($ctrl.productColumns.Product.name, product)"
                                               ng-if="!$ctrl.refreshProduct" ng-model="product.tempProduct"
                                               ng-required="true && product.status.id != $ctrl.STATUS['Cancelled'].id"
                                               typeahead-append-to-body="true"
                                               typeahead-append-to-body="true"
                                               typeahead-editable="false"
                                               typeahead-on-select="$ctrl.selectProduct($item.id, $index)"
                                               uib-typeahead="prod as prod.name for prod in $ctrl.lists.Product | typeaheadCustomFilter:$viewValue:'name'"/>
                                        <span class="input-group-addon" data-toggle="modal" href="#lookup"
                                              ng-click="$ctrl.initLookup($ctrl.productColumns.Product.name, product)"
                                              ng-disabled="$ctrl.disabledProduct[product.id]">
                                                <a class=" btn default" href=""
                                                   ng-disabled="$ctrl.disabledProduct[product.id]">
                                                    <i class="fa fa-search"></i>
                                                </a>
                                            </span>
                                    </div>
                                </td>
                                <td style="max-width: initial; min-width: 100px;">
                                    <div class="input-group">
                                        <input class="form-control" id="product_type_{{ $index }}"
                                               name="Product Type {{$index}}" ng-disabled="true"
                                               ng-model="product.productType.name" ng-required="false"
                                        />
                                    </div>
                                </td>
                                <td style="max-width: initial; min-width: 200px;">
                                    <select class="form-control pull-left"
                                            id="product_specGroup_{{ $index }}"
                                            ng-class="{'border-red-thunderbird' : ($ctrl.hasMissingSpecGroup && product.status.name != 'Cancelled' && !product.specGroup)}"
                                            ng-disabled="$ctrl.disabledProduct[product.id]" ng-model="product.specGroup"
                                            ng-options="specGroup as specGroup.name for specGroup in product.specGroups track by specGroup.id"
                                            style="width: calc(100% - 20px);"></select>
                                    <a class="pull-left"
                                       ng-click="modalSpecGroupEdit(product, NAV.orderId, 'order', $ctrl.data)"
                                       ng-controller="Controller_Master"
                                       ng-disabled="$ctrl.disabledProduct[product.id]"
                                       style="line-height: 34px;margin-left: 5px;">
                                        <i class="fa fa-file-text font-grey-cascade"></i>
                                    </a>
                                </td>
                                <td style="max-width: 250px;min-width: 150px">
                                    <select class="form-control"
                                            id="product_delOption_{{ $index }}"
                                            ng-disabled="$ctrl.disabledProduct[product.id]"
                                            ng-model="product.deliveryOption"
                                            ng-options="delOption as delOption.name for delOption in $ctrl.lists.DeliveryOption track by delOption.id"></select>
                                </td>
                                <td style="max-width: 300px;min-width: 300px">
                                    <div class="input-group" style="width: 100%">
                                        <input class="typeahead form-control"
                                               id="product_supplier_{{ $index }}"
                                               name="Product {{$index+1}} ({{product.tempProduct.name}}) Physical Supplier"
                                               ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                               ng-model="product.physicalSupplier"
                                               ng-mouseover="$ctrl.setSellerDialogType($ctrl.productColumns.physicalSupplier.name, product.physicalSupplier)"
                                               ng-required="product.status.id != $ctrl.STATUS['Cancelled'].id"
                                               typeahead-append-to-body="true"
                                               typeahead-editable="false"
                                               typeahead-on-select="product.physicalSupplier = $ctrl.setTypeahedVal($ctrl.data.broker, $item, false)"
                                               uib-typeahead="supplier as supplier.name for supplier in $ctrl.lists.Supplier | typeaheadCustomFilter:$viewValue:'name'"
                                        />
                                        <!-- THIS WAS ON SUPPLIER REQUIRED: $ctrl.data.status.id != $ctrl.STATUS['Confirmed'].id &&  -->
                                        <span class="input-group-addon ng-scope"
                                              ng-click="triggerModal('general', 'masters_counterpartylist_physicalsuppliers', 'Physical Supplier' ,'productSupplier',null,null,null,null); $ctrl.physicalSupplierRowUniqueIdUI = product.uniqueIdUI"
                                              ng-controller="Controller_Master as CM"
                                              ng-disabled="$ctrl.disabledProduct[product.id]">
                                                <a class=" btn default" href=""
                                                   ng-disabled="$ctrl.disabledProduct[product.id]">
                                                    <i class="fa fa-search"></i>
                                                </a>
                                            </span>
                                    </div>
                                </td>
                                <td ng-if="$ctrl.productColumns.minQuantity.visible"
                                    style="max-width: 250px;min-width: 150px">
                                    <div class="input-group">
                                        <input class="form-control"
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               id="product_minQuantity_{{ $index }}"
                                               name="{{ $ctrl.productColumns.minQuantity.name }}"
                                               ng-blur="product.minQuantity = $ctrl.validateMinMaxQuantity(product.minQuantity, product.maxQuantity)['minQuantity']"
                                               ng-disabled="$ctrl.captureConfirmedQuantity.name == 'Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                               ng-model="product.minQuantity"
                                               ng-required=" $ctrl.captureConfirmedQuantity.name != 'Offer' && product.status && product.status.id != $ctrl.STATUS['Cancelled'].id "
                                               type="text"
                                        />
                                        <div class="input-group-btn"
                                             ng-init="!product.minMaxQuantityUom.id ? product.minMaxQuantityUom = $ctrl.tenantUom : '' ">

                                            <select class="bs-select pull-right"
                                                    id=""
                                                    id="product_minQuantityUom_{{ $index }}" name="minQuantityUom"
                                                    ng-change="$ctrl.productUomChanged(product)"
                                                    ng-disabled="$ctrl.captureConfirmedQuantity.name == 'Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                                    ng-model="product.minMaxQuantityUom"
                                                    ng-options="item as item.name for item in $ctrl.lists.Uom track by item.id"
                                                    ng-required="product.minQuantity != null && !($ctrl.captureConfirmedQuantity.name == 'Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id)"
                                                    style="max-width: 50px;"></select>
                                        </div>
                                    </div>
                                </td>
                                <td ng-if="$ctrl.productColumns.maxQuantity.visible"
                                    style="max-width: 250px;min-width: 150px">
                                    <div class="input-group">
                                        <input class="form-control"
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               id="product_maxQuantity_{{ $index }}"
                                               name="{{ $ctrl.productColumns.maxQuantity.name }}"
                                               ng-blur="$ctrl.productUomChanged(product); product.maxQuantity = $ctrl.validateMinMaxQuantity(product.minQuantity, product.maxQuantity)['maxQuantity']; $ctrl.defaultMaxQtyFromConfirmed('input', product)"
                                               ng-disabled="$ctrl.captureConfirmedQuantity.name == 'Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                               ng-model="product.maxQuantity"
                                               ng-required=" $ctrl.captureConfirmedQuantity.name != 'Offer' && ( product.status ? product.status.id != $ctrl.STATUS['Cancelled'].id : false) "
                                               type="text"
                                        />
                                        <div class="input-group-btn" ng-disabled="$ctrl.disabledProduct[product.id]"
                                             ng-init="!product.minMaxQuantityUom.id ? product.minMaxQuantityUom = $ctrl.tenantUom : '' "
                                             style="max-width: 50px;">
                                            <select class="bs-select pull-right"
                                                    id="product_maxQuantityUom_{{ $index }}"
                                                    name="maxQuantityUom" ng-change="$ctrl.productUomChanged(product)"
                                                    ng-disabled="$ctrl.captureConfirmedQuantity.name =='Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                                    ng-model="product.minMaxQuantityUom"
                                                    ng-options="item as item.name for item in $ctrl.lists.Uom track by item.id"
                                                    ng-required="product.maxQuantity != null && !($ctrl.captureConfirmedQuantity.name == 'Offer' || product.status.id == $ctrl.STATUS['Cancelled'].id)"
                                                    style="max-width: 50px;"
                                            ></select>
                                        </div>
                                    </div>
                                </td>
                                <td style="max-width: initial; min-width: 150px;">
                                    <div class="input-group">
                                        <input class="form-control"
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               id="product_confirmedQuantity_{{ $index }}"
                                               name="{{ $ctrl.productColumns.confirmedQuantity.name }}"
                                               ng-blur="$ctrl.productUomChanged(product)"
                                               ng-disabled="product.status.id  === $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                               ng-model="product.confirmedQuantity"
                                               ng-required="$ctrl.requiredAndDisabledRules('required', 'confirmedQty', product.status.id)"
                                               type="text"
                                        />

                                        <div class="input-group-btn" ng-disabled="$ctrl.disabledProduct[product.id]"
                                             ng-init="!product.quantityUom.id ? product.quantityUom = $ctrl.tenantUom : '' "
                                             style="max-width: 50px;">

                                            <select class="bs-select pull-right" id=""
                                                    id="product_quantityUom_{{ $index }}"
                                                    name="" ng-change="$ctrl.resetContractData($index, true)"
                                                    ng-disabled="product.status.id  === $ctrl.STATUS['Cancelled'].id || $ctrl.disabledProduct[product.id]"
                                                    ng-model="product.quantityUom"
                                                    ng-options="item as item.name for item in $ctrl.lists.Uom track by item.id"
                                                    ng-required="$ctrl.requiredAndDisabledRules('required', 'confirmedQty', product.status.id)"
                                                    style="max-width: 50px;"
                                            ></select>
                                        </div>
                                    </div>
                                </td>
                                <!--  unit price for product -->
                                <td style="max-width: 200px;min-width: 200px">
                                    <div class="input-group">
                                        <!-- price -->
                                        <input class="form-control"
                                               format="number:{{ $ctrl.numberPrecision.pricePrecision }}"
                                               id="product_price_{{ $index }}"
                                               name="{{ $ctrl.productColumns.price.name }}"
                                               ng-change="$ctrl.productPriceChanged(product)"
                                               ng-disabled="product.formula.id || product.contract.id || $ctrl.disabledProduct[product.id]"
                                               ng-model="product.price"
                                               ng-required="true && product.status.id != $ctrl.STATUS['Cancelled'].id && !(product.contractProductId != null  || product.agreementType.name.toLowerCase() == 'contract' || product.pricingType.id == 1 || $ctrl.disabledProduct[product.id])"
                                               style="min-width:80px"
                                               type="text"/>

                                        <!-- price uom -->
                                        <div class="input-group-btn"
                                             ng-disabled="$ctrl.disabledProduct[product.id]"
                                             ng-init="!product.priceUom.id ? product.priceUom = $ctrl.tenantUom : '' ">
                                            <select class="bs-select pull-right uomWidth" id=""
                                                    id="product_priceUom_{{ $index }}"
                                                    name=""
                                                    ng-change="$ctrl.productUomChanged(product)"
                                                    ng-disabled="product.contractProductId != null  || $ctrl.disabledProduct[product.id]"
                                                    ng-model="product.priceUom"
                                                    ng-options="item as item.name for item in $ctrl.lists.Uom track by item.id"></select>
                                        </div>

                                        <!-- currency -->
                                        <span ng-if="!product.currency"
                                              ng-init="product.currency = $ctrl.currency"></span>
                                        <div class="input-group-btn">
                                            <select
                                                    class="bs-select pull-right"
                                                    id="product_currency_{{ $index }}"
                                                    name="product_currency_{{ $index }}"
                                                    ng-change="$ctrl.changeAllCurrencyInOrder(product.currency)"
                                                    ng-disabled="key != 0 || $ctrl.disabledProduct[product.id]"
                                                    ng-model="product.currency"
                                                    ng-options="item as item.code for item in $ctrl.lists.Currency track by item.id"
                                            ></select>
                                        </div>
                                    </div>
                                </td>
                                <!--  end unit price for product -->
                                <td style="max-width: 180px;min-width: 140px" ng-if="!$ctrl.tenantSettings.shiptechLite">
                                            <span class="form-control disabled"
                                                  data-original-title="{{product.formulaDescription ? product.formulaDescription : product.formula.name}}"
                                                  style="background: #e6eaec;overflow: hidden;"
                                                  tooltip>
                                                {{product.formulaDescription ? product.formulaDescription : product.formula.name}}
                                            </span>

                                    {{product.pricingType.id !== $ctrl.PRICING_TYPE_FORMULA_ID ?
                                    product.formulaDescription = null : ''}}

                                </td>
                                <td style="max-width: 180px;min-width: 140px"  ng-if="!$ctrl.tenantSettings.shiptechLite">
                                    <a ng-click="$ctrl.triggerFormulaDetailsModal(product)"
                                       ng-if="(product.formulaDescription || product.formula) && $ctrl.orderId && !product.changedOnConfirmedOrder">Pricing
                                        Details</a>

                                </td>
                                <td style="max-width: 120px;min-width: 120px">
									{{$ctrl.formatAmount(product.amount)}}
                                    <!-- {{product.totalAmount ? (product.totalAmount |
                                    number:$ctrl.numberPrecision.amountPrecision) : (product.amount |
                                    number:$ctrl.numberPrecision.amountPrecision)
                                    }} -->
                                </td>
                                <td style="max-width: 180px;min-width: 140px"> 

                                    <select class="form-control"
                                            id="product_agreementType_{{ $index }}"
                                            name="{{ $ctrl.productColumns.agreementType.name }}"
                                            ng-disabled="$ctrl.disabledProduct[product.id]"
                                            ng-init="!product.id ? (product.contractId ? product.agreementType = $ctrl.defaultContractAgreementType : product.agreementType = $ctrl.defaultSpotAgreementType) : '';"
                                            ng-model="product.agreementType"
                                            ng-options="agreementType as agreementType.name for agreementType in (product.contract.id ? $ctrl.contractAgreementTypesList : $ctrl.spotAgreementTypesList) track by agreementType.id"
                                            ng-required="true && product.status.id != $ctrl.STATUS['Cancelled'].id"
                                    ></select>

                                </td>
                                <td style="max-width: 180px;min-width: 140px">

                                    {{ product.status.displayName ? product.status.displayName : product.status.name}}
                                </td>
                                <td ng-init="!product.pricingType ? product.pricingType.id = 1 : '' "
                                    style="max-width: 200px;min-width: 180px">
                                        <span class="hidden">
                                            {{!product.contract.id ?  (disabledPricingType[product.id] = true) : ( disabledPricingType[product.id] = false) }}
                                            {{!product.contract.id ?  (product.pricingType.id = 1) : '' }}
                                        </span>
                                    <select class="form-control"
                                            disabled
                                            id="product_pricingType_{{ $index }}"
                                            name="{{ $ctrl.productColumns.pricingType.name }}"
                                            ng-change=" product.contract = null; product.contractProductId = null"
                                            ng-disabled="$ctrl.disabledProduct[product.id] || disabledPricingType[product.id]"
                                            ng-model="product.pricingType"
                                            ng-options="pricingType as pricingType.name for pricingType in $ctrl.lists.PricingType track by pricingType.id"></select>

                                </td>
                                <td style="max-width: 180px;min-width: 140px; overflow: hidden;">
                                    <span class="orderProductTable" data-original-title="{{ product.comments }}"
                                          ng-disabled="$ctrl.disabledProduct[product.id]"
                                          style="text-overflow: ellipsis;"
                                          tooltip>  {{ product.comments }} </span>
                                </td>
                                <td style="max-width: 250px;min-width: 230px" ng-if="!$ctrl.tenantSettings.shiptechLite">
                                    <a href="/#/contracts/contract/edit/{{ product.contract.id }}"
                                       ng-disabled="!product.contract.id || product.requestOfferId"
                                       style="display: block; float: left;margin-top: 10px; margin-right: 10px;">
                                        show
                                    </a>
                                    <div class="input-group" ng-init="$ctrl.getOrderContractOptions(product)">
                                        <input class="typeahead form-control"
                                               id="product_contract_{{ $index }}"
                                               name="{{ $ctrl.productColumns.contract.name }}"
                                               ng-change="$ctrl.changedProductContract(); $ctrl.productContractSelecting = product.id ? product.id : product.uniqueIdUI"
                                               ng-click="$ctrl.productContractSelecting = product.id ? product.id : product.uniqueIdUI"
                                               ng-disabled="$ctrl.disabledProduct[product.id] || product.requestOfferId"
                                               ng-model="product.contract.name"
                                               typeahead-append-to-body="true"
                                               typeahead-editable="false"
                                               typeahead-on-select="selectProductContract($ctrl.productContractSelecting, $item)"
                                               uib-typeahead="contract.contract.name for contract in $ctrl.orderContractOptions[product.product.id] | typeaheadCustomFilter:$viewValue:'name'"
                                        />

                                        <span class="input-group-addon ng-scope"
                                              ng-click="$ctrl.getOrderContractOptions(product, true); triggerModal('general', 'procurement_productcontractlist', 'Contract' ,'contract',null,null,null, $ctrl.productContractFilters[product.product.id]); $ctrl.productContractSelecting = product.id ? product.id : product.uniqueIdUI"
                                              ng-controller="Controller_Master as CM"
                                              ng-disabled="$ctrl.disabledProduct[product.id] || product.requestOfferId">
                                                <a class=" btn default" href=""
                                                   ng-disabled="$ctrl.disabledProduct[product.id]">
                                                    <i class="fa fa-search"></i>
                                                </a>
                                            </span>
                                    </div>
                                </td>
                                <td ng-if="$ctrl.enableManualPricingDateOverride"
                                    style="max-width: 180px;min-width: 140px">


                                    <span ng-if="!$ctrl.data.id && $ctrl.data.products"
                                          ng-init="$ctrl.manualPricingDateOverride.id ? ($ctrl.manualPricingDateOverride.id == 1 ? product.manualPricingDateOverride = true : product.manualPricingDateOverride = false) : ''"></span>
                                    <div class="form-group">
                                        <div class="input-group">
                                            <label class="mt-checkbox">
                                                <input id="product_manualPricingDateOverride_{{ $index }}"
                                                       ng-disabled="$ctrl.disabledProduct[product.id]"
                                                       ng-model="product.manualPricingDateOverride"
                                                       type="checkbox">
                                                <span></span>
                                            </label>
                                        </div>
                                    </div>
                                </td>
                                <td style="max-width: 180px;min-width: 140px" ng-if="!$ctrl.tenantSettings.shiptechLite">
                                    <div class="form-group">
                                        <div class="input-group form-input table-formatted-input">

                                            <input
                                                    class="form-control date-mask new-date-picker"
                                                    id="product_pricingDate_{{ $index }}"
                                                    name="product_pricingDate_{{ $index }}"
                                                    new-date-picker
                                                    ng-disabled="$ctrl.disabledProduct[product.id] || !product.manualPricingDateOverride"
                                                    ng-model="$ctrl.data.products[key].pricingDate"
                                                    picker-type="date">
                                        </div>
                                    </div>
                                </td>
                                <td style="max-width: 180px;min-width: 140px">
                                    <div class="form-group">
                                        <span ng-if="!product.nominationDate"
                                              ng-init="product.nominationDate = $ctrl.data.orderDate;"></span>
                                        <div class="input-group form-input table-formatted-input">

                                            <input
                                                    class="form-control date-mask new-date-picker"
                                                    id="nominationDate_{{ $index }}"
                                                    name="nominationDate_{{ $index }}"
                                                    new-date-picker
                                                    ng-disabled="$ctrl.disabledProduct[product.id]"
                                                    ng-model="$ctrl.data.products[key].nominationDate"
                                                    picker-type="date">
                                        </div>
                                    </div>
                                </td>
                                <td style="max-width: 250px; min-width: 200px">
                                    <div class="input-group">
                                        <input class="form-control input-md"
                                               data-original-title="{{ product.robOnArrival }}"
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               id="product_RobOnArrival_{{ $index }}"
                                               name="RobOnArrival"
                                               ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                               ng-model="$ctrl.data.products[key].robOnArrival"
                                               type="text">
                                        <div class="input-group-btn"
                                             ng-init="!product.robOnArrivalUom.id ? product.robOnArrivalUom = $ctrl.tenantUom : '' ">
                                            <select class="form-control bs-select pull-right"
                                                    data-original-title="{{ product.robOnArrivalUom.name }}"
                                                    id="product_robOnArrivalUom_{{ $index }}"
                                                    ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                                    ng-model="$ctrl.data.products[key].robOnArrivalUom"
                                                    ng-options="uomItem as uomItem.name for uomItem in $ctrl.lists.Uom track by uomItem.id"
                                                    ng-required="product.product !== null && !$ctrl.requestTenantSettings.isPrerequestEnabled"
                                                    style="min-width: 75px; max-width: 75px;"></select>
                                        </div>
                                    </div>
                                </td>
                                <td style="max-width: 250px; min-width: 200px">
                                    <div class="input-group">
                                        <input class="form-control input-md"
                                               data-original-title="{{ product.roundVoyageConsumption }}"
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               id="product_roundVoyageConsumption_{{ $index }}"
                                               name="roundVoyageConsumption"
                                               ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                               ng-model="product.roundVoyageConsumption"
                                               type="text">
                                        <div class="input-group-btn"
                                             ng-init="!product.roundVoyageConsumptionUom.id ? product.roundVoyageConsumptionUom = $ctrl.tenantUom : '' ">
                                            <select class="form-control bs-select pull-right"
                                                    data-original-title="{{ product.roundVoyageConsumptionUom.name }}"
                                                    id="product_roundVoyageConsumptionUom_{{ $index }}"
                                                    ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                                    ng-model="product.roundVoyageConsumptionUom"
                                                    ng-options="uomItem as uomItem.name for uomItem in $ctrl.lists.Uom track by uomItem.id"
                                                    ng-required="product.product !== null && !$ctrl.requestTenantSettings.isPrerequestEnabled"
                                                    style="min-width: 75px; max-width: 75px;"></select>
                                        </div>
                                    </div>
                                </td>
                                <td  class="hide" ng-if="product.conversionFactorToUomOfPriceFromContract"
                                    style="width: 300px; display: flex; padding: 1px 0px !important">
                                        <select style="width: 30%;"  name="Product {{$index}} mass UOM" ng-model="product.convFactorMassUom" ng-options="item as item.name for item in  $ctrl.listsCache.UomMass track by item.id" class="form-control"></select>
                                        <input  style="width: 40%;" type="text" class="form-control" ng-model="product.convFactorValue"> 
                                        <select style="width: 30%;"  name="Product {{$index}} mass UOM" ng-model="product.convFactorVolumeUom" ng-options="item as item.name for item in $ctrl.listsCache.UomVolume track by item.id" class="form-control"></select>        
                                </td>
                                <td  class="hide"  ng-if="!product.conversionFactorToUomOfPriceFromContract"
                                    style="width: 300px; display: flex; padding: 1px 0px !important">
                                        <input class="form-control" style="width: 30%;" id="product_type_{{ $index }}"
                                           name="Conversion Mass {{$index}}" ng-disabled="true"
                                           ng-model="product.convFactorMassUom" ng-required="false"/>
                                        <input class="form-control" style="width: 40%;" id="product_type_{{ $index }}"
                                           name="Conversion Factor {{$index}}" ng-disabled="true"
                                           ng-model="product.convFactorValue" ng-required="false"/>
                                        <input class="form-control" style="width: 30%;" id="product_type_{{ $index }}"
                                           name="Conversion Volume {{$index}}" ng-disabled="true"
                                           ng-model="product.convFactorVolumeUom" ng-required="false"/>
                                </td>
                                <td  class="hide" style="max-width: 180px;min-width: 140px">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <label class="mt-checkbox">
                                                <input id="product_manualPricingDateOverride_{{ $index }}"
                                                       ng-model="product.conversionFactorToUomOfPriceFromContract"
                                                       type="checkbox">
                                                <span></span>
                                            </label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </form>
                    <form class="form-horizontal st-new-order-form portlet-title">
                        <div class="caption-subject">
                            ADDITIONAL COSTS
                        </div>

                    </form>
                    <div class="clearfix"></div>
                    <form class="" name="forms.additionalCostsForm" novalidate>
                        <table class="table table-hover table-bordered table-stripped" id="new_order_additional_costs">
                            <thead>
                            <tr>
                                <th id="generatedThId196">
                                        <span class="clickable"
                                              id="addCost_addRow_header"
                                              ng-click="$ctrl.addAdditionalCost()"
                                              ng-if="['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) == -1">
                                            <i class="fa fa-plus st-btn-icon"></i>
                                        </span>
                                </th>
                                <th id="generatedThId197"></th>
                                <th id="generatedThId198" ng-repeat="column in $ctrl.additionalCostColumns">
                                    {{ column.caption | translate }}
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-if="!additionalCost.isDeleted"
                                ng-repeat="additionalCost in $ctrl.getAdditionalCosts() | orderBy: '-fakeId' track by $index">
                                <td>

                                    <span class="clickable"
                                          id="addCost_addRow_{{ $index }}"
                                          ng-click="$ctrl.addAdditionalCost()"
                                          ng-if="['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) == -1">
                                            <i class="fa fa-plus st-btn-icon"></i>
                                        </span>
                                </td>
                                <td>
                                        <span class="clickable"
                                              id="addCost_remRow_{{ $index }}"
                                              ng-click="$ctrl.deleteAdditionalCost(additionalCost)"
                                              ng-if="['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) == -1">
                                            <i class="fa fa-minus st-btn-icon"></i>
                                        </span>
                                </td>
                                <td>

                                    <!-- additional cost -->

                                    <select class="select2 form-control"
                                            id="additional_cost_additional_cost_{{ $index }}"
                                            name="{{ $ctrl.additionalCostColumns.name.name }}"
                                            ng-change="$ctrl.additionalCostNameChanged(additionalCost); $ctrl.validateAdditionalCostAllowNegative(additionalCost.price,additionalCost.additionalCost.allowNegative, $index, additionalCost.additionalCost); additionalCost.costLineChanged = true"
                                            ng-disabled="additionalCost.disabled || $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || ['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) != -1"
                                            ng-model="additionalCost.additionalCost"
                                            ng-options="addCost as addCost.name for addCost in $ctrl.lists.AdditionalCost track by addCost.id"></select>
                                </td>
                                <td>
                                    <!--  cost type -->
                                    <select class="select2 form-control"
                                            id="additional_cost_type_{{ $index }}"
                                            name="{{ $ctrl.additionalCostColumns.type.name }}"
                                            ng-change="$ctrl.costTypeChanged(additionalCost); additionalCost.costLineChanged = true"
                                            ng-disabled="additionalCost.disabled || $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || ['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) != -1"
                                            ng-model="additionalCost.costType"
                                            ng-options="costType as costType.name for costType in getAdditionalCostDefaultCostType(additionalCost) track by costType.id"
                                            ng-required="additionalCost.additionalCost"></select>
                                </td>
                                <td>
                                    <!--  quantity -->
                                    <div class="input-group">
                                        <input class="form-control" disabled
                                               format="number:{{ $ctrl.numberPrecision.quantityPrecision }}"
                                               ng-model="additionalCost.confirmedQuantity" readonly/>
                                        <div class="input-group-btn">
                                            <button class="btn dropdown-toggle" data-toggle="dropdown" disabled
                                                    readonly type="button">
                                                {{ additionalCost.quantityUom.name }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.quantityUom, uom)"
                                                    ng-repeat="uom in $ctrl.lists.Uom">
                                                    <a>
                                                        {{ uom.name }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <!--  cost -->
                                    <div class="input-group">

                                        <!--  cost value -->

                                        <input class="form-control"
                                               format="number:{{ $ctrl.numberPrecision.pricePrecision }}"
                                               id="additional_cost_price_{{ $index }}"
                                               name="{{ $ctrl.additionalCostColumns.Price.name }}_{{ $index }}"
                                               ng-blur="$ctrl.validateAdditionalCostAllowNegative(additionalCost.price,additionalCost.additionalCost.allowNegative, $index, additionalCost.additionalCost)"
                                               ng-change="$ctrl.validateAdditionalCostAllowNegative(additionalCost.price,additionalCost.additionalCost.allowNegative, $index, additionalCost.additionalCost)"
                                               ng-class="$ctrl.validateAdditionalCostAllowNegative(additionalCost.price,additionalCost.additionalCost.allowNegative, $index, additionalCost.additionalCost) ? 'ng-valid' : 'additional_cost_invalid'"
                                               ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                               ng-model="additionalCost.price"
                                               ng-required="additionalCost.additionalCost"
                                               type="text"
                                        />
                                        <!-- cost qty uom -->
                                        <div class="input-group-btn">
                                                <span ng-if="!(!$ctrl.additionalCostPriceUomEnabled(additionalCost) || $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id) && !additionalCost.priceUom.id"
                                                      ng-init="additionalCost.priceUom = $ctrl.tenantUom"></span>

                                            <select class="bs-select pull-right uomWidth" id=""
                                                    id="additional_cost_priceUom_{{ $index }}"
                                                    name=""
                                                    ng-change="$ctrl.addPriceUomChanged(additionalCost)"
                                                    ng-disabled="!$ctrl.additionalCostPriceUomEnabled(additionalCost) || $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || ['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) != -1"
                                                    ng-model="additionalCost.priceUom"
                                                    ng-options="item as item.name for item in $ctrl.lists.Uom track by item.id"></select>

                                            <span hidden>{{ additionalCost.costType.name == 'Flat' ? additionalCost.priceUom = null : '' }}</span>
                                        </div>
                                        <!-- cost price uom -->
                                        <div class="input-group-btn">
                                            <button class="btn dropdown-toggle" data-toggle="dropdown" disabled
                                                    ng-class="{'ng-invalid' : additionalCost.additionalCost && !additionalCost.currency.id}"
                                                    type="button">
                                                {{ additionalCost.currency.code }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.currency, currency)"
                                                    ng-repeat="currency in $ctrl.lists.Currency">
                                                    <a>
                                                        {{ currency.code }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>

                                    {{additionalCost.isTaxComponent ?
                                    $ctrl.additionalCostApplicableFor[additionalCost.fakeId] = null : ''}}

                                    <select class="form-control"
                                            id="{{ $ctrl.additionalCostColumns.ApplicableFor.name + '_' + $index }}"
                                            name="{{ $ctrl.additionalCostColumns.ApplicableFor.name }}"
                                            ng-change="$ctrl.applicableForChange(additionalCost, $ctrl.additionalCostApplicableFor[additionalCost.fakeId])"
                                            ng-disabled="!additionalCost.additionalCost || $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id || additionalCost.disabledApplicableFor || (additionalCost.isTaxComponent && additionalCost.costType.name == 'Percent') || ['Delivered', 'PartiallyDelivered', 'Invoiced', 'PartiallyInvoiced'].indexOf($ctrl.data.status.name) != -1"
                                            ng-model="$ctrl.additionalCostApplicableFor[additionalCost.fakeId]"
                                            ng-options="product as ($ctrl.sumThose(idx,1) +' - '+ product.product.name) for (idx, product) in $ctrl.data.products | aplicableCostForProduct | orderBy : 'productType.id'"
                                    >

                                        <option selected value="">
                                            All
                                        </option>
                                    </select>
                                </td>
                                <td>
                                    <div class="input-group">
                                        <input class="form-control" disabled
                                               format="number:{{ $ctrl.numberPrecision.amountPrecision }}"
                                               ng-model="additionalCost.amount" readonly/>
                                        <div class="input-group-btn">
                                            <button class="btn dropdown-toggle" data-toggle="dropdown" disabled
                                                    readonly type="button">
                                                {{ additionalCost.currency.code }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.currency, currency)"
                                                    ng-repeat="currency in $ctrl.lists.Currency">
                                                    <a>
                                                        {{ currency.code }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <input class="form-control"
                                           format="number:{{ $ctrl.numberPrecision.pricePrecision }}"
                                           id="additional_cost_extras_{{ $index }}" max="100"
                                           ng-disabled="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                                           ng-model="additionalCost.extras"
                                           type="text"
                                    />
                                </td>
                                <td>
                                    <div class="input-group">
                                        <input class="form-control" disabled
                                               format="number:{{ $ctrl.numberPrecision.amountPrecision }}"
                                               id="additional_cost_extrasAmount_{{ $index }}"
                                               ng-model="additionalCost.extrasAmount" readonly/>
                                        <div class="input-group-btn">
                                            <button class="btn dropdown-toggle" data-toggle="dropdown" disabled
                                                    readonly type="button">
                                                {{ additionalCost.currency.code }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.currency, currency)"
                                                    ng-repeat="currency in $ctrl.lists.Currency">
                                                    <a>
                                                        {{ currency.code }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="input-group">
                                        <input class="form-control" disabled
                                               format="number:{{ $ctrl.numberPrecision.amountPrecision }}"
                                               ng-model="additionalCost.totalAmount" readonly/>
                                        <div class="input-group-btn">
                                            <button class="btn dropdown-toggle" data-toggle="dropdown" disabled
                                                    readonly type="button">
                                                {{ additionalCost.currency.code }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.currency, currency)"
                                                    ng-repeat="currency in $ctrl.lists.Currency">
                                                    <a>
                                                        {{ currency.code }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="input-group input-group-sm">
                                        <input class="form-control" disabled
                                               format="number:{{ $ctrl.numberPrecision.pricePrecision }}"
                                               ng-model="additionalCost.rate"
                                               readonly/>
                                        <div class="input-group-btn">
                                            <button aria-expanded="false" aria-haspopup="true"
                                                    class="btn dropdown-toggle"
                                                    data-toggle="dropdown" disabled type="button">
                                                {{ additionalCost.currency.code }}
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li ng-click="$ctrl.updateModel(additionalCost.currency, currency)"
                                                    ng-repeat="currency in $ctrl.lists.Currency">
                                                    <a>
                                                        {{ currency.code }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </form>
                    <div class="clearfix"></div>
                </div>
            </div>

        </div>
    </div>

<!--    ORDER SUMMARY-->
    <div class="row" style="background: #eeeeee;padding: 15px 15px 10px 7px;margin-bottom:5px;">
        <div class="col-md-12 col-sm-11"
             ng-hide="visible_sections.indexOf('order_details') < 0">
            <div class="portlet">
                <div class="portlet-title" style="margin-bottom: 10px;">

                    <div class="caption">
                        <div class="caption-subject">
                            ORDER SUMMARY
                        </div>
                    </div>
                </div>
                <div class="portlet-body" ng-hide="toggleOrderSummary">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="st-span-group">
                                            <span class="bg-white bg-font-white">
                                                Total Fuel Price
                                            </span>
                                <span class="bg-white font-blue-steel">
                                                {{ $ctrl.totalFuelPrice | number: $ctrl.numberPrecision.amountPrecision }}
                                            </span>
                                <span></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="st-span-group">
                                            <span class="bg-white bg-font-white">
                                                Total Cost
                                            </span>
                                <span class="bg-white font-blue-steel">
                                                {{ $ctrl.totalAdditionalCost | number: $ctrl.numberPrecision.amountPrecision }}
                                            </span>
                                <span></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="st-span-group">
                                            <span class="bg-white bg-font-white">
                                                Grand Total
                                            </span>
                                <span class="bg-white font-blue-steel">
                                                {{ $ctrl.grandTotal | number: $ctrl.numberPrecision.amountPrecision }}
                                            </span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!--    ACTION BUTTONS-->

    <div class="row">
        <div class="st-main-content-menu bottom-menu clearfix">
            <div class="pull-right buttons">
                <a class="btn btn-auto-width font-grey-cascade" ng-click="$ctrl.orderPreviewEmail()">
                    <i class="glyphicon glyphicon-envelope" style="font-size: 18px;line-height: 15px;"></i>
                </a>
                <a class="btn btn-default"
                   ng-class="{'disabled': $ctrl.buttonsDisabled || $ctrl.data.status.name == 'Cancelled'}"
                   ng-click="$ctrl.saveOrder()"
                   ng-show="$ctrl.canSave($ctrl.screenActions)">
                    Save
                </a>
                <a ng-if="!$ctrl.tenantSettings.shiptechLite" class="btn btn-default" ng-class="{'disabled': !$ctrl.data.id}"
                   ng-href="#/reports/ordernegotiation/OrderId={{$ctrl.data.id}}"
                   ng-show="{{$ctrl.tenantSettings.defaultValues.isSSRSReports}}" target="blank">
                    Order Negotiation Report
                </a>
                <a class="btn btn-sm btn-default hover-orange" href=""
                   ng-class="{'green-jungle': $ctrl.data.emailToSellerSent && !$ctrl.ConfirmToSellerDisabled}"
                   ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_SELLER, $ctrl.data.id)"
                   ng-disabled="$ctrl.ConfirmToSellerDisabled = !($ctrl.data.id && $ctrl.confirmToSellerManual &&
                              !$ctrl.data.buttonsDisabled && $ctrl.data.seller.name &&
                              ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                   ng-if="$ctrl.dtoHasAction($ctrl.SCREEN_ACTIONS.CONFIRMSELLEREMAIL)">
                    Confirm to Seller
                </a>
                <a class="btn btn-sm btn-default hover-orange" href=""
                   ng-class="{'green-jungle': $ctrl.data.emailToVesselSent && !$ctrl.ConfirmToVesselDisabled}"
                   ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_ALL, $ctrl.data.id)"
                   ng-disabled="$ctrl.ConfirmToVesselDisabled = !($ctrl.data.id && $ctrl.confirmToVesselManual &&
                              !$ctrl.data.buttonsDisabled && !ctrl.data.vessel.name &&
                              ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                   ng-if="$ctrl.dtoHasAction($ctrl.SCREEN_ACTIONS.CONFIRMALLEMAIL)">
                    Confirm to Vessel
                </a>

                <a class="btn btn-sm btn-default hover-orange" href=""
                   ng-class="{'green-jungle': $ctrl.data.emailToLabsSent && !EmailToLabsDisabled}"
                   ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_LABS, $ctrl.data.id)"
                   ng-disabled="EmailToLabsDisabled = !($ctrl.data.id && $ctrl.orderConfirmationEmailToLabs.name == 'Manual' &&
                            $ctrl.data.lab.name && !$ctrl.data.buttonsDisabled &&
                            ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                   ng-if="['None','Automatic'].indexOf($ctrl.orderConfirmationEmailToLabs.name) == -1 && !$ctrl.tenantSettings.shiptechLite">
                    Email to Labs
                </a>
                <a class="btn btn-sm btn-default hover-orange" href=""
                   ng-class="{'green-jungle': $ctrl.data.emailToSurvSent && !EmailToSurveyorDisabled}"
                   ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CONFIRM_TO_SURVEYOR, $ctrl.data.id)"
                   ng-disabled="EmailToSurveyorDisabled = !($ctrl.data.id && $ctrl.orderConfirmationEmailToSurveyor.name == 'Manual' &&
                            $ctrl.data.surveyorCounterparty.name && !$ctrl.data.buttonsDisabled &&
                            ($ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM) || $ctrl.data.status.name == 'Confirmed'))"
                   ng-if="['None','Automatic'].indexOf($ctrl.orderConfirmationEmailToSurveyor.name) == -1">
                    Email to Surveyor
                </a>
                <a class="btn orange btn-outline"
                   ng-class="{'disabled': $ctrl.buttonsDisabled || !$ctrl.hasAction($ctrl.SCREEN_ACTIONS.SUBMITFORAPPROVAL)}"
                   ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.SUBMIT_FOR_APPROVAL, $ctrl.data.id)">
                    Submit for Approval
                </a>
                <a class="btn btn-default"
                   ng-class="{'disabled': !$ctrl.data.id || $ctrl.buttonsDisabled || !$ctrl.hasAction($ctrl.SCREEN_ACTIONS.CONFIRM)}"
                   ng-click="$ctrl.confirmOrder(true)">
                    Confirm
                </a>
                <div class="btn-group">
                    <a aria-expanded="false" class="btn btn-default dropdown-toggle st-show-buttons"
                       data-toggle="dropdown">
                        &hellip;
                    </a>
                    <ul class="dropdown-menu st-extra-buttons" role="menu">
                        <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.CANCELORDER)">
                            <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.CANCEL, $ctrl.data.id)"
                               ng-if="$ctrl.data.id && $ctrl.data.status.id !== $ctrl.STATUS['Cancelled'].id">
                                Cancel
                            </a>
                        </li>
                        <li>
                            <a ng-click="$ctrl.sendOrderCommand('updateCancelOrderReason', $ctrl.data.id)"
                               ng-if="$ctrl.data.id && $ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id && $ctrl.procurementSettings.order.captureReasonToCancelTheOrder.name == 'Yes'">
                                Update Reason
                            </a>
                        </li>
                        <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.REJECTORDER)">
                            <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.REJECT, $ctrl.data.id)">
                                Reject
                            </a>
                        </li>
                        <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.APPROVEORDER)">
                            <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.APPROVE, $ctrl.data.id)">
                                Approve
                            </a>
                        </li>
                        <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.AMENDORDER)">
                            <a ng-click="$ctrl.sendOrderCommand($ctrl.ORDER_COMMANDS.AMEND, $ctrl.data.id)">
                                Amend
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </div>
    <lookup-dialog aria-hidden="true" class="modal fade in" data-width="80%" id="lookup" lookup-type="$ctrl.lookupType"
                   on-buyer-select="$ctrl.selectBuyer(buyer)"
                   on-company-select="$ctrl.selectCompany(company)" on-location-select="$ctrl.selectPort(location)"
                   on-payment-term-select="$ctrl.selectPaymntTerm(paymentTerm)"
                   on-product-select="$ctrl.selectProduct(product)" on-service-select="$ctrl.selectService(service)"
                   on-vessel-select="$ctrl.selectVessel(vessel)"></lookup-dialog>
    <sellers-dialog aria-hidden="true" class="modal fade in sellers-dialog" data-width="90%" id="agents"
                    on-seller-select="$ctrl.selectCounterparty(sellerId)"
                    seller-types="$ctrl.counterpartyTypeId"></sellers-dialog>
    <order-email-dialog aria-hidden="true" class="modal fade in" data-width="30%" id="confirm"
                        message-type="$ctrl.messageType"
                        on-confirm="$ctrl.sendOrderConfirmation()"></order-email-dialog>
</div>

<div aria-hidden="true"
     aria-labelledby="mySmallModalLabel" class="orderConfirmModal2 confirmModal1 modal fade in" data-width="700px"
     id="selectContract"
     ng-if="$ctrl.procurementSettings.order.captureReasonToCancelTheOrder.name == 'Yes' " role="dialog">
    <div role="document">
        <div class="portlet portlet-comment light">
            <div class="portlet-title">
                <button aria-hidden="true" class="close comment" data-dismiss="modal" style="margin-right: 10.5px;"
                        type="button"></button>
                <div class="col-md-6 caption-subject">CANCEL ORDER</div>
            </div>
            <div class="portlet-body">
                <form>
                    <div class="row" style="padding-left: 26px;">
                        <label class="{{ $ctrl.portFields.comments.name }}_label cancelled"
                               for="{{ $ctrl.portFields.comments.name }}"
                               style="width: 189.8px; float: left; color: black; font-weight: bold;">
                            Reason for cancelling order

                        </label>
                        <select id="cancel_reason_cancel_reason_{{ $index }}"
                                name="cancelReason"
                                ng-model="$ctrl.cancelReason.cancelReason"
                                ng-options="cancelReason as cancelReason.name for cancelReason in $ctrl.lists.OrderCancelReasonOption track by cancelReason.id"
                                style=" margin-left: 12.5px; width: 435px; height: 35px;">

                        </select>
                    </div>
                    <div class="row" style="padding-left: 27px; margin-top: 20px;">
                        <div class="col-md-4 col-sm-12" ng-if="$ctrl.portFields.comments.visible" style="float: left">
                            <div class="form-group row">
                                <label class="{{ $ctrl.portFields.comments.name }}_label cancelled"
                                       for="{{ $ctrl.portFields.comments.name }}"
                                       style="width: 125px; float: left; padding-right: 3px; color: black; font-weight: bold;">
                                    <!-- Comment -->

                                    Comments
                                </label>
                                <div class="input-group form_input form_input_{{ $ctrl.portFields.deliveryDate.name }}">
                                    <textarea ng-model="$ctrl.data.cancelOrderComments"
                                              style="width: 458%; margin-left: 76.3px; padding: 0 0  115px; ">
                                     </textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer-comment" ng-if="$ctrl.data.status.id !== $ctrl.STATUS['Cancelled'].id"
                 style="margin-right: 11.1px;">
                <button class="btn  btn-default noAction" data-dismiss="modal" type="button">No</button>
                <button class="btn  btn-default  btn-outline orange confirmAction1" data-dismiss="modal"
                        ng-disabled="!$ctrl.cancelReason.cancelReason" type="button">Yes
                </button>
            </div>
            <div class="modal-footer-comment" ng-if="$ctrl.data.status.id === $ctrl.STATUS['Cancelled'].id"
                 style="margin-right: 11.1px;">
                <button class="btn  btn-default  btn-outline orange confirmAction1" data-dismiss="modal"
                        ng-disabled="!$ctrl.cancelReason.cancelReason" type="button">Save
                </button>
                <button class="btn  btn-default noAction" data-dismiss="modal" type="button">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div aria-labelledby="mySmallModalLabel"
     class="orderConfirmModal2 confirmModal1 fade bs-modal hide"
     ng-if="$ctrl.procurementSettings.order.captureReasonToCancelTheOrder.name == 'No'" role="dialog"
     style="transform: translateY(90px);" tabindex="-1">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="gridSystemModalLabel">Confirm</h4>
            </div>
            <div class="modal-body">
                {{$ctrl.confirmModalData.message}}
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal" type="button">No</button>
                <button class="btn btn-default  btn-outline orange confirmAction1" data-dismiss="modal" type="button">
                    Yes
                </button>
            </div>
        </div>
    </div>
</div>

<div aria-labelledby="mySmallModalLabel1"
     class="orderConfirmModal confirmModal fade bs-modal hide"
     role="dialog"
     style="transform: translateY(90px);" tabindex="-1">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="gridSystemModalLabel">Confirm</h4>
            </div>
            <div class="modal-body">
                {{$ctrl.confirmModalData.message}}
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal" type="button">No</button>
                <button class="btn btn-default  btn-outline orange confirmAction" data-dismiss="modal" type="button">
                    Yes
                </button>
            </div>
        </div>
    </div>
</div>



