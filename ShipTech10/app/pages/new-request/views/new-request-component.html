<div class="row">
    <div class="st-main-content-menu st-displaceable-menu tabbable-line">
        <div class="pull-left">
            <div class=" form-inline">
                <span>
                    <span class="select_visible_sections_label">
                        Display:
                    </span>
                    <select id="multiple" ng-model="visible_sections" class="form-control selectpicker col-md-8 visibleSectionsFilter" multiple multi-select data-selected-text-format="count> 3" ng-change="showHideSections(visible_sections)">
                        <option value="" disabled=""></option>
                        <option value="vessel_details">
                            Vessel Details
                        </option>
                        <option value="request_details">
                            Request Details
                        </option>
                    </select>
                    <label class="mt-checkbox">
                        <input type="checkbox" ng-model="moreInformations" ng-init="moreInformations = true">
                        <span></span>
                        More Information
                    </label>
                </span>
            </div>
        </div>

        <div class="pull-right buttons">
            <div class="st-new-request-form">
                <a class="control-label select_from" ng-click="$ctrl.goEmail()" style="{{$ctrl.previewEmailDisabled ? ('opacity:0.5') : '';}}" ng-class="{'disabled' : $ctrl.isReadonlyForm || $ctrl.previewEmailDisabled || $ctrl.disableAllFields}">
                    Email Preview
                    <i class="glyphicon glyphicon-envelope"></i>
                </a>
            </div>
            <a ng-show="$ctrl.requestTenantSettings.showOperationalReport" ng-class="{'fakeDisabledReport' : !$ctrl.enableReport}" ng-attr-tooltip="{{!$ctrl.enableReport}}" data-original-title="{{!$ctrl.enableReport ? 'Loading reports ...' : null}}" class="btn orange btn-outline" ng-click="$ctrl.enableReport ? $ctrl.goToReport() : ''">
                Report
            </a>
            <a ng-show="$ctrl.canSave($ctrl.screenActions) && !$ctrl.disableAllFields" class="btn orange btn-outline" ng-click="$ctrl.saveRequest()" ng-class="{'disabled' : $ctrl.buttonsDisabled }">
                Save
            </a>
            <a class="btn orange btn-outline" ng-click="$ctrl.sendQuestionnaire()" ng-if="$ctrl.canQuestionnaire()> 0">
                Send Questionnaire
            </a>
            <a class="btn orange btn-outline" ng-click="$ctrl.validatePreRequest()" ng-if="$ctrl.canValidate()> 0">
                Validate
            </a>
            <a class="btn orange btn-outline" ng-show="$ctrl.request.requestStatus.id == $ctrl.STATUS.PartiallyStemmed.id" ng-click="$ctrl.completeRequest()">
                Complete Request
            </a>
            <!--   {{$ctrl.contractHasProduct }} - {{$ctrl.canSave($ctrl.screenActions)}} - {{$ctrl.checkGoContract()}} - {{!$ctrl.selectedContractHasStemmedProduct}} -->
            <a class="btn orange btn-outline" ng-click="$ctrl.confirmContractSelection()" ng-show="$ctrl.contractHasProduct && $ctrl.canSave($ctrl.screenActions) && $ctrl.checkGoContract() && !$ctrl.selectedContractHasStemmedProduct" ng-class="{'disabled' : $ctrl.buttonsDisabled}">
                Proceed to order
            </a>
            <a ng-show="$ctrl.canSave($ctrl.screenActions) && $ctrl.hasAction($ctrl.SCREEN_ACTIONS.GOSPOT)" class="btn orange btn-outline" ng-click="$ctrl.goSpot(true)" ng-class="{'disabled' : $ctrl.buttonsDisabled}">
                Go spot
            </a>
            <div class="btn-group">
                <a class="btn btn-default dropdown-toggle st-show-buttons" data-toggle="dropdown" aria-expanded="false" ng-class="{'disabled' : $ctrl.extraButtons() || $ctrl.buttonsDisabled}">
                    &hellip;
                </a>
                <ul class="dropdown-menu st-extra-buttons" role="menu">

                    <li ng-if="$ctrl.canCancel() > 0">
                        <a ng-if="$ctrl.requestTenantSettings.captureReasonToCancelRequest.id == 1" ng-click="$ctrl.cancelRequest()">
                            Cancel
                        </a>
                        <a ng-if="$ctrl.requestTenantSettings.captureReasonToCancelRequest.id == 2" ng-click="$ctrl.showCancelRequestConfirm()">
                            Cancel
                        </a>
                    </li>
                    <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.COPY) && $ctrl.request.requestStatus.name != 'Cancelled'">
                        <a ng-click="$ctrl.copyRequest()">
                            Copy
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="st-main-content-menu st-displaceable-menu tabbable-line tabs_bar" ng-show="moreInformations" ng-init="$ctrl.getData()">
        <ul class="nav nav-tabs pull-left">
            <li class="open">
                <a>
                    Request
                </a>
            </li>
            <li ng-if="$ctrl.showReport && $ctrl.hasAccess">
                <a ng-class="{'disabled' : !$ctrl.request.id}" href="/#/view-request-report/{{NAV.requestId}}">
                    Report
                </a>
            </li>
            <li>
                <a ng-class="{'disabled' : !$ctrl.request.id}" ui-sref="default.view-request-documents({requestId: NAV.requestId})">
                    Documents
                </a>
            </li>
            <li>
                <a ng-class="{'disabled' : !$ctrl.request.id}" ui-sref="default.view-request-emaillog({requestId: NAV.requestId})">
                    Email Log
                </a>
            </li>
            <li>
                <a ng-class="{'disabled' : !$ctrl.request.id}" ui-sref="default.view-request-auditlog({requestId: NAV.requestId})">
                    Audit Log
                </a>
            </li>

        </ul>
        <div class="clearfix"></div>
    </div>
</div>
<fieldset ng-disabled="$ctrl.isReadonlyForm">
    <div class="row">
        <div class="portlet light" ng-hide="visible_sections.indexOf('vessel_details') < 0">
            <div class="portlet-title">
                <div class="tools">
                    <a class="collapse" data-original-title="" title=""></a>
                </div>
                <div class="caption">
                    <span class="caption-subject">
                        Vessel Details
                        <span  ng-if="$ctrl.request.vesselDetails.vessel.is2MDelivery==1" class="entity-status ng-binding ng-scope" style="color:red">
                            2M DELIVERY
                        </span>
                        <span style="color:red"> {{ $ctrl.request.vesselDetails.vessel.vesselIsoSpecGroup.name }}</span>
                        <!--
                        <span class="caption-subject" >
                        Vessel Details
                        <span ng-repeat="location in $ctrl.request.locations | limitTo:1" ng-if="location.service.is2MDelivery==1"  class="entity-status ng-binding ng-scope" style="color:red">
                        2M DELIVERY {{ $ctrl.request.vesselDetails.vessel.vesselIsoSpecGroup.name.split(" ",1)[0] }}
                        </span> -->
                       </span>
                </div>
            </div>
           <!-- operatorBy: {{$ctrl.request.operatorBy}} -->
            <div class="portlet-body" ng-controller="Controller_Master as CM">
                <form id="vesselDetails" class="form-inline st-new-request-form collapse in" name="forms.vesselDetailsForm" novalidate autocomplete="off">
                    <div sorted-form field-ids="$ctrl.ui.vesselDetails.fields" get-from-id="vesselDetails">
                        <!-- Not implemented -->
                    </div>
                    <div class="container-fluid">
                        <div class="row">
                            <div ng-if="$ctrl.vesselDetailsFields.Vessel.visible" class="col-md-4" ng-init='CM.getOptions({"Name": "Vessel","masterSource": "Vessel"})' data-html="true" tooltip data-original-title="{{ $ctrl.defaultProductsTooltip() }}">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ $ctrl.vesselDetailsFields.Vessel.caption | translate }}
                                        <span ng-if="$ctrl.request.vesselDetails.vessel.vesselToWatchFlag">
                                            <i class="fa fa-flag vesselToWatchFlag"></i>
                                        </span>
                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;">*</span>
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-7">
                                            <input decode-input-format name="{{ $ctrl.vesselDetailsFields.Vessel.name }}" id="id_{{ $ctrl.vesselDetailsFields.Vessel.name }}" uib-typeahead="vessel as vessel.name  for vessel in options.Vessel | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectVessel($item.id); CM.getOptions({'Name': 'BunkerablePort','masterSource': 'masters_locations', 'filters': $ctrl.request.vesselDetails.vessel})" typeahead-editable="false" class="typeahead form-control" ng-model="$ctrl.request.vesselDetails.vessel.name" required ng-disabled="$ctrl.request.id || $ctrl.disableAllFields">
                                            <span class="input-group-addon" ng-click="triggerModal('general', 'masters_vessellist', $ctrl.vesselDetailsFields.Vessel.caption | translate, '$ctrl.request.vesselDetails.vessel','','',$ctrl.vesselDetailsFields.Vessel.name)" ng-class="{'disabled' : ($ctrl.isReadonlyForm || $ctrl.request.id)}" ng-disabled="$ctrl.request.id || $ctrl.disableAllFields">
                                                <i class="fa fa-search"></i>
                                            </span>
                                            <span class="input-group-addon" data-toggle="modal" ng-click="$ctrl.getVesselSchedules()" href="#route_schedule" data-html="true" tooltip data-original-title="View Vessel Voyage" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-disabled="!$ctrl.request.vesselDetails.vessel || $ctrl.disableAllFields">
                                                <i class="fa fa-anchor"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="$ctrl.vesselDetailsFields.VesselImoNo.visible" class="col-md-4" ng-init='CM.getOptions({"Name": "VesselWithImo","masterSource": "VesselWithImo"})' data-html="true" tooltip data-original-title="{{ $ctrl.defaultProductsTooltip() }}">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ $ctrl.vesselDetailsFields.VesselImoNo.caption | translate }}
                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                    </label>
                                    <div class="form-group-sm00">
                                        <span ng-init="$ctrl.options.VesselWithImo = options.VesselWithImo" ng-if="$ctrl.options.VesselWithImo"></span>
                                        <div class="input-group col-md-7">
                                            <input decode-input-format ng-disabled="$ctrl.requestId ? true : false || $ctrl.disableAllFields" name="{{ $ctrl.vesselDetailsFields.VesselImoNo.name }}" id="id_{{ $ctrl.vesselDetailsFields.VesselImoNo.name }}" placeholder="{{ $ctrl.vesselDetailsFields.VesselImoNo.placeholder }}" uib-typeahead="vesselimo as vesselimo.name for vesselimo in options.VesselWithImo | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectVessel($item.id)" typeahead-editable="false" class="typeahead form-control" ng-model="$ctrl.request.vesselDetails.vesselImoNo" required>

                                            <span ng-disabled="$ctrl.requestId ? true : false || $ctrl.disableAllFields" class="input-group-addon" ng-click="triggerModal('general', 'masters_vessellist', $ctrl.vesselDetailsFields.VesselImoNo.caption | translate, '$ctrl.request.vesselDetails.vesselImoNo','','',$ctrl.vesselDetailsFields.VesselImoNo.name)" ng-class="{'disabled' : $ctrl.isReadonlyForm}">
                                                <i class="fa fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <span ng-if="$ctrl.requestTenantSettings.displayOfService.id == 1">
                                <div ng-if="$ctrl.vesselDetailsFields.ServiceCode.visible" class="col-md-4" ng-init='CM.getOptions({"Name": "Service","masterSource": "Service"})' data-html="true" tooltip data-original-title="{{ $ctrl.serviceTooltip('Vessel') }}">
                                    <div class="row">
                                        <label class="control-label col-md-5">
                                            {{ $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate }}
                                            <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                        </label>
                                        <div class="form-group-sm00">
                                            <div class="input-group col-md-7">
                                                <input ng-disabled="$ctrl.disableAllFields" name="{{ $ctrl.vesselDetailsFields.ServiceCode.name }}" id="id_{{ $ctrl.vesselDetailsFields.ServiceCode.name }}" placeholder="{{ $ctrl.vesselDetailsFields.ServiceCode.placeholder }}" uib-typeahead="service as service.name for service in options.Service | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectService($item.id)" typeahead-editable="false" class="typeahead form-control" ng-model="$ctrl.request.vesselDetails.service.name" required>

                                                <span ng-disabled="$ctrl.disableAllFields" class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'masters_servicelist', $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate, '$ctrl.request.vesselDetails.service','','',$ctrl.vesselDetailsFields.ServiceCode.name)">
                                                    <i class="fa fa-search"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </span>
                            <div ng-if="$ctrl.vesselDetailsFields.Chartered.visible" class="col-md-4 checkbox_keep_height" style="min-height: 45px !important">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ $ctrl.vesselDetailsFields.Chartered.caption | translate }}

                                    </label>
                                    <div class="form-group-sm">
                                        <div class="input-group col-md-7 row">
                                            <label class="mt-checkbox mt-checkbox-outline">
                                                <input name="{{ $ctrl.vesselDetailsFields.Chartered.name }}" id="id_{{ $ctrl.vesselDetailsFields.Chartered.name }}" placeholder="{{ $ctrl.vesselDetailsFields.Chartered.placeholder }}" type="checkbox" ng-checked="($ctrl.lists.VesselOwnership | filter: {id : $ctrl.request.vesselDetails.vesselOwnershipId})[0].name == 'Chartered'" disabled>
                                                <span></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <span ng-if="$ctrl.requestTenantSettings.displayOfCompany.id == 1">
                                <div ng-if="$ctrl.vesselDetailsFields.Company.visible" class="col-md-4">
                                    <div class="row">
                                        <label class="control-label col-md-5">
                                            {{ $ctrl.tenantSettings.companyDisplayName.name | translate }}
                                            <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                        </label>
                                        <div class="form-group-sm00">
                                            <div class="input-group col-md-7">
                                                <input name="{{ $ctrl.vesselDetailsFields.Company.name }}" id="id_{{ $ctrl.vesselDetailsFields.Company.name }}" placeholder="{{ $ctrl.vesselDetailsFields.Company.placeholder }}" uib-typeahead="company as company.name for company in $ctrl.lists.Company | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectCompany($item.id)" typeahead-editable="false" class="typeahead form-control" ng-model="$ctrl.request.company.name" required>
                                                <span class="input-group-addon" ng-click="triggerModal('general', 'masters_companylist', $ctrl.tenantSettings.companyDisplayName.name | translate, '$ctrl.request.company.name','','',$ctrl.vesselDetailsFields.Company.name)" ng-class="{'disabled' : $ctrl.isReadonlyForm}">
                                                    <i class="fa fa-search"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </span>

                            <div ng-if="$ctrl.vesselDetailsFields.RequestDate.visible" class="col-md-4 ">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ $ctrl.vesselDetailsFields.RequestDate.caption | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-7">
                                            <input name="{{ $ctrl.vesselDetailsFields.RequestDate.name }}" id="id_{{ $ctrl.vesselDetailsFields.RequestDate.name }}" placeholder="{{ $ctrl.vesselDetailsFields.RequestDate.placeholder }}" class="form-control date form_meridian_datetime" ng-model="$ctrl.request.requestDate" st-date-format st-date-to-local disabled>
                                            <span class="input-group-addon disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4" data-html="true" ng-hide="$ctrl.requestTenantSettings.isRequestOperatorHidden">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ 'PAGES.NEW_REQUEST.OPERATOR' | translate }}
                                        <span ng-if="$ctrl.isOperatorRequired()" style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-7" ng-init='CM.getOptions({"Name": "usersList","masterSource": "admin_users"})'>                                        
                                            <input decode-input-format ng-disabled="$ctrl.disableAllFields" name="{{ $ctrl.vesselDetailsFields.OperatorBy.name }}" id="id_{{ $ctrl.vesselDetailsFields.OperatorBy.name }}" uib-typeahead="entity.username as entity.username for entity in options.usersList | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectOperator($item)" typeahead-editable="true" class="typeahead form-control"  ng-model="$ctrl.request.operatorBy.name" ng-required="$ctrl.isOperatorRequired()">
                                            <span class="input-group-addon" ng-click="triggerModal('general', 'admin_userlist', 'Operator' , '$ctrl.request.vesselDetails.Operator','','',$ctrl.vesselDetailsFields.Operator.name)" ng-class="{'disabled' : $ctrl.isReadonlyForm}">
                                                <i class="fa fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Operator email -->
                            <div class="col-md-4 " ng-hide="$ctrl.requestTenantSettings.isRequestOperatorHidden">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ "PAGES.NEW_REQUEST.OPERATOR_EMAIL" | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-7">
                                            <input disabled name="operator_email" id="id_operator_email" placeholder="Operator Email" class="form-control " ng-model="$ctrl.request.operatorEmail" >

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4 " ng-hide="$ctrl.requestTenantSettings.isRequestPoNumberHidden">
                                <div class="row">
                                    <label class="control-label col-md-5">
                                        {{ "PAGES.NEW_REQUEST.PO_NUMBER" | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-7">
                                            <input name="{{ $ctrl.vesselDetailsFields.PONumber.name }}" id="id_{{ $ctrl.vesselDetailsFields.PONumber.name }}" placeholder="{{ $ctrl.vesselDetailsFields.PONumber.placeholder }}" class="form-control " ng-model="$ctrl.request.poNumber" ng-required="$ctrl.requestTenantSettings.isRequestPoNumberMandatory">

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- {{$ctrl.request.locations}} -->
                            <div ng-if="$ctrl.vesselDetailsFields.linebreak_1.visible" class="clearfix"></div>
                        </div> <!-- .row -->
                    </div> <!-- .container-fluid -->
                </form>

                <div class="clearfix"></div>
            </div>
        </div>
        <!-- ROB Details -->
        <div>
            <div class="portlet light" ng-if="$ctrl.vesselCharteredDetails.vesselOwnership.id == 2">
                <div class="portlet-title">
                    <div class="tools">
                        <a class="collapse" data-original-title="" title=""></a>
                    </div>
                    <div class="caption">
                        <span class="caption-subject">
                            <!-- ROB Details -->
                            Chartering details
                        </span>
                    </div>
                </div>

                <div class="portlet-body" style="padding: 15px;">

                    <form id="charteringDetails" class="form-inline st-new-request-form collapse in" novalidate autocomplete="off">

                        <div class="row">
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        Charterer Name
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input decode-input-format name="chartererName" readonly="" disabled class="form-control" ng-model="$ctrl.vesselCharteredDetails.chartererName">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        Delivery Date
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="delivery" readonly="" disabled class="form-control" st-date-format ng-model="$ctrl.vesselCharteredDetails.delivery">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        Expiry Date
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="expiry" readonly="" disabled class="form-control" st-date-format ng-model="$ctrl.vesselCharteredDetails.expiry">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="$ctrl.vesselDetailsFields.EarliestRedeliveryDate.visible && ($ctrl.lists.VesselOwnership | filter: {id : $ctrl.request.vesselDetails.vesselOwnershipId})[0].name == 'Chartered'" class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        {{ $ctrl.vesselDetailsFields.EarliestRedeliveryDate.caption | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="{{ $ctrl.vesselDetailsFields.EarliestRedeliveryDate.name }}" only-date="true" id="id_{{ $ctrl.vesselDetailsFields.EarliestRedeliveryDate.name }}" placeholder="{{ $ctrl.vesselDetailsFields.EarliestRedeliveryDate.placeholder }}" class="form-control date form_meridian_datetime" ng-model="$ctrl.request.vesselDetails.earliestRedeliveryDate" st-date-format disabled readonly="" disabled>
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="$ctrl.vesselDetailsFields.EstimatedRedeliveryDate.visible && ($ctrl.lists.VesselOwnership | filter: {id : $ctrl.request.vesselDetails.vesselOwnershipId})[0].name == 'Chartered'" class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        {{ $ctrl.vesselDetailsFields.EstimatedRedeliveryDate.caption | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="{{ $ctrl.vesselDetailsFields.EstimatedRedeliveryDate.name }}" only-date="true" id="id_{{ $ctrl.vesselDetailsFields.EstimatedRedeliveryDate.name }}" placeholder="{{ $ctrl.vesselDetailsFields.EstimatedRedeliveryDate.placeholder }}" class="form-control date form_meridian_datetime" ng-model="$ctrl.request.vesselDetails.estimatedRedeliveryDate" st-date-format readonly="" disabled>
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="$ctrl.vesselDetailsFields.LatestRedeliveryDate.visible && ($ctrl.lists.VesselOwnership | filter: {id : $ctrl.request.vesselDetails.vesselOwnershipId})[0].name == 'Chartered'" class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        {{ $ctrl.vesselDetailsFields.LatestRedeliveryDate.caption | translate }}
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="{{ $ctrl.vesselDetailsFields.LatestRedeliveryDate.name }}" only-date="true" id="id_{{ $ctrl.vesselDetailsFields.LatestRedeliveryDate.name }}" placeholder="{{ $ctrl.vesselDetailsFields.LatestRedeliveryDate.placeholder }}" class="form-control date form_meridian_datetime" ng-model="$ctrl.request.vesselDetails.latestRedeliveryDate" st-date-format readonly="" disabled>
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        Latest Redelivery Port
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input decode-input-format name="redeliveryLocation" readonly="" disabled class="form-control" ng-model="$ctrl.vesselCharteredDetails.redeliveryLocation.name">
                                            <span class="input-group-addon bg-grey-steel disabled" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_location', 'Select Latest Redelivery Port', '', '', '', 'ports', $ctrl.vesselCharteredDetails.redeliveryLocation.name)" ng-disabled="!$ctrl.request.vesselDetails.vessel || $ctrl.disableAllFields">
                                                <!-- procurement_bunkerableport -->
                                                <!-- masters_locationlist -->
                                                <i class="fa fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>


                    <form id="RobDetails" class="form-inline st-new-request-form collapse in" name="forms.robDetailsForm" novalidate autocomplete="off">

                        <div class="row">
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB Date
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robDate" st-date-format>
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                <i class="glyphicon glyphicon-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB HSFO on Delivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robHsfoDeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robHsfoDeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB LSFO on Delivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robLsfoDeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robLsfoDeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB DO/GO on Delivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robDoGoDeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robDoGoDeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB HSFO on Redelivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robHsfoRedeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robHsfoRedeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB LSFO on Redelivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robLsfoRedeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robLsfoRedeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="row">
                                    <label class="control-label col-md-5" style="padding-left: 0;">
                                        ROB DO/GO on Redelivery
                                    </label>
                                    <div class="form-group-sm00">
                                        <div class="input-group">
                                            <input name="robDate" readonly="" disabled class="form-control" ng-model="$ctrl.robDetails.robDoGoRedeliveryQuantity">
                                            <span class="input-group-addon bg-grey-steel disabled">
                                                {{$ctrl.robDetails.robDoGoRedeliveryUom.name}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="clearfix"></div>
                </div>
            </div>
            <!-- END ROB Details -->
            <div class="portlet light" ng-hide="visible_sections.indexOf('request_details') < 0">
                <div class="portlet-title">
                    <div class="tools">
                        <a class="collapse" data-original-title="" title=""></a>
                    </div>
                    <div class="caption">
                        <span class="caption-subject">
                            Request Details - REQ {{ $ctrl.stateParams.requestId }}
                        </span>
                    </div>
                    <div class="pull-right" ng-if="$ctrl.request.requestGroup.id">
                        <b>
                            View Negotiation details:
                            <a href="#/group-of-requests/{{ $ctrl.request.requestGroup.id }}">
                                {{ $ctrl.request.requestGroup.id }}
                            </a>
                        </b>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">

                        </div>
                        <div class="col-md-12" ng-controller="Controller_Master as CM">
                            <form class="form-inline st-new-request-form ports" name="forms.portsForm" novalidate autocomplete="off">
                                <div class="form-group-sm00 row">
                                    <div class="input-group col-md-3">
                                        <span class="hidden" ng-if="!$ctrl.isNewRequest" ng-init='CM.getOptions({"Name": "BunkerablePort","masterSource": "masters_locations"})'></span>
                                        <label class="control-label col-md-5">
                                            Select Bunkerable Port
                                            <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                        </label>
                                        <div class="form-group-sm00">
                                            <div class="input-group col-md-7">
                                                <input decode-input-format name="ports" id="id_Ports" ng-model="dumm" class="typeahead form-control" ng-class="{'ng-invalid': $ctrl.request.locations.length == 0}" uib-typeahead="destPort as destPort.name for destPort in updateDestinations($viewValue, 'BunkerablePort')" type="text" typeahead-on-select="addTypeLocation(dumm.id, dumm)" typeahead-loading="$ctrl.loadedTypeaheadPort" typeahead-wait-ms="100" ng-model-options="{ allowInvalid: false, debounce: 100 }" ng-disabled="!$ctrl.request.vesselDetails.vessel || $ctrl.disableAllFields">
                                                <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_bunkerableport', 'Bunkerable Port', '$ctrl.new_location' ,'','', 'ports', $ctrl.request.vesselDetails.vessel)" ng-disabled="!$ctrl.request.vesselDetails.vessel || $ctrl.disableAllFields">
                                                    <!-- procurement_bunkerableport -->
                                                    <!-- masters_locationlist -->
                                                    <i class="fa fa-search"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="col-md-3 label-list">
                                        <span ng-repeat="location in $ctrl.request.locations track by $index" class="tag label label-info" ng-if="!location.isDeleted && location.location !== null" data-original-title=" {{ location.location.name }}">
                                            <a ng-click="$ctrl.deleteLocation(location)" ng-disabled="$ctrl.disableAllFields">
                                                <i class="fa fa-close clickable" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                               <b > {{location.optionId}}- </b>{{location.location.name | decodeReadOnly}}
                                            </a>
                                        </span>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <!-- vesselDetailsFields:{{$ctrl.vesselDetailsFields}}
            options:{{$ctrl.options}}
            NEW_REQUEST:{{'PAGES.NEW_REQUEST'}} -->
            <div class=" product-info" ng-controller="Controller_Master as CM">
                <div ng-repeat="(locationIdx, location) in $ctrl.request.locations track by $index" ng-if="!location.isDeleted && location.location !== null">
                    <div class="" ng-init="$ctrl.initializeDateInputs(); $ctrl.isEnabledEta(locationIdx)" ng-mouseover="$ctrl.initializeDateInputs()">
                        <span ng-init="CM.initMask(true)"></span>  <!-- datepicker mask initialization  -->
                        <div class="col-md-12 location-label">
                            <span class="caption-subject row">
                                <a role="button" data-toggle="collapse" href="#location{{ $index }}">
                                    <i class="fa fa-angle-double-down"></i>
                                </a>
                                {{ location.location.name | decodeReadOnly}}
                                {{ location.voyageCode ? ' - '+ location.voyageCode : '' }}
                                {{location.portCallId ? ' - '+ location.portCallId : '' }}
                            </span>
                            <br>
                        </div>
                        <span id="location{{ $index }}" class="pull-left collapse in w100">
                            <div class="st-product-info-form-container">
                                <form class="st-new-request-form form-horizontal" name="forms.locationForm[$index]" novalidate autocomplete="off">
                                    <div class="col-md-12" ng-init="">
                                        <div class="row">
                                            <!-- {{$ctrl.productInfoFields}} -->
                                            <div ng-if="$ctrl.productInfoFields.Eta.visible" class="col-md-4">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.Eta.caption | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>

                                                    <!-- disabled ETA -->
                                                    <div class="form-group-sm00" ng-if="!$ctrl.etaEnabled[locationIdx]">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input class="form-control" disabled readonly="" disabled type="text" ng-model="location.eta" name="{{ $ctrl.productInfoFields.Eta.name }}" st-date-format>
                                                        </div>
                                                    </div>
                                                    <!-- end disabled ETA -->
													
                                                    <!-- enabled ETA -->
                                                    <div class="form-group-sm00" ng-if="$ctrl.etaEnabled[locationIdx]">
                                                        <div class="input-group col-md-8 col-sm-12">
																  
                                                            <input ng-model="$ctrl.request.locations[locationIdx].eta"
                                                                   ng-disabled="$ctrl.disableAllFields"
                                                                   ng-change="$ctrl.etaChanged(location, locationIdx); $ctrl.validateRequestDateFields(location, locationIdx)"
                                                                   name="{{ locationIdx }}_eta"
                                                                   id="{{ locationIdx }}_eta"
                                                                   new-date-picker
                                                                   ng-required="true"
                                                                   picker-type="dynamic"
                                                                   class="form-control date-mask new-date-picker">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="$ctrl.productInfoFields.Etb.visible" class="col-md-4">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.Etb.caption | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
																  
                                                            <input ng-model="$ctrl.request.locations[locationIdx].etb"
                                                                   ng-disabled="$ctrl.disableAllFields"
                                                                   ng-change="$ctrl.validateRequestDateFields(location, locationIdx)"
                                                                   name="{{ locationIdx }}_etb"
                                                                   id="{{ locationIdx }}_etb"
                                                                   new-date-picker
                                                                   ng-required="true"
                                                                   picker-type="dynamic"
                                                                   class="form-control date-mask new-date-picker">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="$ctrl.productInfoFields.Etd.visible" class="col-md-4">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.Etd.caption | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
																  
                                                            <input ng-model="$ctrl.request.locations[locationIdx].etd"
                                                                   ng-disabled="$ctrl.disableAllFields"
                                                                   ng-change="$ctrl.validateRequestDateFields(location, locationIdx)"
                                                                   name="{{ locationIdx }}_etd"
                                                                   id="{{ locationIdx }}_etd"
                                                                   new-date-picker
                                                                   ng-required="true"
                                                                   picker-type="dynamic"
                                                                   class="form-control date-mask new-date-picker">
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>


                                            <div ng-if="$ctrl.requestTenantSettings.recentEta.id == 1" class="col-md-4">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ 'PAGES.NEW_REQUEST.RECENT_ETA' | translate }}
                                                    </label>

                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
																  
                                                            <input ng-class="{'invalid': location.eta > location.etb || location.recentEta > location.etb}"
                                                                   ng-model="$ctrl.request.locations[locationIdx].recentEta"
                                                                   ng-disabled="$ctrl.disableAllFields"
                                                                   ng-change="$ctrl.validateRequestDateFields(location, locationIdx)"
                                                                   name="{{ locationIdx }}_recentEta"
                                                                   id="{{ locationIdx }}_recentEta"
                                                                   new-date-picker
                                                                   picker-type="dynamic"
                                                                   class="form-control date-mask new-date-picker">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- DELIVERYWINDOWDISPLAY -->
                                            <div class="col-md-4" ng-if="$ctrl.requestTenantSettings.deliveryWindowDisplay.id == 1">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ 'PAGES.NEW_REQUEST.DELIVERY_FROM' | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input name="Delivery From"
                                                                   id="id_delivery_from-{{$index}}"
                                                                   class="form-control date-mask new-date-picker"
                                                                   ng-model="location.deliveryFrom"
                                                                   ng-class="{'etb_invalid': $ctrl.datesValid(locationIdx)}"
                                                                   new-date-picker
                                                                   picker-type="dynamic"
                                                                   ng-required="true"
                                                                   ng-disabled="$ctrl.disableAllFields">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4" ng-if="$ctrl.requestTenantSettings.deliveryWindowDisplay.id == 1">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ 'PAGES.NEW_REQUEST.DELIVERY_TO' | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group date form_meridian_datetime col-md-8 col-sm-12">
                                                            <input name="Delivery To"
                                                                   readonly=""
                                                                   disabled id="id_delivery_to-{{$index}}"
                                                                   class="form-control date-mask new-date-picker"
                                                                   ng-model="location.deliveryTo"
                                                                   ng-class="{'etb_invalid':  $ctrl.datesValid(locationIdx)}"
                                                                   new-date-picker
                                                                   picker-type="dynamic"
                                                                   ng-required="true"
                                                                   ng-disabled="$ctrl.disableAllFields">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- END DELIVERYWINDOWDISPLAY -->
                                            <div ng-if="$ctrl.productInfoFields.DestinationPort.visible" class="col-md-4" ng-init=' $ctrl.getLowestEtaForDestinationInLocation(locationIdx);'>
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.DestinationPort.caption | translate }}
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input decode-input-format name="{{ $ctrl.productInfoFields.DestinationPort.name }}{{ $index }}" id="id_{{ $ctrl.productInfoFields.DestinationPort.name }}{{ $index }}" class="typeahead form-control" ng-model="location.destinationInput" uib-typeahead="destPort as destPort.name for destPort in updateDestinations($viewValue, 'DestinationPort', location)" typeahead-on-select="$ctrl.selectDestinationPort($item, locationIdx)" typeahead-editable="false" ng-model-options="{ allowInvalid: false, debounce: 100 }" typeahead-loading="$ctrl.loadedTypeaheadPort" typeahead-wait-ms="100" data-origina-title="{{ location.destination.name }}" ng-disabled="$ctrl.disableAllFields">
                                                            <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_destinationport', 'Destination Port', '$ctrl.location[' + $index + '].destinationInput','','', $ctrl.productInfoFields.DestinationPort.name + $index, $ctrl.request.vesselDetails.vessel, location)" ng-disabled="$ctrl.disableAllFields">
                                                                <i class="fa fa-search"></i>
                                                            </span>
                                                            <span ng-init="showMultiDestinations[locationIdx] = false" class="input-group-addon {{showMultiDestinations[locationIdx] ? 'bg-grey-salt' : ''}}" ng-click="showMultiDestinations[locationIdx] = !showMultiDestinations[locationIdx]">
                                                                <i class="fa fa-ellipsis-h"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="multiSelectDestinationPorts" ng-show="showMultiDestinations[locationIdx]">
                                                    <div class="border border-grey-cascade font-dark label tag" ng-if="location.destination.id" data-original-title="location.destination.name">
                                                        <i class="fa fa-close font-red-mint" ng-click="location.destination = null; location.destinationEta = null; location.destinationEtaFormatted = null; location.destinationVesselVoyageDetailId = null; $ctrl.getLowestEtaForDestinationInLocation(locationIdx);" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                                        <span class="font-dark">
                                                            {{location.destination.name | decodeReadOnly}}
                                                        </span>
                                                    </div>
                                                    <div class="border border-grey-cascade font-dark label tag" ng-if="location.destination1.id" data-original-title="location.destination1.name">
                                                        <i class="fa fa-close font-red-mint" ng-click="location.destination1 = null; location.destination1Eta = null; location.destination1EtaFormatted = null; location.destination1VesselVoyageDetailId = null; $ctrl.getLowestEtaForDestinationInLocation(locationIdx);" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                                        <span class="font-dark">
                                                            {{location.destination1.name | decodeReadOnly}}
                                                        </span>
                                                    </div>
                                                    <div class="border border-grey-cascade font-dark label tag" ng-if="location.destination2.id" data-original-title="location.destination2.name">
                                                        <i class="fa fa-close font-red-mint" ng-click="location.destination2 = null; location.destination2Eta = null; location.destination2EtaFormatted = null; location.destination2VesselVoyageDetailId = null; $ctrl.getLowestEtaForDestinationInLocation(locationIdx);" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                                        <span class="font-dark">
                                                            {{location.destination2.name | decodeReadOnly}}
                                                        </span>
                                                    </div>
                                                    <div class="border border-grey-cascade font-dark label tag" ng-if="location.destination3.id" data-original-title="location.destination3.name">
                                                        <i class="fa fa-close font-red-mint" ng-click="location.destination3 = null; location.destination3Eta = null; location.destination3EtaFormatted = null; location.destination3VesselVoyageDetailId = null; $ctrl.getLowestEtaForDestinationInLocation(locationIdx);" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                                        <span class="font-dark">
                                                            {{location.destination3.name | decodeReadOnly}}
                                                        </span>
                                                    </div>
                                                    <div class="border border-grey-cascade font-dark label tag" ng-if="location.destination4.id" data-original-title="location.destination4.name">
                                                        <i class="fa fa-close font-red-mint" ng-click="location.destination4 = null; location.destination4Eta = null; location.destination4EtaFormatted = null; location.destination4VesselVoyageDetailId = null; $ctrl.getLowestEtaForDestinationInLocation(locationIdx);" ng-class="{'disabled' : $ctrl.isReadonlyForm}"></i>
                                                        <span class="font-dark">
                                                            {{location.destination4.name | decodeReadOnly}}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="$ctrl.productInfoFields.Buyer.visible" class="col-md-4">
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.Buyer.caption | translate }}
                                                        <span  style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;">*</span>                                                       
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input decode-input-format name="{{ $ctrl.productInfoFields.Buyer.name }}" id="id_{{ $ctrl.productInfoFields.Buyer.name }}" placeholder="{{ $ctrl.productInfoFields.Buyer.placeholder }}" class="typeahed form-control" typeahead-on-select="$ctrl.captureReasonModal(locationIdx, null, 'REQUEST_LOCATION_BUYER', 'buyer')" uib-typeahead="buyer as buyer.name for buyer in  $ctrl.listsCache.Buyer | typeaheadCustomFilter:$viewValue:'name'" ng-model="location.buyer" required typeahead-editable="false" ng-focus="$ctrl.setLookupInput(location)" ng-blur="location.buyer.name == null || location.buyer.name == '' ? location.buyer = null : '' ;" ng-value="location.buyer.name" ng-disabled="$ctrl.disableAllFields">
                                                            <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_buyerlist', 'Select Buyer','$ctrl.location[' + $index + '].buyer' ,'','', $$ctrl.productInfoFields.Buyer.name, $ctrl.request.vesselDetails.vessel)" ng-disabled="$ctrl.disableAllFields">
                                                                <i class="glyphicon glyphicon-search"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="$ctrl.productInfoFields.Agent.visible" class="col-md-4" style="clear: both;" ng-init='CM.getOptions({"Name": "Agent","masterSource": "Agent"})'>
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.Agent.caption | translate }}
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12" ng-if="$ctrl.requestTenantSettings.agentDisplay.name == 'Lookup'">
                                                            <input decode-input-format name="{{ $ctrl.productInfoFields.Agent.name }}" id="id_{{ $ctrl.productInfoFields.Agent.name }}" class="typeahead form-control" uib-typeahead="ag as ag.name for ag in options.Agent | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.agentLocationIdx = $index; $ctrl.selectAgent($item.id)" ng-model="location.agent" typeahead-editable="false" ng-blur="location.agent.name == null || location.agent.name == '' ? location.agent = null : '' " ng-value="location.agent.name" ng-disabled="$ctrl.disableAllFields">
                                                            <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_agentlist', 'Select Agent', '$ctrl.location[' + $index + '].agent' ,'','', $$ctrl.productInfoFields.Agent.name)" ng-disabled="$ctrl.disableAllFields">
                                                                <i class="glyphicon glyphicon-search"></i>
                                                            </span>
                                                        </div>
                                                        <div class="input-group col-md-8 col-sm-12" ng-if="$ctrl.requestTenantSettings.agentDisplay.name == 'Free text'">
                                                            <input name="{{ $ctrl.productInfoFields.Agent.name }}" id="id_{{ $ctrl.productInfoFields.Agent.name }}" class="typeahead form-control" ng-model="location.agentCounterpartyFreeText" ng-disabled="$ctrl.disableAllFields">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="$ctrl.productInfoFields.PortCall.visible" class="col-md-4" ng-init='CM.getOptions({"Name": "PortCall","masterSource": "PortCall", "Filter": $ctrl.formatPortCallFilter("portCall")})'>
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.productInfoFields.PortCall.name | translate }}
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <!-- <input decode-input-format name="{{ $ctrl.productInfoFields.Agent.name }}" id="id_{{ $ctrl.productInfoFields.Agent.name }}" class="typeahead form-control" uib-typeahead="ag as ag.name for ag in options.Agent | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.agentLocationIdx = $index; $ctrl.selectAgent($item.id)" ng-model="location.agent" typeahead-editable="false" ng-blur="location.agent.name == null || location.agent.name == '' ? location.agent = null : '' " ng-value="location.agent.name" ng-disabled="$ctrl.disableAllFields"> -->
                                                            <!-- <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" ng-click="triggerModal('general', 'procurement_agentlist', 'Select Agent1', '$ctrl.location[' + $index + '].agent' ,'','', $$ctrl.productInfoFields.Agent.name)" ng-disabled="$ctrl.disableAllFields"> -->
                                                            <!-- <input decode-input-format name="{{ $ctrl.productInfoFields.PortCall.name }}" id="id_{{ $ctrl.productInfoFields.PortCall.name }}" uib-typeahead="portCallLocation as portCallLocation.locationName  for portCallLocation in options.PortCall | typeaheadCustomFilter:$viewValue:'locationName'" typeahead-on-select="" typeahead-editable="true" class="typeahead form-control" ng-model="$ctrl.request.portCall" ng-disabled="$ctrl.disableAllFields" ng-init="$ctrl.setPortCallDefaultView(location)"> -->
                                                            <input decode-input-format name="{{ $ctrl.productInfoFields.PortCall.name+$index }}" id="id_{{ $ctrl.productInfoFields.PortCall.name+$index }}" uib-typeahead="portCallLocation as portCallLocation.locationName  for portCallLocation in options.PortCall | typeaheadCustomFilter:$viewValue:'locationName'" typeahead-on-select="" typeahead-editable="true" class="typeahead form-control" ng-model="portCall[location.location.id]" ng-disabled="$ctrl.disableAllFields || $ctrl.checkProductStemmed(location)" ng-init="$ctrl.setPortCallDefaultView(location.location.id, location)">
                                                            <!-- <input decode-input-format name="{{ "Port Call" }}" id="id_{{ "Port Call" }}" uib-typeahead="portCallLocation as portCallLocation.locationName  for portCallLocation in options.PortCall | typeaheadCustomFilter:$viewValue:'locationName'" typeahead-on-select="" typeahead-editable="true" class="typeahead form-control" ng-model="$ctrl.request.portCall" ng-disabled="$ctrl.disableAllFields"> -->
                                                            <span class="input-group-addon" ng-class="{'disabled' : $ctrl.isReadonlyForm}" data-toggle="modal" ng-click="$ctrl.getVesselSchedules('portCall', location)" href="#port_call_model" ng-disabled="$ctrl.disableAllFields || $ctrl.checkProductStemmed(location)">
                                                                <i class="glyphicon glyphicon-search"></i>
                                                            </span>
                                                        </div>
                                                        <!-- <div class="input-group col-md-8 col-sm-12" ng-if="$ctrl.requestTenantSettings.agentDisplay.name == 'Free text'">
                                                            <input name="{{ $ctrl.productInfoFields.Agent.name }}" id="id_{{ $ctrl.productInfoFields.Agent.name }}" class="typeahead form-control" ng-model="location.agentCounterpartyFreeText" ng-disabled="$ctrl.disableAllFields">
                                                        </div> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4" ng-if="$ctrl.requestTenantSettings.displayOfService.id == 2" ng-init='CM.getOptions({"Name": "Service","masterSource": "Service"})' data-html="true" tooltip data-original-title="{{ $ctrl.serviceTooltip('Port', $index) }}">
                                                <span ng-if="location.service.id" ng-init="$ctrl.selectServiceInLocation(location.service.id, $index); "></span>
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input decode-input-format ng-disabled="$ctrl.disableAllFields" name="Location {{$index+1}} {{$ctrl.tenantSettings.serviceDisplayName.name}}" id="id_{{ $ctrl.vesselDetailsFields.ServiceCode.name }}" placeholder="{{ $ctrl.vesselDetailsFields.ServiceCode.placeholder }}" uib-typeahead="service as service.name for service in options.Service | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectServiceInLocation($item.id, $index)" typeahead-editable="false" class="typeahead form-control" ng-model="location.service.name" required>
                                                            <span ng-disabled="$ctrl.disableAllFields" class="input-group-addon" ng-click="triggerModal('general', 'masters_servicelist', $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate, '$ctrl.location[' + $index + '].service' ,'','',Location + $index+1 + $ctrl.tenantSettings.serviceDisplayName.name)">
                                                                <i class="fa fa-search"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4" ng-if="$ctrl.requestTenantSettings.displayOfCompany.id == 2" ng-init='CM.getOptions({"Name": "Company","masterSource": "Company"})'>
                                                <div class="row">
                                                    <label class="control-label col-md-4">
                                                        {{ $ctrl.tenantSettings.companyDisplayName.name | translate }}
                                                        <span style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <input decode-input-format name="Location {{$index+1}} {{$ctrl.tenantSettings.companyDisplayName.name}}" id="id_{{ $ctrl.vesselDetailsFields.Company.name }}" placeholder="{{ $ctrl.vesselDetailsFields.Company.placeholder }}" uib-typeahead="company as company.name for company in options.Company | typeaheadCustomFilter:$viewValue:'name'" typeahead-on-select="$ctrl.selectCompanyInLocation($item.id, $index)" ng-required="true" typeahead-editable="false" class="typeahead form-control" ng-model="location.company.name" ng-disabled="$ctrl.disableAllFields">

                                                            <span class="input-group-addon" ng-click="triggerModal('general', 'masters_companylist', $ctrl.tenantSettings.serviceDisplayName.name + ' Code' | translate, '$ctrl.location[' + $index + '].company' ,'','',Location + $index+1 + $ctrl.tenantSettings.companyDisplayName.name)" ng-disabled="$ctrl.disableAllFields">
                                                                <i class="fa fa-search"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4" ng-hide="$ctrl.requestTenantSettings.isRequestTerminalHidden"> 
                                                <div class="row">
                                                    <!-- {{location}} -->
                                                    <label class="control-label col-md-4">
                                                        {{ 'PAGES.NEW_REQUEST.TERMINAL' | translate }}  
                                                        <span ng-if="$ctrl.requestTenantSettings.isRequestTerminalMandatory" style=" color: orange;position: absolute;font-size: 9px;margin-left: 2px;"> * </span>
                                                    </label>
                                                    <!-- ng-options="item as item.name for item in CM.listsCache.Uom track by item.id " -->
                                                    <div class="form-group-sm00">
                                                        <div class="input-group col-md-8 col-sm-12">
                                                            <select name ="terminal" ng-options="terminal as terminal.descriptions for terminal in locationTerminal[$index] track by terminal.terminalCode" 
                                                            ng-model="location.terminal"  data-original-title="{{ location.descriptions }}" class="form-control pull-left" ng-required="$ctrl.requestTenantSettings.isRequestTerminalMandatory"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="col-md-12" ng-init="$index1 = $index">
                                <form class="form-horizontal collapse in row" name="forms.productForm[$index]" style="overflow:auto" novalidate autocomplete="off" name="forms.productsForm">
                                    <table class="table table-striped table-hover table-bordered table-condensed st-product-info-table" id="product_info_table_{{ $index + 1 }} new_request_products">
                                        <thead>
                                            <tr>
                                                <th id="generatedThId199">
                                                    &nbsp;
                                                    <span class="st-btn-icon" ng-show="!$ctrl.isReadonlyForm">
                                                        <a id="product_addRow_header" ng-click="$ctrl.addEmptyProduct(location.products, true, locationIdx)" ng-disabled="$ctrl.disableAllFields">
                                                            <i class="fa fa-plus clickable"></i>
                                                        </a>
                                                    </span>
                                                </th>
                                                <th id="generatedThId200"></th>                                                
                                                <th id="generatedThId201" ng-repeat="column in $ctrl.ui.Locations.columns" ng-if="column.visible && column.caption != 'PAGES.NEW_REQUEST.CONTRACT_ID' && $ctrl.tenantSettings.shiptechLite">
                                                    <span>
                                                        <span>{{ column.caption | translate }} </span> 
                                                        <span ng-show="column.caption=='PAGES.NEW_REQUEST.PRODUCT' || column.caption=='PAGES.NEW_REQUEST.PRODUCT_TYPE' || column.caption=='PAGES.NEW_REQUEST.SPEC_GROUP' || column.caption=='PAGES.NEW_REQUEST.MIN_QTY'|| column.caption=='PAGES.NEW_REQUEST.MAX_QTY'"  style=" color: orange;font-size: 9px;margin-left: 2px;">*</span>
                                                    </span>  
                                                </th>
                                                <th id="generatedThId201" ng-repeat="column in $ctrl.ui.Locations.columns" ng-if="column.visible  && !$ctrl.tenantSettings.shiptechLite">
                                                    <span>
                                                        <span>{{ column.caption | translate }} </span> 
                                                        <span ng-show="column.caption=='PAGES.NEW_REQUEST.PRODUCT' || column.caption=='PAGES.NEW_REQUEST.PRODUCT_TYPE' || column.caption=='PAGES.NEW_REQUEST.SPEC_GROUP' || column.caption=='PAGES.NEW_REQUEST.MIN_QTY'|| column.caption=='PAGES.NEW_REQUEST.MAX_QTY'"  style=" color: orange;font-size: 9px;margin-left: 2px;">*</span>
                                                    </span>                                      
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                      
                                            <tr ng-repeat="(productIdx,product) in location.products  " ng-if="!product.isDeleted" ng-mouseover="$ctrl.actveProductUniqueIdUi = product.uniqueIdUI">

                                                <td>
                                                    <span class="st-btn-icon" ng-show="!$ctrl.isReadonlyForm">
                                                        <a id="product_addRow_{{ $index }}" ng-click="$ctrl.addEmptyProduct(location.products, true, locationIdx)" ng-disabled="$ctrl.disableAllFields">
                                                            <i class="fa fa-plus clickable"></i>
                                                        </a>
                                                    </span>
                                                </td>

                                                <td>
                                                    <span class="st-btn-icon" ng-show="product.productStatus.id != $ctrl.STATUS['Cancelled'].id && !$ctrl.isReadonlyForm && $ctrl.canCancelProduct(product)">

                                                        <a id="product_remRow_{{ $index }}" ng-click="$ctrl.deleteProductFromLocation(product, location, productIdx, locationIdx, false)">
                                                            <i class="fa fa-minus clickable"></i>
                                                        </a>
                                                    </span>
                                                </td>

                                                <td ng-if="$ctrl.productInfoColumns.Product.visible" style="width:11%;min-width: 190px;" ng-init="CM.getOptions({'Name': 'Product', 'masterSource': 'Product'})">
                                                    <div class="input-group" tooltip tooltiptrigger="hover" data-original-title="{{ $ctrl.getProductTooltipByProductId(product.product.id) | decodeReadOnly }}">
                                                        <input decode-input-format
                                                               name="{{ $ctrl.productInfoColumns.Product.name }}" id="product_product_{{ $index }}"
                                                               placeholder="{{ $ctrl.productInfoColumns.Product.placeholder }}" class="typeahead form-control"
                                                               uib-typeahead="prod as prod.name for prod in options.Product | typeaheadCustomFilter:$viewValue:'name'"
                                                               typeahead-on-select="$ctrl.selectProduct($item.id); $ctrl.changeScroll($index1)"
                                                               typeahead-append-to="'body'"
                                                               typeahead-editable="false"
                                                               ng-model="product.product"
                                                               ng-disabled="(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) || $ctrl.disableAllFields"
                                                               ng-click="$ctrl.setLookupInput(product); $ctrl.requestProductDataOnChange = {'product':product.uniqueIdUI, 'location': locationIdx} "
                                                               ng-mouseover="$ctrl.actveProductUniqueIdUi = product.uniqueIdUI;">

                                                        <span class="input-group-addon {{(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) ? 'disabled' : ''}}" ng-click="triggerModal('general', 'masters_productlist', '' , '$ctrl.location[' + locationIdx + '].products[' +  productIdx + ']','','', $ctrl.productInfoColumns.Product.name ); $ctrl.requestProductDataOnChange = {'product':product.uniqueIdUI, 'location': locationIdx}" ng-disabled="(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) || $ctrl.disableAllFields" ng-mouseover="$ctrl.actveProductUniqueIdUi = product.uniqueIdUI">
                                                            <i class="fa fa-search"></i>                                                          
                                                        </span>
                                                       
                                                        <span class="input-group-addon {{(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) ? 'disabled' : ''}}" ng-hide="$ctrl.requestTenantSettings.isRequestMinimumQuantityToReachHidden">
                                                            <i class="fa fa-pencil-square-o"  ng-click="openMinQtyToReach(productIdx, $ctrl.request.locations[locationIdx],locationIdx)"></i> 
                                                        </span>
                                                    </div>
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.ProductType.visible" style="width:8%">                         
                                                    <input decode-input-format type="text" name="ProductType" id="product_ProductType_{{ $index }}" class="form-control input-sm" ng-model="product.productType.name" ng-disabled="true">
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.ProductCategory.visible" style="width:11%;min-width: 120px;">
                                                    <select ng-options="productCategory as productCategory.name for productCategory in $ctrl.lists.ProductCategory track by productCategory.id" ng-model="product.productCategory" id="product_productCategory_{{ $index }}" class="form-control" data-original-title="{{ product.productCategory.name }}" ng-disabled="(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) || $ctrl.disableAllFields"></select>                                                   
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.SpecGroup.visible" style="width:11%;min-width: 150px;">
                                                    <select name="Spec Group" ng-options="specGroup as specGroup.name for specGroup in product.specGroups | decodeReadOnly track by specGroup.id" ng-model="product.specGroup" class="form-control pull-left" ng-required="product.product !== null && product.productStatus.name !== 'Cancelled' && $ctrl.specGroupIsRequired" data-original-title="{{ product.specGroup.name }}" style="width: calc(100% - 20px);" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" id="product_specGroup_{{ $index }}"></select>
                                                    <a ng-controller="Controller_Master" ng-click="modalSpecGroupEdit(product, NAV.requestId,  'request')" class="pull-left" style="line-height: 34px;margin-left: 5px;" ng-hide="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed'" tooltip data-original-title="Open Spec group" ng-disabled="$ctrl.disableAllFields">
                                                        <i class="fa fa-file-text font-grey-cascade"></i>
                                                    </a>
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.RobOnArrival.visible" style="max-width: 250px; min-width: 165px">
                                                    <div class="input-group">
                                                        <input style="font-size: 12px;" type="text" format="number:{{ $ctrl.numberPrecision.quantityPrecision }}" name="RobOnArrival" id="product_RobOnArrival_{{ $index }}" class="form-control input-md" ng-model="product.robOnArrival" data-original-title="{{ product.robOnArrival }}" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields">
                                                        <div class="input-group-btn" ng-init="!product.robOnArrivalUom.id ? product.robOnArrivalUom = product.uom : '' ">
                                                            <select style="min-width: 60px; max-width: 60px; font-size: 12px;"
                                                                    ng-options="uomItem as uomItem.name for uomItem in $ctrl.lists.Uom | decodeReadOnly track by uomItem.id" ng-model="product.robOnArrivalUom" class="form-control bs-select pull-right" ng-required="product.product !== null && !$ctrl.requestTenantSettings.isPrerequestEnabled" data-original-title="{{ product.robOnArrivalUom.name }}" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                                                    id="product_robOnArrivalUom_{{ $index }}"></select>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.DeliveryOption.visible" style="width:11%;min-width: 120px;">
                                                    <select ng-options="deliveryOption as deliveryOption.name for deliveryOption in $ctrl.lists.DeliveryOption track by deliveryOption.id" ng-model="product.deliveryOption" id="product_deliveryOption_{{ $index }}" class="form-control" data-original-title="{{ product.deliveryOption.name }}" ng-disabled="(['Inquired', 'Quoted', 'Stemmed', 'Amended', 'Cancelled'].indexOf(product.productStatus.name) != -1) || $ctrl.disableAllFields"></select>
                                                </td>

                                                <td ng-if="$ctrl.productInfoColumns.MinQty.visible" style="width:8%;min-width: 95px;">
                                                    <input type="text" 
                                                        format="number:{{ $ctrl.numberPrecision.quantityPrecision }}" 
                                                        name="MinQuantity_{{$index}}" 
                                                        id="product_MinQuantity_{{$index}}" 
                                                        class="form-control input-sm" 
                                                        ng-model="product.minQuantity" 
                                                        max="{{ product.maxQuantity }}"
                                                        ng-required="$ctrl.requiredQty && (product.productStatus.name != 'Cancelled' && product.productStatus.name != 'Stemmed')" 
                                                        ng-blur="product.minQuantity = $ctrl.validateMinMaxQuantity(product.minQuantity, product.maxQuantity)['minQuantity']; $ctrl.minQtyBlur(product); $ctrl.captureReasonModal(locationIdx, productIdx, 'REQUEST_PRODUCT_MINQTY', 'minQuantity')"
                                                        data-original-title="{{ product.minQuantity }}" 
                                                        ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" >
                                                </td>                                              
                                                <td ng-if="$ctrl.productInfoColumns.MaxQty.visible" style="width:8%;min-width: 95px;">
                                                    <input type="text" 
                                                        format="number:{{ $ctrl.numberPrecision.quantityPrecision }}" 
                                                        name="MaxQuantity_{{$index}}" 
                                                        id="product_MaxQuantity_{{$index}}" 
                                                        class="form-control input-sm" 
                                                        ng-model="product.maxQuantity" 
                                                        ng-required="$ctrl.requiredQty && (product.productStatus.name != 'Cancelled' && product.productStatus.name != 'Stemmed')" 
                                                        ng-min="{{ product.minQuantity }}" 
                                                        data-original-title="{{ product.maxQuantity }}" 
                                                        ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" 
                                                        ng-blur="product.maxQuantity = $ctrl.validateMinMaxQuantity(product.minQuantity, product.maxQuantity)['maxQuantity']; $ctrl.captureReasonModal(locationIdx, productIdx, 'REQUEST_PRODUCT_MAXQTY', 'maxQuantity')" >
                                                 </td>                                            
                                                <td ng-hide="$ctrl.requestTenantSettings.isRequestSuggestedLiftHidden" style="width:8%;min-width: 95px;">
                                                    <input type="text" format="number:{{ $ctrl.numberPrecision.quantityPrecision }}" name="suggestedLift_{{$index}}" id="product_suggestedLift_{{$index}}" class="form-control input-sm" ng-model="product.suggestedLift" data-original-title="{{ product.suggestedLift }}" ng-disabled="true" ng-required="$ctrl.requestTenantSettings.isRequestSuggestedLiftMandatory">
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.Uom.visible" style="width:8%;min-width: 80px;">
                                                    <select ng-options="uomItem as uomItem.name for uomItem in $ctrl.lists.Uom | decodeReadOnly  track by uomItem.id" 
                                                        ng-model="product.uom" 
                                                        class="form-control" 
                                                        ng-required="product.product !== null && !$ctrl.requestTenantSettings.isPrerequestEnabled" 
                                                        data-original-title="{{ product.uom.name }}" 
                                                        ng-change="$ctrl.captureReasonModal(locationIdx, productIdx, 'REQUEST_PRODUCT_UOM', 'uom')" 
                                                        ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                                            id="product_uom_{{ $index }}"></select>
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.AgreementType.visible" style="width:12%">

                                                    <select ng-options="agreementType as agreementType.name for agreementType in $ctrl.lists.AgreementType | decodeReadOnly track by agreementType.id" ng-model="product.agreementType" class="form-control" ng-required="product.product !== null" data-original-title="{{ product.agreementType.name }} " ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" id="product_agreementType_{{ $index }}"></select>
                                                </td>
                                                <td ng-if="!$ctrl.tenantSettings.shiptechLite">
                                                    <a href="/v2/contracts/contract/{{product.contract.contract.id}}/details" target="_blank">{{product.contract.contract.name}}</a>
                                                </td>
                                                <td ng-if="$ctrl.productInfoColumns.Comment.visible" style="width:15%;min-width: 100px;">
                                                    <input decode-input-format type="text" class="form-control input-sm" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" ng-model="product.comments" id="product_comment_{{ $index }}" id="product_productStatus_{{ $index }}">

                                                </td>
                                                <td ng-hide="$ctrl.requestTenantSettings.isRequestPreTestHidden" style="width:8%;min-width: 80px;">
                                                    <!-- <input type="checkbox" class="mt-checkbox" id="preTest" class="form-control input-sm" ng-model="product.preTest" > -->
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <label class="mt-checkbox" style="margin-left: 35px !important">
                                                                <input id="product_preTest"
                                                                       ng-model="product.isPretestRequired" 
                                                                       type="checkbox" ng-required="$ctrl.requestTenantSettings.isRequestPreTestMandatory">
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </td>
<!--                                                 <td ng-if="$ctrl.productInfoColumns.Reason.visible" style="width:35%;min-width: 100px;">
                                                
                                                    <select ng-options="reason as reason.name for reason in $ctrl.lists.Reason | decodeReadOnly track by reason.id" ng-model="product.reason" class="form-control" ng-required="product.product !== null" data-original-title="{{ product.reason.name }} " ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields" id="product_agreementType_{{ $index }}"></select>
                                                </td> -->
                                                <td ng-hide="$ctrl.requestTenantSettings.isRequestExpectedPriceHidden" style="width:8%;min-width: 95px;">
                                                    <input type="text" format="number:{{ $ctrl.numberPrecision.amountPrecision }}" name="expectedPrice_{{$index}}" id="product_expectedPrice_{{$index}}" class="form-control input-sm" ng-model="product.expectedPrice" data-original-title="{{ product.expectedPrice }}" ng-disabled="true" ng-required="$ctrl.requestTenantSettings.isRequestExpectedPriceMandatory">
                                                </td>                                                
                                                <td ng-if="$ctrl.productInfoColumns.ProductStatus.visible" style="width:10%">
                                                    {{ product.productStatus.displayName ? product.productStatus.displayName: product.productStatus.name }}
                                                </td>	
                                                <td style="max-width: 250px; min-width: 165px">
                                                    <div class="input-group">
                                                        <input style="font-size: 12px;" type="text" format="number:{{ $ctrl.numberPrecision.quantityPrecision }}" name="roundVoyageConsumption" id="product_roundVoyageConsumption_{{ $index }}" class="form-control input-md" ng-model="product.roundVoyageConsumption" data-original-title="{{ product.roundVoyageConsumption }}" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields">
                                                        <div class="input-group-btn" ng-init="!product.roundVoyageConsumptionUom.id ? product.roundVoyageConsumptionUom = product.uom : '' ">
                                                            <select style="min-width: 60px; max-width: 60px; font-size: 12px;"
                                                                    ng-options="uomItem as uomItem.name for uomItem in $ctrl.lists.Uom | decodeReadOnly track by uomItem.id" ng-model="product.roundVoyageConsumptionUom" class="form-control bs-select pull-right" ng-required="product.product !== null && !$ctrl.requestTenantSettings.isPrerequestEnabled" data-original-title="{{ product.roundVoyageConsumptionUom.name }}" ng-disabled="product.productStatus.name == 'Cancelled' || product.productStatus.name == 'Stemmed' || $ctrl.disableAllFields"
                                                                    id="product_roundVoyageConsumptionUom_{{ $index }}"></select>
                                                        </div>
                                                    </div>
                                                </td>
																												 
                                            </tr>
                                        </tbody>
                                    </table>
                                    <hr>
                                </form>
                            </div>
                            <!-- <div class="col-md-12" ng-init="$index1 = $index">
                                <span ng-switch-when="minQuantityReachGroup" >
                                    <span ng-include="'pages/new-request/views/minQuantityRequest.html'"></span>
                                </span>
                            </div> -->
                        </span>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>

    <div ng-if="$ctrl.request.hasBestContract">

        <select-contract contracts="$ctrl.contracts" contract-has-product="$ctrl.contractHasProduct" selected-contracts="$ctrl.selectedContracts"></select-contract>
    </div>


    <div class="portlet light" style="background: #eeeeee">
        <div class="portlet-body">
            <div class="row">
                <form class="form-inline st-new-request-form" name="forms.footerForm" novalidate autocomplete="off">

                    <div class="col-md-5">
                        <div class="row">
                            <div class="col-md-6" ng-hide="$ctrl.requestTenantSettings.isRequestForceRequestOnBopsHidden">
                                <!-- ng-if="$ctrl.footerSectionFields.ForceRequestBp.visible"  -->
                                <div class="row">
                                    <div class="form-group-sm00 mt-checkbox ">
                                        <div class="input-group">
                                            <!-- <span ng-if="$ctrl.request.vesselDetails.service.id && $ctrl.lists"></span> -->
                                            <span></span>
                                            <input type="checkbox" ng-model="$ctrl.request.forceRequestBp" ng-required="$ctrl.requestTenantSettings.isRequestForceRequestOnBopsMandatory"/>
                                            <label style="padding-left: 5px !important;" class="control-label ">
                                                <!-- {{ $ctrl.footerSectionFields.ForceRequestBp.caption | translate }} -->
                                                Force Request on BOPS
                                            </label>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6" ng-hide="$ctrl.requestTenantSettings.isRequestSendRequestCancellationEmailHidden">
                                <!-- ng-if="$ctrl.footerSectionFields.SendRequestCancellationEmail.visible"  -->
                                <div class="row">
                                    <div class="form-group-sm00 mt-checkbox mt-checkbox-outline">
                                        <div class="input-group">
                                            <!-- <span ng-if="$ctrl.request.vesselDetails.service.id && $ctrl.lists"></span> -->
                                            <span></span>
                                            <input type="checkbox" ng-model="$ctrl.request.isSendRequestCancellationEmail" ng-required="$ctrl.requestTenantSettings.isRequestSendRequestCancellationEmailMandatory" />
                                            <label style="padding-left: 5px !important;" class="control-label ">
                                                <!-- {{ $ctrl.footerSectionFields.SendRequestCancellationEmail.caption | translate }} -->
                                                Send Request Cancellation Email
                                            </label>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" ng-hide="$ctrl.requestTenantSettings.isRequestAckByOperatorHidden">
                                <!-- ng-if="$ctrl.footerSectionFields.IsOperatorAck.visible"  -->
                                <div class="row">
                                    <div class="form-group-sm00 mt-checkbox mt-checkbox-outline">
                                        <div class="input-group ">
                                            <!-- <span ng-if="$ctrl.request.vesselDetails.service.id && $ctrl.lists"></span> -->
                                            <span></span>
                                            <input type="checkbox" ng-model="$ctrl.request.isOperatorAck" ng-required="$ctrl.requestTenantSettings.isRequestAckByOperatorMandatory"/>
                                            <label style="padding-left: 5px !important;" class="control-label">
                                                <!-- {{ $ctrl.footerSectionFields.IsOperatorAck.caption | translate }} -->
                                                Acknowleged by Operator
                                            </label>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <!-- <div ng-if="$ctrl.footerSectionFields.ValidatedBy.visible" class="col-md-12">
                                <div class="row">
                                    <label class="control-label col-md-4">
                                        Email
                                    </label>

                                    <div class="form-group-sm00">
                                        <div class="input-group col-md-6">
                                            <input  name="{{ $ctrl.footerSectionFields.ValidatedBy.name }}" id="id_{{ $ctrl.footerSectionFields.ValidatedBy.name }}" class="form-control" ng-model="($ctrl.lists.contactEmails | filter:{id: $ctrl.request.footerSection.validatedBy.id})[0].email" ng-disabled="$ctrl.disableAllFields">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                    <div class="col-md-7">
                        <div class="row">
                            <div ng-if="$ctrl.footerSectionFields.Comments.visible" class="col-md-12">
                                <div class="row">
                                    <!-- <div class="col-12" >
                                            <span>  Force Request on BOPS</span>
                                            <label class="mt-checkbox mt-checkbox-outline">
                                                <input name="{{ $ctrl.vesselDetailsFields.Chartered.name }}" id="id_{{ $ctrl.vesselDetailsFields.Chartered.name }}" placeholder="{{ $ctrl.vesselDetailsFields.Chartered.placeholder }}" type="checkbox" ng-checked="($ctrl.lists.VesselOwnership | filter: {id : $ctrl.request.vesselDetails.vesselOwnershipId})[0].name == 'Chartered'" disabled>

                                            </label>

                                    </div> -->
                                    <div class="col-12">
                                        <label class="control-label col-md-2">
                                            {{ $ctrl.footerSectionFields.Comments.caption | translate }}
                                        </label>
                                        <div class="form-group-sm00">
                                            <div class="input-group col-md-10">
                                                <textarea decode-input-format rows="5" class="form-control" name="{{ $ctrl.footerSectionFields.Comments.name }}" id="id_{{ $ctrl.footerSectionFields.Comments.name }}" ng-model="$ctrl.request.footerSection.comments" ng-disabled="$ctrl.disableAllFields"></textarea>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div>

        <div class="row">
            <!-- <clc-table-list id="'request_MinQunatityToReach'" style="max-width: calc(100vw - 50px);padding-left: 15px;" app="'procurement'"  screen="'request_MinQunatityToReach'" controls="'[entries, columns, info, pager]'"></clc-table-list> -->
            <clc-table-list style="max-width: calc(100vw - 50px);padding-left: 15px;" id="'min_quantity_to_reach'" app="'procurement'" screen="'min_quantity_to_reach'" controls="'[entries, columns, info, pager]'"></clc-table-list>
        </div>
    </div>

    <div class="portlet light" ng-if="$ctrl.request">
        <div class="portlet-title">
            <div class="tools">
                <a class="collapse" data-original-title="" title=""></a>
            </div>
            <div class="caption">
                <span class="caption-subject">
                    NOTES
                </span>
            </div>
        </div>
        <div class="portlet-body" ng-controller="Controller_Master as CM">
            <div>
                <div ui-grid="gridOptions.generalNotes" id="grid_generalNotes" class="dataGrid grid_generalNotes">
                    <div class="clearfix"></div>
                </div>
                <span ng-init="initGridDropdowns('generalNotes')"></span>
                <span ng-if="$ctrl.request.requestNotes">
                    <span ng-init="setScope($ctrl.request.requestNotes)"></span>
                </span>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="st-main-content-menu bottom-menu">
            <div class="pull-right buttons">
                <div class="st-new-request-form">
                    <a class="control-label select_from" ng-click="$ctrl.goEmail()"
                       style="{{$ctrl.previewEmailDisabled ? ('opacity:0.5') : '';}}"
                       ng-class="{'disabled' : $ctrl.isReadonlyForm || $ctrl.previewEmailDisabled || $ctrl.disableAllFields}">
                        Email Preview
                        <i class="glyphicon glyphicon-envelope"></i>
                    </a>
                </div>


                <a ng-show="$ctrl.requestTenantSettings.showOperationalReport" ng-class="{'fakeDisabledReport' : !$ctrl.enableReport}" ng-attr-tooltip="{{!$ctrl.enableReport}}" data-original-title="{{!$ctrl.enableReport ? 'Loading reports ...' : null}}" class="btn orange btn-outline" ng-click="$ctrl.enableReport ? $ctrl.goToReport() : ''">
                    Report
                </a>
                <a ng-show="$ctrl.canSave($ctrl.screenActions) && !$ctrl.disableAllFields" class="btn orange btn-outline" ng-click="$ctrl.saveRequest()" ng-class="{'disabled' : $ctrl.buttonsDisabled }">
                    Save
                </a>
                <a class="btn orange btn-outline" ng-click="$ctrl.sendQuestionnaire()" ng-if="$ctrl.canQuestionnaire()> 0">
                    Send Questionnaire
                </a>
                <a class="btn orange btn-outline" ng-click="$ctrl.validatePreRequest()" ng-if="$ctrl.canValidate()> 0">
                    Validate
                </a>
                <a class="btn orange btn-outline" ng-show="$ctrl.request.requestStatus.id == $ctrl.STATUS.PartiallyStemmed.id" ng-click="$ctrl.completeRequest()">
                    Complete Request
                </a>
                <a class="btn orange btn-outline" ng-click="$ctrl.confirmContractSelection()" ng-show="$ctrl.contractHasProduct && $ctrl.canSave($ctrl.screenActions) && $ctrl.checkGoContract() && !$ctrl.selectedContractHasStemmedProduct" ng-class="{'disabled' : $ctrl.buttonsDisabled}">
                    Proceed to order
                </a>
                <a ng-show="$ctrl.canSave($ctrl.screenActions) && $ctrl.hasAction($ctrl.SCREEN_ACTIONS.GOSPOT)" class="btn orange btn-outline" ng-click="$ctrl.goSpot(true)" ng-class="{'disabled' : $ctrl.buttonsDisabled}">
                    Go spot
                </a>
                <div class="btn-group">
                    <a class="btn btn-default dropdown-toggle st-show-buttons" data-toggle="dropdown" aria-expanded="false" ng-class="{'disabled' : $ctrl.extraButtons() || $ctrl.buttonsDisabled}">
                        &hellip;
                    </a>
                    <ul class="dropdown-menu st-extra-buttons" role="menu">

                        <li ng-if="$ctrl.canCancel() > 0">
                            <a ng-if="$ctrl.requestTenantSettings.captureReasonToCancelRequest.id == 1" ng-click="$ctrl.cancelRequest()">
                                Cancel
                            </a>
                            <a ng-if="$ctrl.requestTenantSettings.captureReasonToCancelRequest.id == 2" ng-click="$ctrl.showCancelRequestConfirm()">
                                Cancel
                            </a>
                        </li>
                        <li ng-if="$ctrl.hasAction($ctrl.SCREEN_ACTIONS.COPY) && $ctrl.request.requestStatus.name != 'Cancelled'">
                            <a ng-click="$ctrl.copyRequest()">
                                Copy
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</fieldset>
<lookup-dialog class="modal fade in" id="lookup_dialog" aria-hidden="true" data-width="80%" lookup-type="$ctrl.lookupType" vessel-id="$ctrl.request.vesselId" args="$ctrl.voyageId" on-vessel-select="$ctrl.selectVessel(vessel)" on-company-select="$ctrl.selectCompany(company)" on-location-select="$ctrl.selectPort(location, extraDetails)" on-product-select="$ctrl.selectProduct(product)" on-service-select="$ctrl.selectService(service)" on-buyer-select="$ctrl.selectBuyer(buyer)"></lookup-dialog>
<sellers-dialog class="modal fade in sellers-dialog" id="agents" aria-hidden="true" data-width="90%" seller-types="$ctrl.agentCounterpartyTypeId" on-seller-select="$ctrl.selectAgent(sellerId)"></sellers-dialog>
<vessel-schedule class="modal fade in requestScreen" id="route_schedule" aria-hidden="true" data-width="66%" vessel-id="$ctrl.request.vesselId" on-vessel-schedules-select="$ctrl.selectVesselSchedules(locations)"></vessel-schedule>
<vessel-schedule class="modal fade in requestScreen" id="port_call_model" aria-hidden="true" data-width="66%" vessel-id="$ctrl.request.vesselId" port-call-voyage-id="$ctrl.setSelectedPortCall" on-port-call-select="$ctrl.selectedPortCall(locations)"></vessel-schedule>
<vessel-schedule class="modal fade in requestScreen route_schedule_mintoreach" id="route_schedule_mintoreach" aria-hidden="true" data-width="75%" vessel-id="$ctrl.request.vesselId" on-vessel-schedules-select="$ctrl.selectVesselSchedulesMintoReach(locations)"></vessel-schedule>
<amend-dialog class="modal fade in" id="amend" aria-hidden="true" on-amend="$ctrl.amendRFQ()" on-reload="$ctrl.reloadRequest()"></amend-dialog>
<spec-group-edit class="modal fade in" aria-hidden="true" data-width="66%">
    <span ng-controller="Controller_Master as CM">
        <div id="grid_specGroupParameters" external-scopes="clickHandler" ui-grid-edit ui-grid-row-edit ui-grid-auto-resize class="dataGrid" ui-grid="gridOptions['specGroupParameters']"></div>
    </span>
</spec-group-edit>
<sweet-confirm id="sweetConfirm"
               on-confirmproductdelete="$ctrl.deleteProductFromLocation(product, location, pIndex, locIndex)"
               on-confirmlocationdelete="$ctrl.deleteLocation(location)"
               on-confirmrequestdelete="$ctrl.cancelRequest()"
               on-canbecancelledproductfromlocation="$ctrl.canBeCancelledProductFromLocation(location, productId)"
               on-canbecancelledlocation="$ctrl.canBeCancelledLocation(locationId)"
               on-canbecancelledrequest="$ctrl.sendCancelRequestAction()"
               delete-data-params="$ctrl.deleteDataParams"
               entity-to-delete="$ctrl.entityToDelete"></sweet-confirm>

<confirm-order-dialog class="modal fade in" id="confirm" aria-hidden="true" data-width="90%" confirmation-product-orders=$ctrl.confirmationProductOrders></confirm-order-dialog>
<span ng-include="'pages/new-request/views/captureReasonModal.html'"></span>