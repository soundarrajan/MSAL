<shiptech-wunderbar>
  <div class="row" style="margin: 5px 0;">
    <div class="col-6 d-flex">
      <shiptech-presets-menu-dropdown></shiptech-presets-menu-dropdown>
      <app-filter-preferences
        appAgGridFilterPresets
        groupId="quantityControlmain"
        id="qualityControlModule"
        screenId="Main"
      ></app-filter-preferences>
    </div>
    <div class="col-6">
      <div style="float:right">
        <shiptech-search-box AgGridExternalSearch [placeholder]="'Search something'" class="mr-1"
                             gridId="quantityControlGrid"></shiptech-search-box>
        <button (click)="raiseClaim()" class="ui-button-warning mr-1" label="Raise Caim" pButton type="button"></button>
        <button (click)="verifyVessels()" class="ui-button-success mr-1" label="Verify" pButton type="button"></button>
      </div>
    </div>
  </div>
</shiptech-wunderbar>

<div class="w-100 px-3 py-4" style="background: white;">
  <div class="row mb-2">
    <div class="col-md-6">
      <app-page-size-selector
        (selectedOptionChange)="onPageSizeChange($event)"
        [options]="viewModel.gridViewModel.pageSizeOptions"
        [selectedOption]="viewModel.gridViewModel.pageSize">
      </app-page-size-selector>
    </div>
    <div class="col-md-6">
      <div class="summary" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="5px">
        <div class="summary-item matched">
          <i class="fa fa-check"></i>
          <span class="label">
            Matched:
          </span>
          <span class="value">
            {{(summary$ | async).nbOfMatched}}
          </span>
        </div>

        <div class="summary-item matched-withing-limit">
          <i class="fa fa-check"></i>
          <span class="label">
            Matched within limit:
          </span>
          <span class="value">
            {{(summary$ | async).nbOfMatchedWithinLimit}}
          </span>
        </div>

        <div class="summary-item not-matched">
          <i class="fa fa-times"></i>
          <span class="label">
            Not matched:
          </span>
          <span class="value">
            {{(summary$ | async).nbOfNotMatched}}
          </span>
        </div>

      </div>
    </div>
  </div>

  <ag-grid-angular
    appAgGridFilterPresets
    appAgGridSizeToFit
    AgGridExternalSearch
    [onSearch]="viewModel.gridViewModel.onSearch.bind(viewModel.gridViewModel)"
    groupId="quantityControlmain"
    id="quantityControlGrid"
    class="ag-theme-balham"
    style="height:500px"
    [gridOptions]="viewModel.gridViewModel.gridOptions">
  </ag-grid-angular>

  <div class="row mt-2">
    <div class="col-md-6">
      Showing {{((viewModel.gridViewModel.page - 1) * viewModel.gridViewModel.pageSize) + 1}}
      to {{viewModel.gridViewModel.page * viewModel.gridViewModel.pageSize}} of {{viewModel.gridViewModel.totalItems}} entries
    </div>
    <div class="col-md-6">
      <div style="float:right">
        Page
        <app-ag-paging style="width: 150px;"
                       [pagerLeftArrowIcon]="'fa fa-chevron-left'"
                       [pagerRightArrowIcon]="'fa fa-chevron-right'"
                       [count]="viewModel.gridViewModel.totalItems"
                       [page]="viewModel.gridViewModel.page"
                       [size]="viewModel.gridViewModel.pageSize"
                       [useInputAsPageSelect]="true"
                       (pageChange)="onPageChange($event.page)">
        </app-ag-paging>
        of {{viewModel.gridViewModel.totalItems / viewModel.gridViewModel.pageSize}}
      </div>
    </div>
  </div>
</div>


<ng-template [columnDef]="[viewModel.gridViewModel.callIdCol]" appAgCellTemplate let-data="data" let-value="value">
  <ng-container>
    <a *ngIf="data && data.id" [routerLink]="[reportDetailsRoutePath, data.id]" href="#"> View {{data?.id}} </a>
  </ng-container>
</ng-template>

<ng-template [columnDef]="viewModel.gridViewModel.vesselNameCol" appAgCellTemplate let-data="data" let-value="value">
  <ng-container>
    {{value}}
    <i (click)="watchVesselWithId(data?.id)" *ngIf="data && data.id" class="fa fa-flag vessel-to-watch"></i>
  </ng-container>
</ng-template>
