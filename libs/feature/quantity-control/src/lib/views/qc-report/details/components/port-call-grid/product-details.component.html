<ag-grid-angular
  appAgGridFirstColumnLocked
  appAgGridSizeToFit
  [gridOptions]="viewModel.gridViewModel.gridOptions"
  [rowData]="viewModel.productTypes$ | async"
  class="ag-theme-balham"
  id="quantity-control-product-details-grid"
  style="height:500px">
</ag-grid-angular>


<ng-template [columnDef]="viewModel.gridViewModel.bdnDeliveredQuantityCol"
             appAgCellTemplate
             let-model="data.model" let-value="value">
  <ng-container>
    <div fxLayout="row" fxLayoutAlign="center center">
      <a href="#">{{value | number: viewModel.numberDisplayFormat}}</a>
    </div>
  </ng-container>
</ng-template>

<ng-template [columnDef]="[
              viewModel.gridViewModel.robBeforeDeliveryColGroup,
              viewModel.gridViewModel.robAfterDeliveryColGroup,
              viewModel.gridViewModel.deliveredQuantityColGroup]"
             agGroupHeaderTemplate
             let-groupDef="groupDef" let-title="title">
  <div class="ag-header-group-cell-label p-2" ref="agContainer">
    <div class="row" style="width: 100%">
      <div class="col-6">
        <span class="ag-header-group-text" ref="agLabel">{{ title }}</span>
      </div>
      <div class="col-6">
        <shiptech-uom-selector (selectionChanged)="viewModel.gridViewModel.switchSelectedUom(groupDef.groupId, $event)"
                               [selectedUom]="viewModel.gridViewModel.getSelectedUomValue$(groupDef.groupId) | async"
                               [disabled]="isBusy$ | async"
                               [uoms]="viewModel.uoms$ | async"></shiptech-uom-selector>
      </div>
    </div>
  </div>
</ng-template>


<ng-template [columnDef]="[
              viewModel.gridViewModel.logBookBeforeDeliveryCol,
              viewModel.gridViewModel.measuredRobBeforeDeliveryCol,
              viewModel.gridViewModel.measuredDeliveredQuantityCol,
              viewModel.gridViewModel.logBookAfterDeliveryCol,
              viewModel.gridViewModel.measuredRobAfterDeliveryCol]"
             appAgCellTemplate let-column="column" let-model="data" let-value="value">
    <div fxLayout="row" fxLayoutAlign="center center">
      <p-spinner (ngModelChange)="viewModel.updateProductType(column, model, $event)" [formatInput]="true"
                 [disabled]="isBusy$ | async"
                 [ngModelOptions]="{updateOn: 'blur'}"
                 [ngModel]="value" [step]="0.001" decimalSeparator="."></p-spinner>
    </div>
</ng-template>


<ng-template [columnDef]="[
             viewModel.gridViewModel.differenceDeliveredQuantityCol,
             viewModel.gridViewModel.differenceRobBeforeDeliveryCol,
             viewModel.gridViewModel.differenceRobAfterDeliveryCol]"
             appAgCellTemplate
             let-model="data.model" let-value="value">
  <ng-container>
    <div fxLayout="row" fxLayoutAlign="center center">
      <div class="row">
        <div class="col-6">{{value | number: viewModel.numberDisplayFormat}}</div>
      </div>
    </div>
  </ng-container>
</ng-template>
