
<div class="row col-md-12 create-new-formula-modal-top">
  <div class="col-md-12">
    <a (click)="closeClick()" class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all close-button create-new-formula-close-button" role="button">
      <span class="pi pi-times cl-content"></span>
    </a>
  </div>
  <div class="col-md-12">
    <div style="float: left;" class="header-create-new-formula">
      Pricing Details
    </div>
    <div  style="float: right;">
      <button  type="button" mat-raised-button class="new-formula-button cancel-button">
        Cancel
      </button>  
      <button  type="button" mat-raised-button class="new-formula-button">
        Save
      </button>    
    </div>
  </div>
</div>
<div mat-dialog-content>
  <div class="row d-flex col-md-12">
    <div class="col-md-6 pricing-formula-tab" style="display: flex;justify-content: flex-start;">
      <div class="pricing-formula-tab-header col-md-12">
        <div [ngClass]="{'selected-tab': selectedFormulaTab == 'Pricing formula', 
          'unselected-tab': selectedFormulaTab != 'Pricing formula'}"
          (click)="selectedFormulaTab = 'Pricing formula'; initialized = 1">
          <div class="value">Pricing formula</div>
        </div>
        <div class="border_line"></div>
        <div [ngClass]="{'selected-tab': selectedFormulaTab == 'Pricing schedule', 
          'unselected-tab': selectedFormulaTab != 'Pricing schedule'}"
          (click)="selectedFormulaTab = 'Pricing schedule';  initialized = 2">
          <div class="value">Pricing schedule</div>
        </div>
        <div class="border_line"></div>
        <div [ngClass]="{'selected-tab': selectedFormulaTab == 'Discount rules',
          'unselected-tab': selectedFormulaTab != 'Discount rules'}"
          (click)="selectedFormulaTab = 'Discount rules'">
          <div class="value">Discount rules</div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="custom-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}" style="width: 100% !important;">
        <mat-form-field class="without-search" appearance="legacy">
          <mat-label>Formula Name</mat-label>
          <input matInput
              [(ngModel)]="formValues.name"
              placeholder="Formula Name"
              autocomplete="off">
          </mat-form-field>
      </div>
    </div>
  </div>
  <div class="row d-flex col-md-12" *ngIf="initialized == 1">
    <div class="col-md-12">
      <div class="pricing-type-container">
        <div class="col-md-12 pricing-container">
          <div class="pricing-container-formula-list row col-md-6 no-padding" style="margin-top: 15px;">
            <div class="col-md-12 pricing-container-formula-list-header">
              Pricing Type
            </div>
            <div class="col-md-12">
              <mat-radio-group
              [(ngModel)]="formValues.formulaType.id"
              class="pricing-container-radio-group">
              <mat-radio-button class="pricing-container-radio-button" *ngFor="let option of formulaTypeList" [value]="option.id">
                {{option.name}}
              </mat-radio-button>
            </mat-radio-group>
            </div>
          </div>
          <div class="row" *ngIf="formValues.formulaType && formValues.formulaType.id == 1">
            <div class="col-md-12 formula-description-header">
              Formula description
            </div>
            <div class="col-md-12 d-flex" style="margin-top: 15px;">
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <div class="d-flex">
                  <mat-form-field class="with-search" appearance="legacy">
                    <mat-label>System instument</mat-label>
                    <input class="free-text-field" 
                            type="text"
                            matInput 
                            [(ngModel)]="formValues.simpleFormula.systemInstrument"
                            [matAutocomplete]="auto"
                            placeholder="System instument">
                    <mat-autocomplete #auto="matAutocomplete" 
                                      class="darkPanelAuto"
                                      [displayWith]="displayFn"
                                      (optionSelected)="selectSystemInstrument($event)">
                        <mat-option *ngFor="let option of filterSystemInstrumenttList()" 
                              [value]="option">
                            {{option.name}}
                        </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                  <button 
                        class="search-icon" appMasterSelectorTrigger [masterSelector]="masterSelector" #masterSelectorTrigger="masterSelectorTrigger" [header]="getHeaderNameSelector()">
                    <div class="img">
                      <ng-template cdkPortal #masterSelector="cdkPortal" >
                        <shiptech-shared-master-selector (selectedChange)="selectorSystemInstumentSelectionChange($event); masterSelectorTrigger.close()" (shouldCloseModal)="masterSelectorTrigger.close()" [selectorType]="autocompleteSystemInstrument"
                                                      [disabled]="disabled"
                                                      [entityName]="entityName"
                                                      [headerName]="getHeaderNameSelector()"
                        ></shiptech-shared-master-selector>
                      </ng-template> 
                    </div>
                  </button>
                </div>
              </div>
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Price Type</mat-label>
                  <mat-select 
                            [(ngModel)]="formValues.simpleFormula.priceType"
                            [disableOptionCentering]="true"
                            panelClass="general-information-select-container"
                            [compareWith]="compareUomObjects"
                            placeholder="Price Type">
                      <mat-option *ngFor="let option of marketPriceList" [value]="option">
                          {{option.name}}
                      </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Premium/Discount</mat-label>
                  <mat-select 
                            [(ngModel)]="formValues.simpleFormula.plusMinus"
                            [disableOptionCentering]="true"
                            panelClass="general-information-select-container"
                            [compareWith]="compareUomObjects"
                            placeholder="Premium/Discount">
                      <mat-option *ngFor="let option of formulaPlusMinusList" [value]="option">
                          {{option.name}}
                      </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Amount</mat-label>
                  <input matInput
                      [(ngModel)]="formValues.simpleFormula.amount"
                      placeholder="Amount"
                      autocomplete="off"
                      required
                      amountFormat
                      [disabled]= "formValues.simpleFormula.plusMinus.id == 3">
                  </mat-form-field>
              </div>
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Flat/percentage</mat-label>
                  <mat-select 
                            [(ngModel)]="formValues.simpleFormula.flatPercentage"
                            [disableOptionCentering]="true"
                            panelClass="general-information-select-container"
                            [compareWith]="compareUomObjects"
                            placeholder="Flat/percentage"
                            [disabled]= "formValues.simpleFormula.plusMinus.id == 3">
                      <mat-option *ngFor="let option of formulaFlatPercentageList" [value]="option">
                          {{option.name}}
                      </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Uom</mat-label>
                  <mat-select 
                            [(ngModel)]="formValues.simpleFormula.uom"
                            [disableOptionCentering]="true"
                            panelClass="general-information-select-container"
                            [compareWith]="compareUomObjects"
                            placeholder="Uom"
                            [disabled]= "formValues.simpleFormula.plusMinus.id == 3">
                      <mat-option *ngFor="let option of uomList" [value]="option">
                          {{option.name}}
                      </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
            <div style="margin-top: 15px" class="col-md-12" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
              <mat-form-field appearance="outline" class="custom-form-field-comments">
                  <mat-label>Comments</mat-label>
                  <textarea  
                      [(ngModel)]="formValues.comments"
                      matInput
                      autocomplete="off"
                      ></textarea>
              </mat-form-field>
            </div>
          </div>
          <div class="row" *ngIf="formValues.formulaType && formValues.formulaType.id == 2">
            <div class="col-md-12 formula-description-header">
              Formula description
            </div>
            <div class="col-md-12 d-flex" style="margin-top: 15px;">
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <div class="d-flex">
                  <mat-form-field class="with-search" appearance="legacy">
                    <mat-label>Currency</mat-label>
                    <input class="free-text-field" 
                            type="text"
                            matInput 
                            [(ngModel)]="formValues.currency"
                            [matAutocomplete]="auto"
                            placeholder="Currency">
                    <mat-autocomplete #auto="matAutocomplete" 
                                      class="darkPanelAuto"
                                      [displayWith]="displayFn"
                                      (optionSelected)="selectCurrency($event)">
                        <mat-option *ngFor="let option of filterCurrencyList()" 
                              [value]="option">
                            {{option.name}}
                        </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                  <button 
                        class="search-icon" appMasterSelectorTrigger [masterSelector]="masterSelector1" #masterSelectorTrigger1="masterSelectorTrigger" [header]="getHeaderNameSelector1()">
                    <div class="img">
                      <ng-template cdkPortal #masterSelector1="cdkPortal" >
                        <shiptech-shared-master-selector (selectedChange)="selectorCurrencySelectionChange($event); masterSelectorTrigger1.close()" (shouldCloseModal)="masterSelectorTrigger1.close()" [selectorType]="autocompleteCurrency"
                                                      [disabled]="disabled"
                                                      [entityName]="entityName"
                                                      [headerName]="getHeaderNameSelector1()"
                        ></shiptech-shared-master-selector>
                      </ng-template> 
                    </div>
                  </button>
                </div>
              </div>
              <mat-checkbox
                [(ngModel)]="formValues.isMean"
                (change)="isMeanChange($event)">Apply mean for entire table</mat-checkbox>
            </div>
            <div class="col-md-12">
              <table class="complex-formula-quote-lines table table-stripped table-hover" style="width:100%">
                <thead>
                  <tr>
                    <td class="padding" style="width: 30px;">
                      <a class="add-new-quote-line-icon"  (click)="addComplexFormulaQuoteLine()"></a>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Operation</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Weight</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Function</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Instument1</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Price type</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Instument2</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Price type</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Instument3</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Price type</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>+/-</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Amount</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Flat%</b>
                    </td>
                    <td class="padding" style="width:10%">
                      <b>Uom</b>
                    </td>
                  </tr>
                </thead>
                <tbody>
                    <ng-container  *ngFor="let complexFormulaQuoteLine of formValues.complexFormulaQuoteLines | keyvalue : originalOrder">
                      <tr *ngIf="!complexFormulaQuoteLine.value.isDeleted">
                        <td class="padding" style="width: 30px;">
                          <a class="remove-new-quote-line-icon" (click)="removeComplexFormulaQuoteLine(complexFormulaQuoteLine.key)" style="left: 10px;"></a>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.formulaOperation.id"
                                      (ngModelChange)="setFormulaOperation($event, complexFormulaQuoteLine.key)"
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [disabled]="formValues.isMean"
                                      >
                                  <mat-option *ngFor="let option of formulaOperationList" [value]="option.id">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td> 
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search" appearance="legacy">
                              <input 
                                  [(ngModel)]="complexFormulaQuoteLine.value.weight"
                                  [disabled]="formValues.isMean" 
                                  matInput 
                                  autocomplete="off">
                            </mat-form-field>
                          </div>
                        </td> 
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.formulaFunction" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of formulaFunctionList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td> 
                        <td style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search" appearance="legacy">
                              <input class="free-text-field" 
                                      type="text"
                                      matInput 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[0].systemInstrument"
                                      [matAutocomplete]="auto">
                              <mat-autocomplete #auto="matAutocomplete" 
                                                class="darkPanelAuto"
                                                [displayWith]="displayFn"
                                                (optionSelected)="selectSystemInstrumentFromComplexFormulaQuoteLine($event.option.value, complexFormulaQuoteLine.key, 0)">
                                  <mat-option *ngFor="let option of filterSystemInstrumentListFromComplexFormulaQuoteLine(complexFormulaQuoteLine.value.systemInstruments[0].systemInstrument && complexFormulaQuoteLine.value.systemInstruments[0].systemInstrument.name ? complexFormulaQuoteLine.value.systemInstruments[0].systemInstrument.name : complexFormulaQuoteLine.value.systemInstruments[0].systemInstrument)" 
                                        [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[0].marketPriceTypeId" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of marketPriceTypeList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td> 
                        <td style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search" appearance="legacy">
                              <input class="free-text-field" 
                                      type="text"
                                      matInput 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[1].systemInstrument"
                                      [matAutocomplete]="auto1">
                              <mat-autocomplete #auto1="matAutocomplete" 
                                                class="darkPanelAuto"
                                                [displayWith]="displayFn"
                                                (optionSelected)="selectSystemInstrumentFromComplexFormulaQuoteLine($event.option.value, complexFormulaQuoteLine.key, 1)">
                                  <mat-option *ngFor="let option of filterSystemInstrumentListFromComplexFormulaQuoteLine(complexFormulaQuoteLine.value.systemInstruments[1].systemInstrument && complexFormulaQuoteLine.value.systemInstruments[1].systemInstrument.name ? complexFormulaQuoteLine.value.systemInstruments[1].systemInstrument.name : complexFormulaQuoteLine.value.systemInstruments[1].systemInstrument)" 
                                        [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[1].marketPriceTypeId" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of marketPriceTypeList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td> 
                        <td style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search" appearance="legacy">
                              <input class="free-text-field" 
                                      type="text"
                                      matInput 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[2].systemInstrument"
                                      [matAutocomplete]="auto2">
                              <mat-autocomplete #auto2="matAutocomplete" 
                                                class="darkPanelAuto"
                                                [displayWith]="displayFn"
                                                (optionSelected)="selectSystemInstrumentFromComplexFormulaQuoteLine($event.option.value, complexFormulaQuoteLine.key, 2)">
                                  <mat-option *ngFor="let option of filterSystemInstrumentListFromComplexFormulaQuoteLine(complexFormulaQuoteLine.value.systemInstruments[2].systemInstrument && complexFormulaQuoteLine.value.systemInstruments[2].systemInstrument.name ? complexFormulaQuoteLine.value.systemInstruments[2].systemInstrument.name : complexFormulaQuoteLine.value.systemInstruments[2].systemInstrument)" 
                                        [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.systemInstruments[2].marketPriceTypeId" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of marketPriceTypeList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.formulaPlusMinus" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of formulaPlusMinusList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search" appearance="legacy">
                              <input 
                                  [(ngModel)]="complexFormulaQuoteLine.value.amount" 
                                  matInput 
                                  autocomplete="off"
                                  amountFormat>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.formulaFlatPercentage" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of formulaFlatPercentageList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td>
                        <td  style="width:10%">
                          <div class="custom-form-field complex-formula-quote-info" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                            <mat-form-field class="without-search complex-formula-quote-dropdown-component" appearance="legacy">
                              <mat-select 
                                      [(ngModel)]="complexFormulaQuoteLine.value.uom" 
                                      [disableOptionCentering]="true"
                                      panelClass="general-information-select-container"
                                      [compareWith]="compareUomObjects">
                                  <mat-option *ngFor="let option of uomList" [value]="option">
                                      {{option.name}}
                                  </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </td>
                      </tr>
                    </ng-container>
                </tbody>
              </table>
            </div>
            <div style="margin-top: 15px" class="col-md-12" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
              <mat-form-field appearance="outline" class="custom-form-field-comments">
                  <mat-label>Comments</mat-label>
                  <textarea  
                      [(ngModel)]="formValues.comments"
                      matInput
                      autocomplete="off"
                      ></textarea>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row d-flex col-md-12" *ngIf="initialized == 2">
    <div class="col-md-12">
      <div class="pricing-type-container">
        <div class="col-md-12 pricing-container">
          <div class="pricing-container-formula-list row col-md-10 no-padding" style="margin-top: 15px;">
            <div class="col-md-12 pricing-container-formula-list-header">
              Event Type
            </div>
            <div class="col-md-12">
              <mat-radio-group
              [(ngModel)]="formValues.pricingSchedule.id"
              (ngModelChange)="clearSchedules()"
              class="pricing-container-radio-group">
              <mat-radio-button class="pricing-container-radio-button" *ngFor="let option of pricingScheduleList" [value]="option.id">
                {{option.name}}
              </mat-radio-button>
            </mat-radio-group>
            </div>
          </div>
          <div class="row" *ngIf="formValues.pricingSchedule && formValues.pricingSchedule.id == 4">
            <div class="col-md-12 formula-description-header">
              Formula definition
            </div>
            <div class="col-md-12 d-flex" style="margin-top: 15px;">
              <div class="custom-form-field create-new-formula-form-field" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}" style="width: 50%  !important;">
                <mat-form-field class="without-search" appearance="legacy">
                  <mat-label>Description</mat-label>
                  <input matInput
                      [(ngModel)]="formValues.pricingScheduleOptionDateRange.name"
                      placeholder="Description"
                      autocomplete="off">
                  </mat-form-field>
              </div>
              <div class="custom-form-field create-new-formula-form-field" 
                 [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                  <mat-form-field class="without-search" 
                      appearance="legacy"
                      [ngClass]="{'date-invalid': isValidFromDateInvalid , 'date-valid': !isValidFromDateInvalid}">
                    <mat-label>From Date</mat-label>
                    <input [(ngModel)]="formValues.pricingScheduleOptionDateRange.from" 
                          #fromDateField="ngModel" 
                          matInput 
                          [matDatepicker]="from"
                          (focus)="from.open()"
                          autocomplete="off"
                          placeholder="From Date"
                          (dateInput)="onChange($event, 'from')"
                          (dateChange)="formValues.pricingScheduleOptionDateRange.from = formatDateForBe(formValues.pricingScheduleOptionDateRange.from )"
                          required>
                          <mat-datepicker-toggle matSuffix [for]="from">
                            <mat-icon matDatepickerToggleIcon class="icon-date">
                            </mat-icon>
                        </mat-datepicker-toggle>
                        <mat-datepicker #from [panelClass]="switchTheme?'datepicker-darktheme':''"></mat-datepicker>
                  </mat-form-field>
               </div>
               <div class="custom-form-field create-new-formula-form-field" 
               [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
                <mat-form-field class="without-search" 
                    appearance="legacy"
                    [ngClass]="{'date-invalid': isValidToDateInvalid , 'date-valid': !isValidToDateInvalid}">
                  <mat-label>To Date</mat-label>
                  <input [(ngModel)]="formValues.pricingScheduleOptionDateRange.to" 
                        #toDateField="ngModel" 
                        matInput 
                        [matDatepicker]="to"
                        (focus)="to.open()"
                        autocomplete="off"
                        placeholder="To Date"
                        (dateInput)="onChange($event, 'to')"
                        (dateChange)="formValues.pricingScheduleOptionDateRange.to = formatDateForBe(formValues.pricingScheduleOptionDateRange.to )"
                        required>
                        <mat-datepicker-toggle matSuffix [for]="to">
                          <mat-icon matDatepickerToggleIcon class="icon-date">
                          </mat-icon>
                      </mat-datepicker-toggle>
                      <mat-datepicker #to [panelClass]="switchTheme?'datepicker-darktheme':''"></mat-datepicker>
                </mat-form-field>
             </div>
            </div>
            <div class="col-md-12 formula-description-header d-flex" style="margin-top: 15px;">
              <div class="title">
                Calendar option and holiday rules
              </div>
              <div class="border_line"></div>
              <div class="checkbox">
                <mat-checkbox
                [(ngModel)]="formValues.pricingScheduleOptionDateRange.allowsPricingOnHoliday">
                Allow Pricing on Holidays</mat-checkbox>
              </div>
            </div>
            <div class="col-md-12 d-flex" style="margin-top: 15px;">
              <table class="calendar-option-table table table-stripped table-hover" style="width:100%">
                <thead>
                  <tr>
                      <td class="padding" style="width:25%">
                        <b>Day of work</b>
                      </td>
                      <td class="padding" style="width:25%">
                        <b>Ignore</b>
                      </td>
                      <td class="padding" style="width:25%">
                        <b>Next</b>
                      </td>
                      <td class="padding" style="width:25%">
                        <b>Previous</b>
                      </td>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Sunday
                        {{formValues.pricingScheduleOptionDateRange.sundayHolidayRule ? formValues.pricingScheduleOptionDateRange.sundayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.sundayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.sundayHolidayRule && formValues.pricingScheduleOptionDateRange.sundayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.sundayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.sundayHolidayRule && formValues.pricingScheduleOptionDateRange.sundayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.sundayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.sundayHolidayRule && formValues.pricingScheduleOptionDateRange.sundayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Monday
                        {{formValues.pricingScheduleOptionDateRange.mondayHolidayRule ? formValues.pricingScheduleOptionDateRange.mondayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.mondayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.mondayHolidayRule && formValues.pricingScheduleOptionDateRange.mondayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.mondayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.mondayHolidayRule && formValues.pricingScheduleOptionDateRange.mondayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.mondayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.mondayHolidayRule && formValues.pricingScheduleOptionDateRange.mondayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Tuesday
                        {{formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule ? formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule && formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule && formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule && formValues.pricingScheduleOptionDateRange.tuesdayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Wednesday
                        {{formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule ? formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule && formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule && formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule && formValues.pricingScheduleOptionDateRange.wednesdayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Thursday
                        {{formValues.pricingScheduleOptionDateRange.thursdayHolidayRule ? formValues.pricingScheduleOptionDateRange.thursdayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.thursdayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.thursdayHolidayRule && formValues.pricingScheduleOptionDateRange.thursdayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.thursdayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.thursdayHolidayRule && formValues.pricingScheduleOptionDateRange.thursdayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.thursdayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.thursdayHolidayRule && formValues.pricingScheduleOptionDateRange.thursdayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Friday
                        {{formValues.pricingScheduleOptionDateRange.fridayHolidayRule ? formValues.pricingScheduleOptionDateRange.fridayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.fridayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.fridayHolidayRule && formValues.pricingScheduleOptionDateRange.fridayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.fridayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.fridayHolidayRule && formValues.pricingScheduleOptionDateRange.fridayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.fridayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.fridayHolidayRule && formValues.pricingScheduleOptionDateRange.fridayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                    <tr>
                      <td class="padding-left"  style="width:25%">
                        Saturday
                        {{formValues.pricingScheduleOptionDateRange.saturdayHolidayRule ? formValues.pricingScheduleOptionDateRange.saturdayHolidayRule.id : ''}}
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.saturdayHolidayRule, 1, 'Ignore')"
                          [checked]="formValues.pricingScheduleOptionDateRange.saturdayHolidayRule && formValues.pricingScheduleOptionDateRange.saturdayHolidayRule.id == 1">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.saturdayHolidayRule, 3, 'Next')"
                          [checked]="formValues.pricingScheduleOptionDateRange.saturdayHolidayRule && formValues.pricingScheduleOptionDateRange.saturdayHolidayRule.id == 3">
                        </mat-checkbox>
                      </td>
                      <td class="padding-left"  style="width:25%">
                        <mat-checkbox
                          (change)="calendarOptionChange($event, formValues.pricingScheduleOptionDateRange.saturdayHolidayRule, 2, 'Previous')"
                          [checked]="formValues.pricingScheduleOptionDateRange.saturdayHolidayRule && formValues.pricingScheduleOptionDateRange.saturdayHolidayRule.id == 2">
                        </mat-checkbox>
                      </td>
                    </tr>
                </tbody>
              </table>
            </div>
            <div style="margin-top: 15px" class="col-md-12" [ngClass]="{'darkTheme':switchTheme,'lightTheme':!switchTheme}">
              <mat-form-field appearance="outline" class="custom-form-field-comments">
                  <mat-label>Comments</mat-label>
                  <textarea  
                      [(ngModel)]="formValues.comments"
                      matInput
                      autocomplete="off"
                      ></textarea>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div> 
    </div>
  </div>
</div>

<div mat-dialog-actions style="display: none;">
  <button mat-button [mat-dialog-close]="data.email" cdkFocusInitial>Yes</button>
</div>
 
<ngx-spinner
  bdColor="rgba(51,51,51,0.8)"
  size="medium"
  color="#fff"
  type="ball-spin-clockwise-fade">
</ngx-spinner>
