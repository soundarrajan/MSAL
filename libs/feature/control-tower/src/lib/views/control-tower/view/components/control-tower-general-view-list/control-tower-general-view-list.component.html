<div class="header-content">
  <div *ngIf="!newScreen" class="title">
    <div class="head">{{ gridTitle }}</div>
  </div>
  <div class="filters">
    <div
      class="by-datePicker"
      [ngClass]="{
        new: newScreen,
        'rob-diff':
          selectorType === 'Quantity ROB Difference' ||
          selectorType === 'Quantity Supply Difference'
      }"
    >
      <div
        id="custom-form-field"
        [ngClass]="{ darkTheme: switchTheme, lightTheme: !switchTheme }"
      >
        <mat-form-field class="without-search datePicker" appearance="legacy">
          <mat-datepicker-toggle matSuffix [for]="from">
            <mat-icon matDatepickerToggleIcon class="mini-dateIcon"> </mat-icon>
          </mat-datepicker-toggle>
          <span class="from">From</span>
          <input
            matInput
            [matDatepicker]="from"
            [formControl]="gridViewModel.fromDate"
            (dateChange)="
              gridViewModel.fromDate.setValue(
                formatDateForBe(gridViewModel.fromDate.value)
              );
              gridViewModel.filterByDate(
                gridViewModel.fromDate.value,
                gridViewModel.toDate.value
              )
            "
            (focus)="from.open()"
          />
          <mat-datepicker
            #from
            [panelClass]="switchTheme ? 'datepicker-darktheme' : ''"
          ></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="today">
        <span>-</span>
      </div>
      <div
        id="custom-form-field"
        [ngClass]="{ darkTheme: switchTheme, lightTheme: !switchTheme }"
      >
        <mat-form-field class="without-search datePicker" appearance="legacy">
          <mat-datepicker-toggle matSuffix [for]="to">
            <mat-icon matDatepickerToggleIcon class="mini-dateIcon"> </mat-icon>
          </mat-datepicker-toggle>
          <span class="from">To</span>
          <input
            matInput
            [matDatepicker]="to"
            [formControl]="gridViewModel.toDate"
            (focus)="to.open()"
            (dateChange)="
              gridViewModel.toDate.setValue(
                formatDateForBe(gridViewModel.toDate.value)
              );
              gridViewModel.filterByDate(
                gridViewModel.fromDate.value,
                gridViewModel.toDate.value
              )
            "
          />
          <mat-datepicker
            #to
            [panelClass]="switchTheme ? 'datepicker-darktheme' : ''"
          ></mat-datepicker>
        </mat-form-field>
      </div>
    </div>
    <div
      class="by-action"
      *ngIf="
        selectorType == 'Quantity ROB Difference' ||
        selectorType == 'Quantity Supply Difference'
      "
    >
      <span class="filter-by" *ngIf="newScreen">Filter By:</span>
      <div
        class="action"
        [ngClass]="!gridViewModel.toggleNewFilter ? 'selected-blue' : ''"
        (click)="gridViewModel.filterGridNew('New')"
      >
        <span>New</span>
        <div class="count">{{ gridViewModel.noOfNew }}</div>
      </div>
      <div
        class="action"
        [ngClass]="!gridViewModel.toggleMASFilter ? 'selected-amber' : ''"
        (click)="gridViewModel.filterGridMAS('MarkedAsSeen')"
      >
        <span>Marked as seen</span>
        <div class="count">{{ gridViewModel.noOfMarkedAsSeen }}</div>
      </div>
      <div
        class="action"
        [ngClass]="!gridViewModel.toggleResolvedFilter ? 'selected-green' : ''"
        (click)="gridViewModel.filterGridResolved('Resolved')"
      >
        <span>Resolved</span>
        <div class="count">{{ gridViewModel.noOfResolved }}</div>
      </div>
    </div>
    <div
      class="by-action"
      *ngIf="
        selectorType == 'Quantity Claims' || selectorType == 'Quality Claims'
      "
    >
      <span class="filter-by" *ngIf="newScreen">Filter By:</span>
      <div
        class="action"
        [ngClass]="!gridViewModel.toggleNewFilter ? 'selected-blue' : ''"
        (click)="gridViewModel.filterGridNew('New')"
      >
        <span>New</span>
        <div class="count">{{ gridViewModel.noOfNew }}</div>
      </div>
      <div
        class="action"
        [ngClass]="!gridViewModel.toggle714DaysFilter ? 'selected-amber' : ''"
        (click)="gridViewModel.filterGrid714Days('7-14 Days')"
      >
        <span>7-14 Days</span>
        <div class="count">{{ gridViewModel.noOf714 }}</div>
      </div>
      <div
        class="action"
        [ngClass]="
          !gridViewModel.toggleGreaterThan15DaysFilter ? 'selected-red' : ''
        "
        (click)="gridViewModel.filterGridGreaterThan15Days('15+ Days')"
      >
        <span>15+ Days</span>
        <div class="count">{{ gridViewModel.noOf15 }}</div>
      </div>
    </div>
  </div>
</div>
<div class="grid-container" *ngIf="groupId && gridId">
  <div class="agGrid-v2" style="margin: 0">
    <div style="width:100%;height: 100%;">
      <shiptech-wunderbar>
        <div class="row" style="margin: 5px 0;">
          <div class="col-12 d-flex">
            <shiptech-presets-menu-dropdown></shiptech-presets-menu-dropdown>
            <app-filter-preferences
              appAgGridFilterPresets
              [groupId]="groupId"
              [id]="gridId"
              [gridId]="gridId"
              [gridIds]="gridIds"
              (presetsLoaded)="
                this.gridViewModel.markServerSideDataSourceReady()
              "
            ></app-filter-preferences>
          </div>
        </div>
      </shiptech-wunderbar>

      <p-messages></p-messages>

      <div class="w-100 px-3 py-4  m-r-5 m-b-7" style="background: white;">
        <div class="row mb-2">
          <div class="col-12 d-flex p-t-4">
            <app-ag-filter-display
              [grid]="agGridAngular"
            ></app-ag-filter-display>
          </div>
        </div>

        <ag-grid-angular
          #agGridAngular
          appAgGridFirstColumnLocked
          appAgGridFilterPresets
          appAgGridSizeToFit
          appAgGridClearAllFilters
          appAgGridEmptyFilterOption
          [groupId]="groupId"
          [id]="gridId"
          domLayout="normal"
          class="ag-theme-material ag-grid-v2 angular-v9 prod-details"
          style="height:calc( 100vh - 352px );"
          [gridOptions]="gridViewModel.gridOptions"
          (rowClicked)="onrowClicked($event)"
        >
        </ag-grid-angular>

        <div class="footer">
          <app-ag-footer-new
            [gridViewModel]="gridViewModel"
            [page]="gridViewModel.page"
            [size]="gridViewModel.pageSize"
            [count]="gridViewModel.totalItems"
            [singleGrid]="true"
            [doublePagination]="true"
            [maxSize]="765"
            id="{{ gridId }}"
            [serverKeys]="controlTowerListServerKeys"
            (pageChange)="onPageChange($event.page)"
          >
          </app-ag-footer-new>
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template
  *ngIf="gridViewModel.portCallCol"
  [columnDef]="[gridViewModel.portCallCol]"
  appAgCellTemplate
  let-data="data"
  let-value="value"
>
  <a
    *ngIf="data && data?.quantityControlReport?.id"
    (click)="openEditQuantityControlReport(data?.quantityControlReport?.id)"
    >{{ data?.portCall?.portCallId }}</a
  >
</ng-template>

<!-- <ng-template
  *ngIf="gridViewModel.orderNoCol"
  [columnDef]="[gridViewModel.orderNoCol]"
  appAgCellTemplate
  let-data="data"
  let-value="value"
>
  <a *ngIf="value && value?.id" (click)="openEditOrder(value.id)">{{
    value?.id
  }}</a>
</ng-template>

<ng-template
  *ngIf="gridViewModel.labIdCol"
  [columnDef]="[gridViewModel.labIdCol]"
  appAgCellTemplate
  let-data="data"
  let-value="value"
>
  <a *ngIf="value && value?.id" (click)="openEditLab(value.id)">{{
    value?.id
  }}</a>
</ng-template>

<ng-template
  *ngIf="gridViewModel.claimNoCol"
  [columnDef]="[gridViewModel.claimNoCol]"
  appAgCellTemplate
  let-data="data"
  let-value="value"
>
  <a *ngIf="value" (click)="openEditClaim(value)">{{ value }}</a>
</ng-template> -->
