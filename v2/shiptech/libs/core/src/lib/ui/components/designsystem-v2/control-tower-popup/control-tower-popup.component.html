<div class="statusChange">
  <div class="header">
    <div class="title">{{ data.title }}</div>
    <!-- <div class="id"><span> </span><b></b></div> -->

    <div class="header-right">
      <button mat-raised-button (click)="statusChanged()">Save</button>
      <div class="title-divider">|</div>
      <div class="close-circle">
        <mat-icon
          id="dialogCloseButton"
          matSuffix
          class=""
          (click)="closeDialog()"
          style="font-size: 14px; display: inline; position:relative; top:-1px; "
          >close</mat-icon
        >
      </div>
    </div>
  </div>
  <div class="more-info row">
    <div class="header-title mg-b-5  plr-0 col-6 ">Main info:</div>
    <div class="header-title text-right mg-b-5 plr-0 col-6 ">
      <!-- <span>Claim ID:</span>
        <span class="aggridlink-darktheme">CLM 1466</span> -->
    </div>
    <div class="header-title mg-t-5 plr-0 col-6 ">
      <span class="subheader-field">Vessel:</span>
      <span class="subheader-value">{{ data.vessel }}</span>
    </div>
    <div class="col-6 header-title mg-t-5 plr-0 text-right ">
      <span class="subheader-field">Port:</span>
      <span class="subheader-value">{{ data.port }}</span>
    </div>
  </div>
  <div class="more-info mg-b-0 ">
    <div class="row info-section">
      <div
        class=" w-20p plr-0"
        *ngIf="data.popupType == 'rob' || data.popupType == 'supply'"
      >
        <div class="col-header">Product Type</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{ value.productType }}
        </div>
      </div>
      <div class=" w-20p plr-0" *ngIf="data.popupType == 'sludge'">
        <div class="col-header">Sludge %</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{ format.quantity(value.sludgePercentage) }}
        </div>
      </div>
      <div
        class="w-24p plr-0"
        *ngIf="data.popupType == 'rob' || data.popupType == 'sludge'"
      >
        <div class="col-header">Log Book ROB</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{ format.quantity(value.logBookRobQtyBeforeDelivery) }}
        </div>
      </div>
      <div class="w-24p plr-0" *ngIf="data.popupType == 'supply'">
        <div class="col-header">BDN Quantity</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{ format.quantity(value.bdnQuantity) }}
        </div>
      </div>
      <div class=" w-24p plr-0">
        <div class="col-header">{{ data.measuredQuantityLabel }}</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{
            data.popupType == 'rob' || data.popupType == 'sludge'
              ? format.quantity(value.measuredRobQtyBeforeDelivery)
              : format.quantity(value.measuredQuantity)
          }}
        </div>
      </div>
      <div class=" w-20p plr-0">
        <div class="col-header">{{ data.differenceQuantityLabel }}</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{
            data.popupType == 'rob' || data.popupType == 'sludge'
              ? format.quantity(value.differenceInRobQuantity)
              : format.quantity(value.differenceQuantity)
          }}
        </div>
      </div>
      <div class=" w-10p plr-0">
        <div class="col-header">UOM</div>
        <div *ngFor="let value of data.productTypeList" class="col-value">
          {{ value.uom }}
        </div>
      </div>
    </div>
  </div>

  <div class="action-status">
    <div class="header-title">Action Status</div>
    <div
      id="custom-form-field"
      [ngClass]="{ darkTheme: switchTheme, lightTheme: !switchTheme }"
    >
      <mat-form-field class="without-search" appearance="none">
        <mat-label>Select Field</mat-label>
        <mat-select
          disableOptionCentering
          [(ngModel)]="status"
          [(value)]="defaultStatus"
          [panelClass]="{ darkPanelBg: switchTheme }"
          (selectionChange)="changeStatus($event.value)"
        >
          <mat-option
            *ngFor="let value of controlTowerActionStatus"
            value="{{ value.id }}"
            >{{ value.displayName }}</mat-option
          >
        </mat-select>
      </mat-form-field>
    </div>
    <div class="header-title">Comments</div>
    <textarea
      [(ngModel)]="comments"
      spellcheck="false"
      maxlength="500"
    ></textarea>
    <div class="link">
      <span>In relation to:</span>
      <span>
        Port Call:
        <a
          href="/v2/quantity-control/report/{{ data.quantityReportId }}/details"
          target="_blank"
        >
          <span class="aggridlink-darktheme">{{ data.portCall }}</span>
        </a>
      </span>
    </div>
  </div>
  <div class="change-log" *ngIf="getStatusId() != 1">
    <div class="header-title">Change Log</div>
    <div class="list-section" *ngIf="data.changeLog">
      <div
        class="list"
        style="width:100%"
        *ngFor="let value of data.changeLog.slice().reverse()"
      >
        <span></span>
        <p>{{ formatDate(value.date) }}</p>
        <div class="description">
          {{ value.newStatus.displayName }} by {{ value.user.name }}
          <p class="p-0 pt-1 pb-2">
            Comments: <em>{{ value.newComments }}</em>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
